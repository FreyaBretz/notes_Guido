\begin{intro}
  Die Methode der kleinsten Fehlerquadrate führt auf die Minimierungsaufgabe
  \begin{gather}
    \norm{Ax-b}_2 = \min.
  \end{gather}
\end{intro}

\begin{Satz}{normalengleichungen}
  Sei $A\in \R^{m\times n}$ mit $m\ge n$ und $b\in \R^m$. Dann ist
  $x\in\R^n$ genau dann eine Lösung des linearen Ausgleichsproblems
  \begin{gather}
    \norm{Ax-b}_2 = \min,
  \end{gather}
  wenn $x$ Lösung der \define{Normalengleichungen}
  \begin{gather}
    A^TA x = A^Tb
  \end{gather}
  ist. Insbesondere ist die Minimierungsaufgabe eindeutig lösbar, wenn
  $A$ vollen Rang hat.
\end{Satz}

\begin{remark}
  Wir können die Normalengleichungen lösen, indem wir die symmetrische Matrix $C = A^TA\in \R^{n\times n}$ berechnen und dann eines der Verfahren der vorigen Abschnitte auf diese Matrix anwenden.
  
  Das Lemma nach der nächsten Definition legt nahe, dass das keine gute Idee ist, da sich die Konditionszahl durch das Matrixprodukt quadriert und damit die Lösungsgenauigkeit leidet.  
\end{remark}

\begin{Definition}{condition-rectangular}
  Die Konditionszahl einer rechteckigen Matrix maximalen Rangs bezüglich der Operatornorm zur Vektornorm $\norm{\cdot}$ ist
  \begin{gather}
    \cond(A) = \frac{\sup\limits_{\norm{x}=1}\norm{Ax}}{\inf\limits_{\norm{x}=1}\norm{Ax}}.
    \end{gather}
  Die Definition ist konsistent zur Definition für invertierbare, quadratische Matrizen.
\end{Definition}

\begin{Lemma}{condition-squared}
  Für eine Matrix $A\in\R^{m\times n}$ maximalen Rangs mit $m\ge n$ gilt
  \begin{gather}
    \cond_2(A^TA) = \cond_2(A)^2.
  \end{gather}
\end{Lemma}

\begin{proof}
  \begin{align}
    \cond_2(A)^2  &= \frac{\sup\norm{Ax}_2^2}{\inf\norm{Ax}_2^2}\\
                  &= \frac{\sup(x^TA^TAx)}{\inf(x^TA^TAx)}\\
                  &= \frac{\lambda_{\max}(A^TA)}{\lambda_{\in}(A^TA)}\\
                  &= \cond_2(A^TA).
  \end{align}
\end{proof}


\begin{Lemma}{qr-rectangular}
  Zu jeder Matrix $A\in \R^{m\times n}$ maximalen Rangs mit $m\ge n$
  gibt es eine QR-Zerlegung
  \begin{gather}
  A = QR
  \end{gather}
  mit einer oberen Dreiecksmatrix $R\in\R^{n\times n}$ und einer Matrix $Q\in\R^{m\times n}$, deren Spalten ein Orthonormalsystem bilden.
  Unter der Zusatzbedingung $r_{ii}>0$ ist
  diese Zerlegung eindeutig.
\end{Lemma}

\begin{Satz}{qr-normal}
  Sei $QR=A$ eine QR-Zerlegung. Dann kann die Lösung der Normalengleichungen berechnet werden durch die Lösung des Systems
  \begin{gather}
    Rx = Q^Tb.
  \end{gather}
\end{Satz}

\begin{proof}
  Einsetzen der QR-Zerlegung in die Normalengleichungen ergibt
  \begin{gather}
  R^TQ^TQR x = R^T R x = R^TQ^T b.
  \end{gather}
  Da $R^T$ invertierbar ist, können wir die Inverse von links anwenden und erhalten das Resultat.
\end{proof}

\begin{remark}
  Bei der linearen Ausgleichsrechnung (engl.: \define{least-squares})
  erweitern wir den Lösungsbegriff für lineare Gleichungssysteme auf
  überbestimmte Systeme, indem wir die Bedingung \glqq Residuum gleich
  null\grqq{} durch die Bedingung \glqq Residuum minimal\grqq{}
  ersetzen.

  Zur definition von \glqq minimal\grqq{} haben wir dabei ganz
  selbstverständlich die euklidische Norm benutzt. Das ist aber
  willkürlich. Zunächst können wir die Definition und alle weiteren
  Argumente auf allgemeine Skalarprodukte und ihre zugehörigen Normen
  ersetzen. Dazu müssen wir die transponierte Matrix $A^T$ durch die
  im Skalarprodukt adjungierte Matrix $A^*$ definiert durch
  \begin{gather}
    \scal(A^*x,y) = \scal(x,Ay) \qquad\forall x,y\in \R^n
  \end{gather}
  ersetzen. Ebenso müssen dann natürlich die Spalten von $Q$
  orthonormal bezüglich dieses Skalarprodukts sein.

  Normen, die nicht durch Skalarprodukte definiert sind, führen auf
  nichtlineare Bestimmungsgleichungen. Solche Aufgaben behandelt die
  Optimierung.

  Ein wichtiger Schluss aus dieser Bemerkung ist, dass wir zwar den
  Begriff der Lösung erweitert haben, dabei aber nicht nur die Matrix
  und die rechte Seite die Lösung bestimmen, sondern zusätzlich die
  gewählte Norm die Lösung beeinflusst.
\end{remark}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
