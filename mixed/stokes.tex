
\section{Well-posedness of the continuous problem}

\begin{intro}
  We begin our investigation into the Stokes problem by investigating
  the well-posedness of the continuous problem. This is particularly
  simple, since we have
  \begin{gather}
    a(\vu,\vv) = \form(\strain \vu,\strain \vv)
  \end{gather}
  for the original Stokes problem in \slideref{Definition}{stokes-eq1}
  and
  \begin{gather}
    a(\vu,\vv) = \form(\nabla \vu,\nabla \vv)
  \end{gather}
  for the simplified \putindex{Stokes equations} in
  \slideref{Definition}{stokes-eq2}. From the standard theory for the
  Laplacian, we know that the second one is $\vV$-elliptic on
  $\vV=H^1_0(\domain;\R^d)$. For the first one, we conclude this by using a
  \putindex{Korn inequality}. Therefore, we can already conclude a
  first result:
\end{intro}

\begin{Lemma}{stokes-a-elliptic}
  Let $\vV=H^1_0(\domain; \R^d)$ and $\vV_h\subset \vV$ a finite dimensional
  subspace. Then, $a(.,.)$ is elliptic on $\ker B$ and on $\ker{B_h}$
  independent of the choices of $Q$ and $Q_h$.
\end{Lemma}

\begin{remark}
  We focus here on no-slip boundary condition on the whole boundary as
  the exemplary case. Other boundary conditions are possible, but as
  soon as the Dirichlet boundary for one velocity component becomes
  too small, the ellipticity of $a(.,.)$ on $\vV$ must be established by
  new arguments known for instance for Robin boundary conditions. In
  the extreme case of natural boundary conditions all around, $\vV$ is
  the subspace of $H^1(\domain; \R^d)$ obtained by dividing by the
  space of all translations for the simplified form and by the space
  of all rigid body movements.

  Note that we have established already in
  \slideref{Lemma}{divergence-compatibility} that the condition
  $\vV=H^1_0(\domain; \R^d)$ implies the reduction of the pressure to
  the space $Q = L^2_0(\domain)$ from
  \slideref{Notation}{pressure-constant}.
\end{remark}

\begin{intro}
  The previous lemma guarantees well-posedness of the
  \putindex{reduced problem} in all possible cases. Therefore, the
  remainder of this section is only concerned with the inf-sup
  condition for the divergence operator. We
  follow~\cite{GiraultRaviart86} in this presentation.
\end{intro}

\begin{Lemma}{stokes-helmholtz}
  Let $\vV=H^1_0(\domain;\R^d)$. Then, the divergence operator
  $\div\colon \vV \to L^2(\domain)$ is continuous and the subspace
  \begin{gather}
    \vV^0 = \ker \div
    = \bigl\{\vv\in \vV \big|
    \div \vv = 0 \text{ a.e.} \bigr\}
  \end{gather}
  is closed in $\vV$ and $\vV$ admits the orthogonal decomposition
  \begin{gather}
    \vV = \vV^0\oplus \vV^\perp.
  \end{gather}
\end{Lemma}

\begin{proof}
  We have that
  \begin{gather}
    \norm{\div \vv}_{L^2(\domain)}^2
    = \int_\domain \left(\sum \d_iv_i\right)^2\dx
    \le d \int_\domain \sum \abs{\d_iv_i}^2\dx
    \le d \norm{\vv}_{H^1(\domain;\R^d)}^2.
  \end{gather}
  Thus, the divergence operator is a continuous mapping from $\vV$ to
  $L^2(\domain)$. The definition of $\vV^0$ is equivalent to the
  definition of zero in $L^2(\domain)$. Finally, since the kernel is
  the pre-image of a closed set under a continuous map, it is
  closed. The existence of the decomposition follows from
  \slideref{Theorem}{orthogonal-complement}.
\end{proof}

\begin{Lemma}{stokes-grad}
  If $\vf\in \vV^* = H^{-1}(\domain;\R^d)$ satisfies
  \begin{gather}
    \vf(\vv) = 0 \quad\forall \vv\in \vV^0,
  \end{gather}
  then, there exists $p\in L^2(\domain)$ such that
  \begin{gather}
    \vf = \nabla p.
  \end{gather}
  If $\domain$ is connected, then $p$ is unique up to an additive
  constant.
\end{Lemma}

\begin{proof}
  First, we identify $L^2(\domain)$ with its dual. Then, by
  \begin{gather}
    \scal(-\nabla p, \vv)_{\vV^*\times \vV}
    = \scal(p, \div \vv)_{L^2(\domain)},
    \qquad\forall \vv\in \vV,
  \end{gather}
  we see that $-\nabla\colon L^2(\domain)\to \vV^*$ is the dual to the
  divergence operator. Using the Cauchy-sequence argument, we see that
  $\range{\div}$ is closed in $L^2(\domain)$ and the closed range
  theorem applies. Thus, $\range{-\nabla}$ is closed in $\vV^*$ and
  \begin{gather}
    \range{\nabla} = \polar{(\vV^0)} \cong \ortho{\vV}
  \end{gather}
  is the polar set of the kernel $\vV^0$. This implies the statement
  that there is a $p$ for every $\vf$. Uniqueness follows by the fact
  that the only differentiable functions on a connected domain with
  $\nabla p=0$ are the constant functions, and by density of such
  functions in $L^2(\domain)$.
\end{proof}

\begin{Corollary}{stokes-iso}
  Let $\domain$ be connected. Then,
  \begin{enumerate}
  \item $\nabla\colon L^2_0(\domain) \to \vV^0$ is an isomorphism
  \item $\div\colon \vV^\perp \to L^2_0(\domain)$ is an isomorphism
  \end{enumerate}
\end{Corollary}

\begin{Theorem}{stokes-infsup}
  Let $\domain\subset \R^d$ be a Lipschitz-domain,
  $\vV=H^1_0(\domain;\R^d)$ and $Q=L^2_0(\domain)$. Then, there is a
  constant $\beta>0$ depending only on the geometry of $\domain$ such
  that
  \begin{gather}
    \label{eq:stokes:1}
    \inf_{q\in Q}\sup_{\vv\in \vV}\frac{\form(\div
      \vv,q)}{\norm{\vv}_\vV\norm{q}_Q} \ge \beta.
  \end{gather}
  Furthermore, the problem finding $(\vu,p)\in \vV\times Q$ such that
  \begin{gather}
    \label{eq:stokes:3}
    a(\vu,\vv)+\form(\div \vv,p)+\form(\div \vu,q) = \vf(\vv)+g(q)
    \quad\forall \vv\in \vV, q\in Q,
  \end{gather}
  has a unique solution for any right hand side $\vf\in \vV^*$ and $g\in
  \range{\div}$.
\end{Theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Stable discretizations}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{intro}
  We begin by application of the generic theory of the previous
  chapter to the Stokes problem in order to obtain a generic error
  estimate based on the concrete choice of norms and a single
  assumption. Guided by this theorem, we spend the remaining part of
  this section exploring different options for the discrete spaces.
\end{intro}

\begin{Theorem}{stokes-convergence}
  Let $\vV=H^1_0(\domain;\R^d)$ and $Q=L^2_0(\domain)$. Let furthermore
  $\vV_h\subset \vV$ and $Q_h\subset Q$ be discrete subspaces such that
  there exists $\beta>0$ independent of $h$ such that
  \begin{gather}
    \label{eq:stokes:2}
    \inf_{q_h\in Q_h}\sup_{\vv_h\in \vV_h}\frac{\form(\div
      \vv_h,q_h)}{\norm{\vv_h}_{\vV}\norm{q_h}_Q} \ge \beta.
  \end{gather}
  Then, the Galerkin approximation of~\eqref{eq:stokes:3} admits a
  unique solution $(\vu_h, p_h)\in \vV_h\times Q_h$ with the
  quasi-bestapproximation property
  \begin{gather}
    \label{eq:stokes:4}
    \begin{split}
      \norm{\vu-\vu_h}_1
      &\le c_1 \inf_{\vv_h\in \vV_h}\norm{\vu-\vv_h}_1
      + c_2 \inf_{q_h\in Q_h}\norm{p-q_h}_0
      \\
      \norm{p-p_h}_1
      &\le c_3 \inf_{\vv_h\in \vV_h}\norm{\vu-\vv_h}_1
      + c_4 \inf_{q_h\in Q_h}\norm{p-q_h}_0.
    \end{split}
  \end{gather}
\end{Theorem}

\begin{Corollary}{stokes-convergence2}
  Under the assumptions of \slideref{Theorem}{stokes-convergence},
  let there be in addition interpolation operators $I_{\vV_h}$ and
  $I_{Q_h}$ such that
  \begin{gather}
    \label{eq:stokes:5}
    \begin{split}
      \norm{\vu-I_{\vV_h} \vu}_1 &\le c h^k \snorm{\vu}_{k+1} \\
      \norm{p-I_{Q_h} p}_0 &\le c h^k \snorm{p}_{k}.
    \end{split}
  \end{gather}
  Then, there is a constant $c$ independent of the approximation
  spaces such that
  \begin{gather}
    \label{eq:stokes:6}
    \begin{split}
      \norm{\vu-\vu_h}_1 &\le c h^k \bigl(\snorm{\vu}_{k+1} +
      \snorm{p}_{k}\bigr)
      \\
      \norm{p-p_h}_1 &\le c h^k \bigl(\snorm{\vu}_{k+1} +
      \snorm{p}_{k}\bigr).
    \end{split}
  \end{gather}
\end{Corollary}
\begin{intro}
  We continue showing that the most natural discretizations
  in two dimensions are not inf-sup stable. This holds for the
  discretization using continuous linear or bilinear elements for both
  velocity components and the pressure as well as for continuous
  linear or bilinear velocity functions combined with piecewise
  constant pressure functions.
\end{intro}

\begin{example}
  \label{ex:p1-p1}
  We begin with a one-dimensional example. Piecewise linear velocity
  and piecewise linear pressure ($P_1-P_1$). Both continuous. Then, $\div \vv_h$ is
  piecewise constant. Consequently, a pressure function which has zero
  mean value on each cell is in the kernel of $B_h^\transpose$.
  \begin{figure}[tp]
    \centering
    \includegraphics[width=.6\textwidth]{./fig/p1-p1-1d.tikz}
    \caption[Example for the $P_1-P_1$ pair in one
    dimension]{Piecewise linear pressure (\tikz\draw[color=cyan] (0,0)
      -- (1em,0);) and divergence (\tikz\draw[color=red] (0,0)
      -- (1em,0);) of
      piecewise linear velocity.}
    \label{fig:stokes:p1p1-1d}
  \end{figure}
\end{example}

\begin{example}
  Take a patch of four quadrilaterals or triangles meeting in a common
  vertex. Let $\domain$ be the union of these grid cells. Choose
  linear and bilinear shape functions for $\vV_h$, respectively. Then, $\dim
  \vV_h = 2$, since we have one interior vertex with one basis function for
  each velocity component. Choose piecewise constant pressure
  functions. Dividing out the global constant, we conclude that $\dim
  Q_h = 3$. Thus, the statement
  \begin{gather}
    \forall q_h\in Q_h \;\exists \vv_h\in \vV_h:
    \quad \norm{\vv_h}_1 = \norm{q_h}_0
    \;\wedge\; b(\vv_h, q_h) \ge \beta \norm{q_h}^2
  \end{gather}
  cannot hold true. Therefore, the inf-sup condition does not hold. In
  fact, $\ker{B_h} = \{0\}$.
  \begin{figure}[tp]
    \begin{center}
    \hfill
    \includegraphics[width=.3\textwidth]{./fig/patch1.tikz}
    \hfill
    \includegraphics[width=.3\textwidth]{./fig/patch2.tikz}
    \hfill\mbox{}
    \end{center}
    \caption[Very coarse meshes with Dirichlet boundary.]{Very coarse meshes with Dirichlet boundary. Degrees of freedom for pressure (\tikz\node[pressure] (0,0) {};) and for both velocity components(\tikz\node[veloxy] (0,0) {};).}
    \label{fig:stokes:example1}
  \end{figure}

  Thus, we conclude that for this combination of shape function
  spaces, there is a mesh such that they are not suited for the
  approximation of the Stokes problem. But, this may be a problem of a
  mesh with too few cells. In fact, asymptotically, a triangular mesh
  contains twice as many vertices as cells, a quadrilateral mesh as
  many. Therefore, $\dim \vV_h > \dim Q_h$ as soon as the mesh is
  sufficiently fine. Will this be sufficient?
\end{example}

\begin{Problem}{p1-p0-unstable}
The domain $\Omega=[0,1]^2$ is decomposed into $N \times N$ congruent squares where each
of them is again divided into two triangles. The decomposition $\mesh_h$
is given by these triangles.

We again choose piecewise linear ansatz functions for the velocity for $\vV_h$
(vanishing on $\partial \Omega$) and piecewise constant ansatz functions
for $Q_h$.

Is there a $N$ and an orientation of the triangles such that $\vV_h\times Q_h$ is
inf-sup stable?
\begin{solution}
  The number of degrees of freedom for the velocity is $2(N-1)^2$ and for the
  pressure $2N^2-1$. Hence, there is always a pressure ansatz functions such that
  \begin{align}
    (\nabla \cdot \vv_h, q_h)=0 \quad \forall \vv_h\in \vV_h.
  \end{align}
\end{solution}
\end{Problem}

\begin{Problem}{checker-board}
  Let $\domain = (0,1)^2$ be the unit square and let the mesh consist
  of Cartesian squares of side length $1/n$. Choose $\vV_h \subset \vV$
  based on bilinear shape functions. Show that the piecewise constant
  pressure function $p_c=\pm 1$ in a checkerboard fashion is in the
  kernel of $B_h^\transpose$, that is
  \begin{gather}
    b(\vv_h, p_c) = 0 \quad\forall \vv_h\in \vV_h.
  \end{gather}
\begin{solution}
This time there are $2N^2$ for the velocity and $2N^2-1$ ansatz functions for
the pressure. Therefore, we have to look a big deeper.

Denote by $p_{i+\frac12, j+\frac12}$ the pressure constant on cell $K_{i,j}$
($0\leq i,j \leq N-1$). The values of the velocity at the four vertices are
denoted by $u^1_{i,j}$, $u^1_{i,j+1}$, $u^1_{i+1,j}$, $u^1_{i+1,j+1}$ for the
first component and similarly for the second component.

Using this notation we can write the divergence constraint in terms of nodal and cell values:
\begin{align}
 &(\nabla \cdot \vv_h, q_h)\\
   &= \sum_{i,j} q_{i+\frac12,j+\frac12} \int_{K_{i,j}} \nabla \cdot \vv_h \,\mathrm{d}x\\
   &= \sum_{i,j} q_{i+\frac12,j+\frac12} \int_{\partial K_{i,j}} \boldsymbol{n} \cdot \vv_h \,\mathrm{d}x\\
   &= \sum_{i,j} q_{i+\frac12,j+\frac12} \frac{h}{2}(\vu^1_{i+1,j}-u^1_{i,j+1}+u^1_{i+1,j}-u^1_{i+1,j+1})\\
      &\quad +\sum_{i,j} q_{i,j} \frac{h}{2}(\vu^2_{i,j+1}-u^2_{i+1,j}+u^2_{i,j+1}-u^2_{i+1,j+1})\\
   &= \frac{h}{2}\sum_{i,j} u^1_{i,j}(q_{i-\frac12,j+\frac12}+q_{i-\frac12,j-\frac12}-q_{i+\frac12,j+\frac12}-q_{i+\frac12,j-\frac12})\\
      &\quad +\frac{h}{2}\sum_{i,j} u^2_{i,j}(q_{i+\frac12,j-\frac12}+q_{i-\frac12,j-\frac12}-q_{i+\frac12,j+\frac12}-q_{i-\frac12,j+\frac12})
\end{align}
Thus,
\begin{align}
(\nabla \cdot \vv_h, q_h)=0 \quad \forall \vv_h\in \vV_h
\end{align}
implies
\begin{align}
q_{i-\frac12,j+\frac12}+q_{i-\frac12,j-\frac12}-q_{i+\frac12,j+\frac12}-q_{i+\frac12,j-\frac12} &=0 \\
q_{i+\frac12,j-\frac12}+q_{i-\frac12,j-\frac12}-q_{i+\frac12,j+\frac12}-q_{i-\frac12,j+\frac12} &=0.
\end{align}
for all ($0\leq i,j \leq N-1$).
These two constraints can be rephrased as
\begin{align}
q_{i-\frac12,j+\frac12} &= q_{i+\frac12,j-\frac12} \\
q_{i-\frac12,j-\frac12} &= q_{i+\frac12,j+\frac12}
\end{align}
for all ($0\leq i,j \leq N-1$). Since the mean value of the pressure must be zero,
the set of pressure functions that fulfill
\begin{align}
(\nabla \cdot \vv_h, q_h)=0 \quad \forall \vv_h\in \vV_h
\end{align}
can be described by
\begin{align}
 p_{i,j} = c \quad \text{if } (i+j) \operatorname{mod} 2 = 0\\
 p_{i,j} = -c \quad \text{if } (i+j) \operatorname{mod} 2 = 1
\end{align}
where $c\not=0$.
\end{solution}
\end{Problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Bubble stabilization and the MINI element}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{Definition}{barycentric-coordinates}
  A simplex $T\in \R^d$ with vertices $x_0,\dots,x_d$ is described by
  a set of $d+1$ \define{barycentric coordinates}
  $\lambda_0,\dots,\lambda_d$ such that
  \begin{xalignat}2
    0\le\lambda_i(x) &\le 1& i&=0,\dots,d;\quad x\in T\\
    \lambda_i(x_j) &= \delta_{ij}& i,j&=0,\dots,d\\
    \sum \lambda_i(x) &= 1.
  \end{xalignat}
\end{Definition}

\begin{remark}
  The functions $\lambda_i(x)$ are the shape functions of the linear
  $P_1$ element on $T$. They allow us to define basis functions on the
  cell $T$ without use of a reference element $\widehat T$.

  Note that $\lambda_i\equiv 0$ on the face opposite to the
  vertex $x_i$.
\end{remark}

\begin{example}
  We can use barycentric coordinates to define shape functions on
  simplicial meshes easily, as in
  Table~\ref{tab:barycentric-shapes}.
  \begin{table}[tp]
    \centering
    \begin{tabular}{|c|l|}
      \hline Degrees of freedom
      & Shape functions \\\hline
      \adjustbox{valign=center,margin=3pt}{\includegraphics[width=2cm]{./fig/p1-p.tikz}}
      &
        {\begin{minipage}[b]{6cm}
          \begin{gather}
            \phi_i = \lambda_i,
            \quad i=0,1,2
          \end{gather}
        \end{minipage}}
      \\\hline
      \adjustbox{valign=center,margin=3pt}{\includegraphics[width=2cm]{./fig/p2-p.tikz}}
      &
        {\begin{minipage}[b]{6cm}
          \begin{xalignat*}2
            \phi_{ii} &= 2\lambda_i^2 - \lambda_i,
            &i&=0,1,2\\
            \phi_{ij} &= 4\lambda_i\lambda_j
            &j&\neq i
          \end{xalignat*}
        \end{minipage}}
        \\\hline
      \adjustbox{valign=center,margin=3pt}{\includegraphics[width=2cm]{./fig/p3-p.tikz}}
      &
        {\begin{minipage}[b]{6cm}
          \begin{xalignat*}2
          \phi_{iii} &= \tfrac12 \lambda_i(3\lambda_i-1)(3\lambda_i-2)
          &i&=0,1,2\\
          \phi_{ij} &= \tfrac92\lambda_i\lambda_j(3\lambda_j-1)
          &j&\neq i\\
          \phi_0 &= 27\lambda_0\lambda_1\lambda_2
        \end{xalignat*}
        \end{minipage}}
        \\\hline
    \end{tabular}
    \caption{Degrees of freedom and shape functions of simplicial elements
      in terms of barycentric coordinates}
    \label{tab:barycentric-shapes}
  \end{table}
\end{example}

\begin{Notation}{piecewise-polynomial-spaces}
  We denote by
  \begin{gather}
    \label{eq:stokes:8}
    H^k_h(\mathcal P) =
    \bigl\{ v\in H^k(\Omega) \big\vert
    v_{|\cell} \in \mathcal P \;\forall \cell\in\mesh_h\bigr\}
  \end{gather}
  the finite element space which is based on the shape function space
  $\mathcal P$, the mesh $\mesh_h$ and is a subspace of
  $H^k(\domain)$. Examples are the continuous spaces of piecewise
  polynomials or tensor product polynomials of degree $k$
  \begin{gather}
    H^1_h(\P_k) \qquad H^1_h(\Q_k),
  \end{gather}
  and the discontinuous spaces
  \begin{gather}
    H^0_h(\P_k) \qquad H^0_h(\Q_k).
  \end{gather}
\end{Notation}

\begin{Definition}{h1-bubble-space}
  An $H^1$-\define{bubble function} on a mesh cell $\cell$ is a
  function $b\in H^1_0(\cell)$. A \define{bubble space} $b_\cell$ on
  $\cell$ is a discrete vector space of such bubble functions.  We
  denote the space of bubble functions on the mesh $\mesh_h$ by
  \begin{gather}
    B_h(b_\cell) = \bigl\{ v\in H^1(\domain) \big\vert
    v_{|_\cell} \in b_\cell \;\forall \cell\in\mesh_h
    \bigr\}.
  \end{gather}
  If there is no confusion about the local bubble space $b_T$, we also
  write just $B_h$.
\end{Definition}

\begin{example}
  A bubble function on a triangle $\cell$ is easily defined by
  \begin{gather}
    \label{eq:stokes:7}
    b_3 = b_{3,\cell} = \lambda_0\lambda_1\lambda_2.
  \end{gather}
\end{example}

\begin{Definition}{mini-element-p}
  The \define{MINI element} consists of the spaces
  \begin{gather}
    \vV_h = \bigl(H^1_h(\P_1) \oplus B_h(b_3)\bigr)^2 \cap \vV,
    \qquad
    Q_h = H^1_h(\P_1) \cap Q.
  \end{gather}
  Its degrees of freedom are:
  \begin{center}
    \includegraphics[width=.2\textwidth]{./fig/p-mini-v.tikz}
    \hspace{1cm}
    \includegraphics[width=.2\textwidth]{./fig/p1-p.tikz}
  \end{center}
\end{Definition}

\begin{intro}
  We will show now that the MINI element is indeed inf-sup stable. To
  this end, we construct the \putindex{Fortin projection} according to
  \slideref{Lemma}{fortin}. Since the construction of such a
  projection operator turns out a bit complicated, we first introduce
  a construction principle, which will help us in our further
  analysis. The idea of this principle is separating the interpolation
  into $\vV_h$ from the preservation of the divergence.
\end{intro}

\begin{Lemma}{fortin-construction-1}
  Let there be operators $\Pi_1,\Pi_2\colon \vV \to \vV_h$ such that
  \begin{xalignat}2
    \label{eq:stokes:10}
    \norm{\Pi_1 \vv}_{\vV} &\le c_1 \norm{\vv}_{\vV}
    &\forall \vv&\in \vV,\\
    \label{eq:stokes:11}
    \norm{\Pi_2(\identity-\Pi_1)\vv}_{\vV} &\le c_2 \norm{\vv}_{\vV}
    &\forall \vv&\in \vV,\\
    \label{eq:stokes:12}
    b(\vv-\Pi_2 \vv,q_h) &= 0
    &\forall \vv&\in \vV, \;q_h\in Q_h,
  \end{xalignat}
  with constants $c_1$ and $c_2$ independent of the discretization
  parameter $h$. Then, the operator
  \begin{gather}
    \label{eq:stokes:9}
    \Pi_h = \Pi_1 + \Pi_2 - \Pi_2\Pi_1
  \end{gather}
  is a \putindex{Fortin projection}, that is, it is bounded on $\vV$ and
  \begin{gather}
    b(\vv-\Pi_h \vv, q_h) =0 \qquad\forall q_h\in Q_h.
  \end{gather}
\end{Lemma}

\begin{proof}
  Boundedness of $\Pi_h$ is obvious, such that we only focus on
  preservation of the kernel ob $B$:
  \begin{multline}
    b(\vv-\Pi_h \vv,q_h) = b(\vv-\Pi_1 \vv - \Pi_2 \vv + \Pi_2\Pi_1 \vv, q_h)
    \\
    = b(\vv-\Pi_2 \vv, q_h) - b(\Pi_1 \vv - \Pi_2\Pi_1 \vv,q_h) = 0-0 = 0.
  \end{multline}
\end{proof}

\begin{Assumption}{h1-stable-interpolation}
  There exists an $H^1$-stable interpolation operator $I_h:\vV\to \vV_h$
  such that for each cell $\cell \in \mesh_h$ there holds for $m=0,1$
  \begin{gather}
    \label{eq:stokes:13}
    \snorm{\vv-I_h \vv}_{m,\cell} \le c \sum_{\cell'\cap\cell
      \neq\emptyset} h_{\cell'}^{1-m}\snorm{\vv}_{1,\cell'},
  \end{gather}
  with a constant $c$ independent of the mesh parameter $h$.
\end{Assumption}

\begin{remark}
  The interpolation operators of Clément, Scott and Zhang, Schöberl or
  Ern and Guermond fullfil these assumptions.
\end{remark}

\begin{Definition}{locally-quasi-uniform}
  A family of meshes $\{\mesh_h\}$ is called \define{locally
    quasi-uniform}, if there is a constant $c$ such that
  \begin{gather}
    \label{eq:stokes:14}
    \forall h
    \;
    \forall \cell,\cell'\in \mesh_h
    \quad
    \cell\cap\cell'\neq \emptyset
    \Rightarrow
    h_\cell \le c h_{\cell'}.
  \end{gather}
\end{Definition}

\begin{Assumption}{locally-quasi-uniform}
  We assume of all families of meshes that they are shape regular and
  locally quasi-uniform, such that with
  \slideref{Assumption}{h1-stable-interpolation} there holds
  for $m=0,1$
  \begin{gather}
    \label{eq:stokes:15}
    \snorm{\vv-I_h \vv}_{m,\cell} \le c h_\cell^{1-m} \snorm{\vv}_{1,\domain_\cell},
  \end{gather}
  where $\Omega_\cell$ is the union of all cells with nonempty
  intersection with $\cell$.
\end{Assumption}

\begin{Theorem}{mini-stability}
  Under \slideref{Assumption}{locally-quasi-uniform},
  the MINI element is inf-sup stable.
\end{Theorem}

\begin{proof}
  We construct a \putindex{Fortin projection} by choosing
  $\Pi_1 = I_h$, where $I_h:\vV\to \bigl(H^1_h(\P_1)\bigr)^2$ is an
  $H^1$-stable interpolation operator into the standard linear finite
  element space. Now, we construct $\Pi_2: \vV \to \bigl(B_h\bigr)^2$
  such that for all $q_h\in Q_h$
  \begin{gather}
    \int_\domain \div(\Pi_2 \vv-\vv) q_h \dx
    = \int_\domain (\vv-\Pi_2 \vv)\cdot\nabla q_h\dx
    = 0.
  \end{gather}
  Indeed, $\Pi_2 \vv$ can be chosen on each cell. Since $\nabla q_h$ is
  constant on a cell $\cell$, we choose
  \begin{gather}
    \int_\cell \Pi_2 \vv_i \dx
    = \alpha_{\cell,i} \int_\cell b_{3,\cell}\dx
    = \int_\cell \vv_i\dx,
  \end{gather}
  where $i=1,2$ enumerates the velocity components. This is possible,
  since the mean value of $b_3$ is strictly positive. Assuming shape
  regularity, we can use the inverse estimate for $b_3$ to obtain
  \begin{gather}
    \norm{\Pi_2 \vv}_{1,\cell}
    \le c h_\cell^{-1} \norm{\Pi_2 \vv}_{0,\cell}
    \le c h_\cell^{-1} \norm{\vv}_{0,\cell}.
  \end{gather}
  Finally, we use the estimates for $I_h$ to obtain
  \begin{gather}
    \norm{\Pi_2 (\identity-\Pi_1) \vv}_{1,\cell}
    \le c h_\cell^{-1} \norm{\vv-I_h \vv}_{0,\cell}
    \le c \snorm{\vv}_{1,\domain_\cell}.
  \end{gather}
  Since the number of intersecting of cells of shape regular meshes is
  bounded, the final term is bounded by $\norm \vv_{1,\domain}$.
\end{proof}

\begin{Notation}{broken-bilinear-form}
  We use the abbreviation
  \begin{gather}
    \label{eq:stokes:18}
    \form(f,g)_{\mesh_h} = \sum_{\cell\in\mesh_h} \form(f,g)_\cell,
  \end{gather}
  for so called \define{broken bilinear form}s, where instead of
  integrating over the union of subsets, we sume the integrals.
\end{Notation}

\begin{Lemma}{mini-stabilized}
  The discretization of the Stokes problem~\eqref{eq:stokes:3} with
  the MINI element is equivalent to solving
  \begin{multline}
    \label{eq:stokes:16}
    \form(\nabla \vu,\nabla \vv) + \form(\div \vv,p) + \form(\div \vu,q)
    - \form(c_T \nabla p, \nabla q)_{\mesh_h}
    \\
    = \vf(\vv) + g(q) + \form(c_T \vf_T,\nabla q)_{\T_h}
  \end{multline}
  with standard, continuous linear finite elements for velocity and
  pressure. Here,
  \begin{gather}
    \vf_T = \int_\cell \vf\dx,
    \qquad
    c_T = \frac{\form(b_3,1)_\cell}{\norm{\nabla
      b_3}_\cell^2}.
  \end{gather}
\end{Lemma}

\begin{proof}
  Let $\vV_h^1 = H^1_h(\P_1)^2$ be the linear, vector-valued velocity
  space and $\vV_h^b = B_h(b_3)^2$ the bubble function space, such that
  the MINI element space is
  \begin{gather}
    \vV_h = \vV_h^1 \oplus \vV_h^b.
  \end{gather}
  Accordingly, we split the solution with the MINI element into
  $\vu_h = \vu_h^1 + \vu_h^b$.  By integration by parts, we obtain for the
  cubic bubble $b_3$\marginpar{Vector or not vector?}
  \begin{gather}
    \form(\nabla \vv,\nabla b_{3,\cell})_\cell = \form(-\Delta \vv,b_{3,\cell})_\cell = 0
    \qquad\forall \vv\in \P_1,
  \end{gather}
  such that
  \begin{gather}
    \form(\nabla \vv, \nabla b) = \form(\nabla b, \nabla \vv) = 0
    \qquad
    \forall \vv\in \vV_h^1,b\in \vV_h^b.
  \end{gather}

  Thus, testing~\eqref{eq:stokes:3} with $\vv_h\in \vV_h^1$ yields
  \begin{gather}
    \label{eq:stokes:17}
    \form(\nabla \vu_h^1,\nabla \vv_h)
    + \form(\div \vv_h, p_h) = f(\vv_h)
    \qquad\forall \vv_h\in \vV_h^1.
  \end{gather}
  Testing the same equation with $\vv\in \vV_h^b$, we obtain
  \begin{gather}
    \form(\nabla \vu_h^b,\nabla \vv_h)
    = f(\vv_h) - \form(\div \vv_h, p_h)
    = f(\vv_h) + \form(\vv_h,\nabla p_h)_{\mesh_h}.
  \end{gather}
  Choosing more specifically $\vv_h$ as the bubble function $b_{3,\cell}$ of the
  cell $\cell$ for each vector component yields
  \begin{gather}
    \label{eq:stokes:20}
    \mu_\cell^{(i)}  = \frac{1}{\norm{\nabla b_3}_\cell^2}\form(f+\d_i p_h,b_3)_\cell,
  \end{gather}
  where $\mu_\cell^{(i)}$ is the coefficient in front of the basis
  function $b_{3,\cell}$ on cell $\cell$ in the basis representation of
  $\vu_h^{(i)}$, such that
  \begin{gather}
    \label{eq:stokes:19}
    \vu_h^b = \sum_{\cell\in\mesh_h}
    \begin{pmatrix}
      \mu_\cell^{(1)} b_{3,\cell}\\
      \mu_\cell^{(2)} b_{3,\cell}
    \end{pmatrix}
  \end{gather}
  Testing the Stokes equations with $q_h\in Q_h$, we obtain the
  divergence equation
  \begin{gather}
    \form(\div \vu_h^1 + \div \vu_h^b,q_h)
    = \form(\div \vu_h^1, q_h)
    - \form(\vu_h^b, \nabla q_h)_{\mesh_h} = g(q_h).
  \end{gather}
  Using~\eqref{eq:stokes:20}, \eqref{eq:stokes:19} and using
  $f_T^{(i)} = \form(f^{(i)},1)_\cell$ yields
  \begin{align}
    \form(\vu_h^b, \nabla q_h)_{\mesh_h}
    &=
    \sum_{\cell\in\mesh_h} \frac{1}{\norm{\nabla b_3}_\cell^2}
    \sum_{i=1,2}\form(f_\cell^{(i)}+\d_i
      p_h,{b_3(T)}\d_i q_h)_\cell\\
    &= \sum_{\cell\in\mesh_h} \frac{\form(b_3,1)_\cell}{\norm{\nabla
      b_3}_\cell^2}
      \form(f_T+\nabla p_h,\nabla q_h)_\cell
  \end{align}
\end{proof}

\begin{remark}
  The constant $c_T$ in the previous lemma was computed by the formula
  \begin{gather}
    c_T = \frac{\form(b_3,1)_\cell}{\norm{\nabla b_3}_\cell^2}.
  \end{gather}
  This formula is complicated and we would rather like to avoid
  computing $c_T$ for every mesh cell, since we have to evaluate
  integrals of cubic functions. On the other hand, the same constant
  $c_T$ appears on the left and on the right of the modified
  equation~\eqref{eq:stokes:16}. Therefore, we can replace both by a
  constant of similar size without affecting consistency or the
  characteristic properties of the equation. Therefore, we estimate
  \begin{gather}
    c_T = \frac{\form(b_3,1)_\cell}{\norm{\nabla b_3}_\cell^2}
    \simeq \frac{\norm{b_3}_\cell^2}{\norm{\nabla b_3}_\cell^2}
    \simeq h_T^2,
  \end{gather}
  where ``$\simeq$'' indicates equality up to a constant independent
  of $h$, but depending on the constant in \putindex{shape regularity}.
\end{remark}

\begin{remark}
  The method introduced in \slideref{Lemma}{mini-stabilized} is an
  example for a \define{stabilized method}, here in particular
  \define{pressure stabilization}. Such methods were particularly
  popular in the early decades of finite element computation, since
  they only involve simple shape function spaces. They are still
  widely used due to their simplicity. The method constructed this way
  is consistent, i.~e.~, the continuous solution $(\vu,p)$ solves the
  discrete problem.
\end{remark}


\begin{Problem}{quadrilateral-mini}
  Show that the MINI element can be generalized to quadrilateral
  meshes. Design a bubble space $b_Q$ of minimal tensor degree such that
  \begin{gather}
    \vV_h = \bigl(H^1_h(\Q_1) \oplus B_h(b_Q) \cap \vV\bigr)^2,
    \qquad
    Q_h = H^1_h(\Q_1) \cap Q.
  \end{gather}

  Discuss extensions to tetrahedra and hexahedra in three dimensions.
\begin{solution}
  For simplices in any dimension consider the bubble function
  \begin{align}
    b_T=\prod_{i=1}^d\lambda_i\in \mathbb{P}_d(\mathcal{T}_h)
  \end{align}
  and we can procede exactly as in the 2D case, i.e. the bubble
  space is spanned by
  \begin{align}
   \left\{b_T e_1,\dotsc, b_T e_d\right\}.
  \end{align}

  For quadrilaterals and higher-dimensional generalizations consider
  on the reference cell $[-1,1]^d$
  \begin{align}
    \hat{b}_T=\prod_{i=1}^d(1-x_i^2)\in \mathbb{Q}_{2d}(\hat{\mathcal{T}}_h).
  \end{align}
  In particular, we have to satisfy
  \begin{gather}
    \int_\domain \div(\Pi_2 \vv-\vv) q_h \dx
    = \int_\domain (\vv-\Pi_2v)\cdot\nabla q_h\dx
    = 0 \quad \forall q_h\in Q_h.
  \end{gather}
  Since $\nabla Q_h$ is spanned by
  \begin{align}
    \left\{
      \begin{pmatrix} 1 \\0 \end{pmatrix},
      \begin{pmatrix} 0 \\1 \end{pmatrix},
      \begin{pmatrix} y \\x \end{pmatrix}
    \right\}
  \end{align}
  in 3D, we need three additional bubble functions we choose as
  \begin{align}
    b_{T,1}= \begin{pmatrix} \hat{b}_T   \\ 0         \end{pmatrix},
    b_{T,2}= \begin{pmatrix}         0   \\ \hat{b}_T \end{pmatrix},
    b_{T,3}= \begin{pmatrix} \hat{b}_T y \\ \hat{b}_T x \end{pmatrix}.
  \end{align}
  With respect to the reference element $[-1,1]^2$, these functions are orthogonal
  to the basis of $\nabla Q_h$ and non-negative. Hence, there exists a function
  fulfilling the three requirements and we define $\Pi_2$ to be the projection to the
  space spanned by $b_{T,1}, b_{T,2}$ and $b_{T,3}$.
\end{solution}
\end{Problem}

\begin{Problem}{mini-3d}
  By introducing barycentric coordinates $\lambda_0,\dots,\lambda_3$
  for a tetrahedron $\cell\subset\R^3$ and the quartic bubble
  \begin{gather}
    b_{4,\cell} = \lambda_0\lambda_1\lambda_2\lambda_3,
  \end{gather}
  show that the MINI element has a natural generalization to three
  dimensional problems.
\begin{solution}
  We procede just as in the two-dimensional case and observe for any
  $\Pi_2: \vV \to \bigl(B_h\bigr)^3$
  \begin{align}
    \int_\domain \div(\Pi_2 \vv-\vv) q_h \dx
    = \int_\domain (\vv-\Pi_2v)\cdot\nabla q_h\dx = \sum_\cell\int_\cell (\vv-\Pi_2v)\dx\cdot\nabla q_\cell\dx
  \end{align}
  due to the continuity of the ansatz spaces.
  If we choose $\Pi_2: \vV \to \bigl(B_h\bigr)^3$ such that for all $q_h\in Q_h$,
  \begin{align}
   \int_\cell \Pi_2 \vv_i \dx
    = \alpha_{\cell,i} \int_\cell b_{4,\cell}\dx
    = \int_\cell \vv_i\dx,
  \end{align}
  we indeed get the desired property
  \begin{align}
    \int_\domain \div(\Pi_2 \vv-\vv) q_h \dx = 0.
  \end{align}
  This is possible as $b_{4,\cell}$ is nonnegative. Stability follows as in the two-dimensional case.
  \begin{gather}
    \norm{\Pi_2 \vv}_{1,\cell}
    \le c h_\cell^{-1} \norm{\Pi_2 \vv}_{0,\cell}
    \le c h_\cell^{-1} \norm{\vv}_{0,\cell}.
  \end{gather}
  Finally, we use the estimates for $I_h$ to obtain
  \begin{gather}
    \norm{\Pi_2 (\identity-\Pi_1) \vv}_{1,\cell}
    \le c h_\cell^{-1} \norm{\vv-I_h \vv}_{0,\cell}
    \le c \snorm{\vv}_{1,\domain_\cell}.
  \end{gather}
  Since the number of intersecting of cells of shape regular meshes is
  bounded, the final term is bounded by $\norm \vv_{1,\domain}$.
\end{solution}

\end{Problem}

\begin{intro}
  The reasoning behind the MINI element can be applied easily to
  pressure spaces of higher order. Take for instance the pair
  $P_k-P_k$, generalized from Example~\ref{ex:p1-p1}.
  There holds $\div \vv_h \in \P_{k-1}$ on each cell,
  and the term
  \begin{gather}
    \int_\cell \div \vv_h q_h\dx
  \end{gather}
  does not control the function in $\hat p_\cell \in \P_k$ which is
  orthogonal to $\P_{k-1}$. The only function $p_h\in Q_h$ such that
  $p_{h|\cell} = \hat p_\cell$ for each cell $\cell\in\mesh_h$ may be
  zero or not, depending on the mesh geometry. Thus, the element is
  not stable on arbitrary shape regular meshes. But, as we prove
  below, the same enrichment process by bubble functions can be
  employed for its stabilization.
\end{intro}

\begin{Definition}{higher-order-bubble}
  With any pressure space $Q_h$ we associate the \define{bubble space}
  \begin{gather}
    \label{eq:stokes:24}
    B_h(b_\cell \nabla Q_h)
    = \bigl\{ \vv\in \vV \big\vert
    \; \exists q_h\in Q_h \colon \vv_{|\cell} = b_\cell \nabla q_h \bigr\}.
  \end{gather}
  Here, $b_\cell$ is a bubble function on $\cell$ like the cubic buble
  $b_{3,\cell}$ of a triangle, the quartic bubble $b_{4,\cell}$, the
  biquadratic bubble $b_{2^2,\cell}$ of a quadrilateral or the
  triquadratic bubble $b_{2^3,\cell}$ of a hexahedron.

  We also define the cell bubble space
  \begin{gather}
    \label{eq:stokes:25}
    B_\cell(\nabla Q_h) = \bigl\{ \vv\in L^2(\cell) \big\vert
    \;\exists q_h\in Q_h \colon \vv = b_T \nabla q_{h|\cell}\bigr\}.
  \end{gather}
\end{Definition}

\begin{Theorem}{higher-order-bubble}
  Assume that the pair $\vV_h\times Q_h$ is chosen such that there is
  an $H^1$-stable interpolation operator according to
  \slideref{Assumption}{h1-stable-interpolation}, such that $Q_h\subset
  C^0(\domain)$, piecewise differentiable, and such that
  \begin{gather}
    B_h(b_\cell \nabla Q_h) \subset \vV_h.
  \end{gather}
  Then, the pair $\vV_h\times Q_h$ is inf-sup stable.
\end{Theorem}

\begin{proof}
  We construct the \putindex{Fortin projection} by
  \slideref{Lemma}{fortin-construction-1} choosing $\Pi_1$ as the
  $H^1$-stable interpolation operator. The operator $\Pi_2$ is
  constructed cell-wise such that $\Pi_2\colon H^1(\cell) \to
  B_\cell(\nabla Q_h)$ fulfills
  \begin{gather}
    \label{eq:stokes:26}
    \int_\cell (\Pi_2 u - u) \cdot\nabla q = 0,
    \qquad
    \forall q\in Q_{h|\cell}.
  \end{gather}
  Clearly, the dimension of $B_\cell(\nabla Q_h)$ equals the dimension
  of $Q_{h|\cell}$. Then, since the bubble functions are strictly
  positive inside $\cell$, equation~\eqref{eq:stokes:26} defines
  $\Pi_2 u$ uniquely. It remains to show the $H^1$-stability of
  $\Pi_2(\identity-\Pi_1)$, which is done by the standard scaling
  argument
  \begin{gather}
    \snorm{\Pi_2 \vv}_{1,\cell}
    =\snorm{\widehat{\Pi_2 \vv}}_{1,\widehat\cell}
    \le c \norm{\widehat \vv}_{1,\widehat\cell}
    \le c \bigl(h_\cell^{-1} \norm{\vv}_{0,\cell} + \snorm{\vv}_{1,\cell}\bigr).
  \end{gather}
\end{proof}

\begin{Corollary}{pk-bubble}
  Let $Q_h\subset Q$ be continuous and cell-wise differentiable. If
  \begin{gather}
    H^1_h(\P_1)^d\oplus B_h(b_\cell\nabla Q_h) \subset \vV_h \subset \vV,
  \end{gather}
  then the pair $\vV_h\times Q_h$ is inf-sup stable. The same holds on
  quadrilateral and hexahedral meshes replacing $\P_1$ by $\Q_1$.
\end{Corollary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Elements with discontinuous pressure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{intro}
  In this section, we consider a second stable element, which like
  the MINI element is not so much of practical use, but exhibits
  typical properties of the analysis of finite element spaces for the
  Stokes problem.
\end{intro}

\begin{Definition}{p2-p0-element}
  The \textbf{$\mathbf{P_2-P_0}$ element} on triangles consists of the finite
  element spaces
  \begin{gather}
    \vV_h = H^1_h(\P_2)^2 \cap \vV,
    \qquad
    Q_h = H^0_h(\P_0) \cap Q.
  \end{gather}
  Its degrees of freedom are:
    \begin{center}
    \includegraphics[width=.2\textwidth]{./fig/p2-v.tikz}
    \hspace{1cm}
    \includegraphics[width=.2\textwidth]{./fig/p0-p.tikz}
  \end{center}
\end{Definition}

\begin{Lemma}{p2-p0-stability}
  The $P_2-P_0$ element is inf-sup stable.
\end{Lemma}

\begin{proof}
  We again prove stability by constructing a \putindex{Fortin
    projection} using the two step algorithm of
  \slideref{Lemma}{fortin-construction-1}. Again, we choose for
  $\Pi_1$ an $H^1$-stable interpolation according to
  \slideref{Assumption}{h1-stable-interpolation}. It remains therefore
  to construct $\Pi_2$. First, since $q_{h|\cell}$ is constant on
  each cell $\cell\in\mesh_h$, we can apply the Gauss theorem to the
  divergence condition to obtain
  \begin{gather}
    \label{eq:stokes:23}
    \int_\cell \div (\vu-\Pi_2u)\dx = \int_{\d\cell} (\vu-\Pi_2u)\cdot\n\ds.
  \end{gather}
  Hence, the following interpolation conditions on each cell $\cell$
  define a divergence preserving operator $\Pi_2$:
  \begin{xalignat}2
    \label{eq:stokes:21}
    \Pi_2 u(x) &= 0
    & \forall x &\text{ is vertex of } \cell\\
    \label{eq:stokes:22}
    \int_E \Pi_2 u\ds &= \int_E u\ds
    & \forall E &\text{ is edge of } \cell
  \end{xalignat}
  This is true, since~\eqref{eq:stokes:22} implies the right hand side
  of~\eqref{eq:stokes:23}. It remains to show $H^1$-stability of
  $\Pi_2(\identity-\Pi_1)$. Let us first observe that the
  interpolation operator only involves edge integrals of $u$, which
  are bounded functionals on $H^1$. Second, the condition on $\Pi_2 u$
  at the vertices implies a Poincaré-Friedrichs type inequality on the
  reference cell.
  Thus, we have by the standard scaling
  argument
  \begin{gather}
    \snorm{\Pi_2 \vv}_{1,\cell}
    =\snorm{\widehat{\Pi_2 \vv}}_{1,\widehat\cell}
    \le c \snorm{\widehat{\Pi_2 \vv}}_{0,\widehat\cell}
    \le c \norm{\widehat \vv}_{1,\widehat\cell}
    \le c \bigl(h_\cell^{-1} \norm{\vv}_{0,\cell} + \snorm{\vv}_{1,\cell}\bigr).
  \end{gather}
  Entering $\vv=u-\Pi_1 u$ and the estimates~\eqref{eq:stokes:15} of
  \slideref{Assumption}{locally-quasi-uniform}, we obtain
  \begin{gather}
    \norm{\Pi_2 (\identity-\Pi_1)u}_1^2
    = \sum_{\cell\in\mesh_h}\norm{\Pi_2
      (\identity-\Pi_1)u}_{1,\cell}^2
    \le c \norm{\vu}_1^2
  \end{gather}
\end{proof}

\begin{remark}
  The proof shows, that from a mathematical point of view degrees of
  freedom on edges are more reasonably defined by integrals along the
  edge than by values in the mid points. This is something, we will
  encounter again and again. Nevertheless, we will not change the
  cartoons for the degrees of freedom and just note that a degree of
  freedom on an edge, while drawn as a point, may be an integral value.
\end{remark}

\begin{Theorem}{p2-p0-convergence}
  Let $(\vu,p)\in \vV\times Q$ be a solution to the Stokes problem and let
  the pair $(\vu_h,p_h) \in \vV_h\times Q_h$ be the approximation on a
  mesh $\mesh_h$ of mesh size $h$ with the $P_2-P_0$ element of
  \slideref{Definition}{p2-p0-element}. Then, we have the error
  estimate
  \begin{gather}
    \norm{\vu-\vu_h}_1 + \norm{p-p_h}_0
    \le c \bigl(h^2\snorm{\vu}_3 + h \snorm{p}_1\bigr).
  \end{gather}
\end{Theorem}

\begin{remark}
  While this theorem is optimal with respect to our analysis, it is
  not optimal with respect to the approximation properties of $\vV_h$.
\end{remark}

\begin{remark}
  Let us review the construction principles behind the \putindex{MINI
    element} and the $P_2-P_0$ element. The uncontrolled pressure
  modes in $\ker B_h^\transpose$ of the $P_1-P_1$ element in
  Example~\ref{ex:p1-p1} were those pressures
  with alternating signs at neighboring vertices, such that the mean
  value of $p_h$ is zero on each cell. Therefore, $p_h$ is orthogonal
  to the constant derivatives of the linear velocity space. Thus, we
  add a local function on each cell with nonconstant gradient, and the
  mean value of the pressure can be controlled.

  The kernel of $B_h^\transpose$ for the element $H^1(\P_1)^2 - H^0(\P_0)$ on
  the other hand contains functions that are constant on each cell,
  but jump over cell boundaries. By integration by parts, we have
  \begin{gather}
    \int_\cell \div b_\cell q_h \dx
    = -\int_\cell b_\cell \cdot\nabla q_h
    + \int_{\d\cell} b_\cell q_h \ds
    = 0.
  \end{gather}
  Hence, no kind of bubble function helps controlling the jump of
  $p_h$ over an edge. Instead, we introduce a degree of freedom on the
  edge. Integrating by parts on two neighboring cells $\cell_1$ and
  $\cell_2$, we obtain on the common edge $E_{12}$ a term of the form
  \begin{gather}
    \int_{E_{12}} \left[u\cdot\n_1 q_1 + u\cdot\n_2 q_2\right],
  \end{gather}
  which by the continuity of $u\cdot\n$ translates to
  \begin{gather}
    \int_{E_{12}} u\cdot\n_1 (q_1- q_2).
  \end{gather}
  Thus, we can use the interpolation operator $\Pi_2$ to obtain a
  function $u$ such that
  \begin{gather}
    \int_{E_{12}} u\cdot\n_1 \ds = (q_1-q_2),
  \end{gather}
  such that
  \begin{gather}
    \form(\div u,q_h) = \int_{E_{12}} \abs{q_1-q_2}^2\ds + \text{
      other terms}.
  \end{gather}
\end{remark}

\begin{Problem}{q2-q0}
  Show that the quadrilateral element
  \begin{gather}
    \vV_h = H^1_h(\Q_2)^2\cap \vV,
    \qquad Q_h = H^0_h(\P_0) \cap Q,
  \end{gather}
  with degrees of freedom
  \begin{center}
    \includegraphics[width=.2\textwidth]{./fig/q2-v.tikz}
    \hspace{1cm}
    \includegraphics[width=.2\textwidth]{./fig/q0-p.tikz}
  \end{center}
  is inf-sup stable. Does the proof translate to the $P_2-P_0$ element
  on tetrahedra or the $Q_2-P_0$ element on hexahedra?
\begin{solution}
  Let's first consider the element pair $\mathbb{Q}_2/\mathbb{P}\_0^-$ in 2D.
  Since any function in the pressure ansatz space is piecewise constant, we observe
  for any $\Pi_2: \vV \to \bigl(\vV_h\bigr)^2$
  \begin{align}
    \int_\domain \div(\Pi_2 \vv-\vv) q_h \dx
    = \sum_\cell\int_{\partial \cell} (\vv-\Pi_2v)q_h \cdot n \ds \,q_\cell.
  \end{align}
  If we choose $\Pi_2: \vV \to \bigl(\vV_h\bigr)^2$ such that for all $q_h\in Q_h$,
  \begin{align}
    \Pi_2 u(x) &= 0
    & \forall x &\text{ is vertex or midpoint of } \cell\\
    \int_E \Pi_2 u\ds &= \int_E u\ds
    & \forall E &\text{ is edge of } \cell
  \end{align}
  we clearly get the desired property
  \begin{align}
    \int_\domain \div(\Pi_2 \vv-\vv) q_h \dx = 0.
  \end{align}
  In fact, the first condition determines 5 of the 9 degrees of freedom
  and the second condition the remaining 4. This means that the interpolation
  again is given by face integrals alone and we achieve stability via
  \begin{align}
    \snorm{\Pi_2 \vv}_{1,\cell}
    =\snorm{\widehat{\Pi_2 \vv}}_{1,\widehat\cell}
    \le c \norm{\widehat \vv}_{1,\widehat\cell}
    \le c \bigl(h_\cell^{-1} \norm{\vv}_{0,\cell} + \snorm{\vv}_{1,\cell}\bigr).
  \end{align}
  Entering $\vv=u-\Pi_1 u$ and the estimates~\eqref{eq:stokes:15} of
  \slideref{Assumption}{locally-quasi-uniform}, we obtain
  \begin{align}
    \norm{\Pi_2 (\identity-\Pi_1)u}_1^2
    = \sum_{\cell\in\mesh_h}\norm{\Pi_2
      (\identity-\Pi_1)u}_{1,\cell}^2
    \le c \norm{\vu}_1^2.
  \end{align}

  For the pair $\mathbb{P}_2/\mathbb{P}_0^-$ in 3D on tetrahedra we have
  4 degrees of freedom at the vertices and 6 degrees of freedom on the midpoints of the edges.
  Again, the condition we need to satisfy is
  \begin{align}
    \int_{\partial \cell} (\vv-\Pi_2v)q_h \cdot n \ds \,q_\cell = 0.
  \end{align}
  Hence, one way to choose the interpolation operator is by requiring
  \begin{align}
    \int_E \Pi_2 u\ds &= 0           & \forall E &\text{ is edge of } \cell\\
    \int_F \Pi_2 u\ds &= \int_F u\ds & \forall F &\text{ is face of } \cell.
  \end{align}
  The first and second condition determine 6 respectively 4 degrees of freedom
  and stability follows as usual by inverse estimates.

  For the pair $\mathbb{Q}_2/\mathbb{P}_0^-$ in 3D on hexahedra we have the
  following number of degree of freedoms:
  \begin{itemize}
  \item 1 in the interior
  \item 6 on the 6 faces
  \item 12 on the 12 edges
  \item 8 at the 8 vertices
  \end{itemize}
  Again, the condition we need to satisfy is
  \begin{align}
    \int_{\partial \cell} (\vv-\Pi_2v)q_h \cdot n \ds \,q_\cell = 0.
  \end{align}
  Hence, one way to choose the interpolation operator is by requiring
  \begin{align}
    \Pi_2 u(x)        &= 0           & \forall x &\text{ is vertex, edge or midpoint of } \cell\\
    \int_F \Pi_2 u\ds &= \int_F u\ds & \forall F &\text{ is face of } \cell.
  \end{align}
  The first and second condition determine 6 respectively 4 degrees of freedom
  and stability follows as usual by inverse estimates. In fact, the interpolator again
  just relies on face integrals.
\end{solution}
\end{Problem}

\begin{intro}
  In spite of our remarks above, there is a generalization of the
  $P_2-P_0$ element involving bubble functions. We will discuss it in
  an abstract theorem first and then derive a family of inf-sup stable
  pairs.
\end{intro}

\begin{Lemma}{bubble-discontinuous}
  Given a space $Q_h\subset Q$ possibly discontinuous, choose
  $\vV_h\subset \vV$ such that
  \begin{gather}
    B_h(b_\cell \nabla Q_h)^d \subset \vV_h.
  \end{gather}
  If there is an operator $\Pi_1$ such that
  \begin{xalignat*}2
    \norm{\Pi_1 \vv}_{\vV} & \le \norm{\vv}_{\vV}
    &\forall \vv&\in \vV,\\
    \int_\cell \div (\vv-\Pi_1v) \dx &= 0
    &\forall \vv&\in \vV, \cell\in\mesh_h,
  \end{xalignat*}
  then the pair $\vV_h\times Q_h$ is inf-sup stable.
\end{Lemma}

\begin{proof}
  We construct the \putindex{Fortin projection} using $\Pi_1$ and
  define $\Pi_2$ only on $\vV^0 = \ker{\div}$. This is sufficient, since
  for any $\vv\in \vV$ there holds $\vv-\Pi_1 \vv \in \vV^0$. Therefore, define
  cell-wise $\Pi_2\colon \vV^0_{|\cell} \to B_\cell(b_\cell \nabla Q_h)$
  by the conditions
  \begin{gather}
    \int_\cell \div (\Pi_2 \vv - \vv ) q_h \dx = 0
    \qquad\forall q_h\in Q_{h|\cell}.
  \end{gather}
  By this condition, $\Pi_2 \vv$ is divergence free itself.
  Note that by the Gauss theorem, the divergence of a bubble function
  has always zero mean. Therefore, we have unique solvability and
  $\Pi_h \vv$ is well defined. It remains to apply the standard scaling
  argument to prove
  \begin{gather}
    \norm{\Pi_2 \vv}_1 \le c \norm{\vv}_1.
  \end{gather}
\end{proof}

\begin{remark}
  The divergence condition in the previous lemma is different from the
  condition on Fortin projections, since it only involves piecewise
  constant pressure. Therefore, the lemma in effect splits the
  pressure space into a piecewise constant part and its
  complement. Then, the pressure in the complement is controlled by
  the bubble functions. It still remains to guarantee the existence
  of the operator $\Pi_1$. In one case, we have verified the
  existence of such an operator: the Fortin operator for the $P_2-P_0$
  element. Therefore, we have
\end{remark}

\begin{Corollary}{bubble-p2}
  Let $Q_h\subset Q$ be a space of piecewise differentiable
  functions. If for $\vV_h\subset \vV$ holds
  \begin{gather}
    H^1_h(\P_2)^2 \oplus B_h(b_\cell \nabla Q_h)^2 \subset \vV_h,
  \end{gather}
  then the pair $\vV_h\times Q_h$ is inf-sup stable.
\end{Corollary}

\begin{Corollary}{pk-pk2}
  Let the space dimension be $d=2$ and $k\ge 2$. Then, the spaces
  \begin{gather}
    \vV_h = H^1_h(\P_k)^2 \cap \vV,
    \qquad
    Q_k = H^0_h(\P_{k-2}) \cap Q,
  \end{gather}
  form an inf-sup stable pair.
\end{Corollary}

\begin{proof}
  For $k=2$, this is the $P_2-P_0$ element. For $k>2$, we have for all
  $q_h\in Q_h$ on every cell $\nabla q_h\in \P_{k-3}$. Therefore,
  $(b_{3,\cell} q_h)_{|\cell} \in \P_k$.
\end{proof}

\begin{intro}
  Studying the proof of \slideref{Lemma}{p2-p0-stability} in more
  detail, we can find a much more general result with much weaker
  assumptions. Indeed, we only need to be able to have a single degree
  of freedom on each edge or face which allows to adjust the average
  normal velocity over this edge of face. We summarize this in:
\end{intro}

\begin{Theorem}{discontinuous-pressure-normal-velocity}
  Let $Q_h\subset Q$ and let $\vV_h \subset \vV$ be such that there is an
  $H^1$-stable interpolation according to
  \slideref{Assumption}{h1-stable-interpolation}. Furthermore, let
  there be a degree of freedom on each edge (face in 3D) controlling
  the average normal derivative of $u\in \vV_h$ on this face. Finally,
  let $\vV_h$ contain the bubble space for $\nabla Q_h$,
  \begin{gather}
    B_h(b_\cell \nabla Q_h)^d \subset \vV_h.
  \end{gather}
  Then, the pair $\vV_h\times Q_h$ is inf-sup stable.
\end{Theorem}

\begin{proof}
  With the assumptions made, it is sufficient to construct the
  operator $\Pi_1$ in \slideref{Lemma}{bubble-discontinuous}. Then, we
  can apply this lemma and the result is proven. Going back
  to~\eqref{eq:stokes:23}, we see that the interpolation condition
  ~\eqref{eq:stokes:22} is more than needed.

  Now, let $\{\nodal_{\cell,i}\}$ be the $n_\cell$ node values for the
  discrete velocity space $\vV_\cell = \vV_{h|\cell}$ on the cell $\cell$. For
  convenience, let them be ordered in a way, that the first ones
  control the normal derivatives of $\vu_h$ on the faces of the cell,
  that is,
  \begin{gather}
    \nodal_{\cell,i} = \int_{F_i} u\cdot\n \ds
    \qquad i=1,\dots,n_F,
  \end{gather}
  where $n_F$ is the number of faces per cell. Given the $H^1$-stable
  interpolation operator $I_h$, define $\Pi_2$ cell-wise such that
  \begin{xalignat}2
    \nodal_{\cell,i}(\Pi_2 u) &= \nodal_{\cell,i}(\vu)
    &i&=1,\dots,n_F\\
    \nodal_{\cell,i}(\Pi_2 u) &= 0
    &i&=n_F+1,\dots,n_\cell.
  \end{xalignat}
  Choosing the basis on $\vV_T$ which is dual to $\{\nodal_{\cell,i}\}$,
  we see that this indeed implies
  \begin{gather}
    0=\int_{\d\cell} (\Pi_2 u - u) \ds = \int_\cell \div (\Pi_2 u-u)\dx.
  \end{gather}
  Therefore, $\Pi_1 = I_h + \Pi_2(\identity-I_h)$ is divergence
  preserving. Boundedness follows by the standard scaling argument.
\end{proof}

\begin{Corollary}{qk-pk1}
  The finite-element pair $\vV_h\times Q_h$ with
  \begin{gather}
    \vV_h = H^1_h(\Q_k)^2 \cap \vV,
    \qquad
    Q_h = H^0_h(\P_{k-1}) \cap Q,
  \end{gather}
  called the $Q_k-P_{k-1}$ element is inf-sup stable for any $k\ge 2$.
\end{Corollary}

\begin{proof}
  First, we prove that $B_h(b_\cell \nabla Q_h)^d \subset \vV_h$. To
  this end, we note that on each cell, we have that the gradient of
  a discrete pressure $q_h$ restricted to this cell is in
  $\P_{k-2}\subset \Q_{k-2}$. The bubble function $b_T$ is in $\Q_2$,
  such that $b_T\nabla q_T \in \Q_k$, which was to be proven.

  For the assumption on the degrees of freedom, we refer to the
  following definition. Once the degrees of freedom for each velocity
  component are determined by this definition, we can simply select
  the normal component on Cartesian meshes. On meshes with straight
  interfaces, it is clear that we can choose a linear combination of
  the components of $u$ splitting into normal and tangential and thus
  get the desired result. In general, we refer to the \putindex{Piola
  transformation} in the next chapter.
\end{proof}

\begin{Definition}{moment-basis-1d}
  The shape function space $\P_k$ on the reference element $\widehat
  T = [-1,1]$ in one dimension can be split into
  \begin{gather}
    \label{eq:stokes:35}
    \P_k^0 \oplus \overline{\P_k},
  \end{gather}
  where $\P_k^0 = \P_k \cap H^1_0(\widehat T)$. We choose an
  orthogonal basis for $\P_k^0$ with respect to the $H^1_0$-inner
  product $\scal(p,q) = \int p'q'\dx$ by
  \begin{gather}
    \label{eq:Lobatto-polynomials}
    \phi_i(x) = \int_{-1}^x L_{i}(t)\dt\quad i=1,\dots,k-1,
  \end{gather}
  where $L_i$ is the Legendre polynomial of degree $i$. The two
  basis functions for $\overline{\P_k}$ are chosen such that
  \begin{xalignat*}2
    \phi_0(-1) &= 1, & \scal(\phi_0,\phi_i) &= 0 \quad i=1,\dots,k-1,\\
    \phi_k(1) &= 1, & \scal(\phi_k,\phi_i) &= 0 \quad i=1,\dots,k-1.
  \end{xalignat*}
\end{Definition}

\begin{Lemma}{moment-dofs-1d}
  The degrees of freedom
  \begin{gather}
    \label{eq:stokes:30}
    \begin{aligned}
    \nodal_0(\phi) &= \phi(-1),&
    \nodal_k(\phi) &= \phi(1),\\
    \nodal_i(\phi) &= \frac1{\int {\phi_i'}^2} \int_{-1}^{1}
    \phi'\phi_i'\dx
    &i&=1,\dots,k-1,
    \end{aligned}
  \end{gather}
  are the dual basis for the basis described in
  \slideref{Definition}{moment-basis-1d}.
\end{Lemma}

\begin{proof}
  The proof is left to the reader.
\end{proof}

\begin{Definition}{qk0}
  Let $\widehat T = [-1,1]^d$ be the reference square in $\R^d$. We
  define the space
  \begin{gather}
    \label{eq:stokes:36}
    \Q_k^0 = \Q_k \cap H^1_0(\widehat T).
  \end{gather}
  A basis for $\Q_k^0$ consists of the functions
  \begin{gather}
    \label{eq:stokes:37}
    \phi_{i_1\cdots i_d}(x) = \phi_{i_1}(x_1) \cdots \phi_{i_d}(x_d),
  \end{gather}
  where $i_j=1,\dots,k-1$. For a tensor product mesh cell $T$, the
  space $\Q_k^0(T) = \Q_k(T) \cap H^1_0(T)$ is defined through
  $\Q_h^0$ by mapping.
\end{Definition}

\begin{Definition}{moment-dofs-qk-2d}
  The moment degrees of freedom of the $\Q_k$ element are defined on
  the reference cell $\widehat T$ in two space dimensions as
  \begin{xalignat*}3
    \nodal_{0,i}(u) &= u(x_i)
    &&&x_i&\text{ is vertex of } \widehat T\\
    \nodal_{1,i,j}(u) &= \int_{E_i} u \phi_j\ds
    &\phi_j&\in\Q_{k}^0(E_i)&E_i&\text{ is edge of } \widehat T\\
    \nodal_{2,j}(u) &=\int_{\widehat T} u \phi_j \dx
    &\phi_j&\in\Q_{k}^0(\widehat T).
  \end{xalignat*}
\end{Definition}

\begin{Definition}{moment-dofs-qk-3d}
  The moment degrees of freedom of the $\Q_k$ element are defined on
  the reference cell $\widehat T$ in three space dimensions as
  \begin{xalignat*}3
    \nodal_{0,i}(u) &= u(x_i)
    &&&x_i&\text{ is vertex of } \widehat T\\
    \nodal_{1,i,j}(u) &= \int_{E_i} u \phi_j\ds
    &\phi_j&\in\Q_{k}^0(E_i)&E_i&\text{ is edge of } \widehat T\\
    \nodal_{2,i,j}(u) &= \int_{F_i} u \phi_j\ds
    &\phi_j&\in\Q_{k}^0(F_i)&F_i&\text{ is face of } \widehat T\\
    \nodal_{3,j}(u) &=\int_{\widehat T} u \phi_j \dx
    &\phi_j&\in\Q_{k}^0(\widehat T).
  \end{xalignat*}
\end{Definition}

\begin{Example}{qk-pk1}
  The first two members of the $Q_k-P_{k-1}$ family have the nodal
  representations
  \begin{center}
    \begin{tabular}{c@{\hspace{.2\textwidth}}c}
      \includegraphics[width=.2\textwidth]{./fig/q2-v.tikz}
      &
      \includegraphics[width=.2\textwidth]{./fig/q-p1-p.tikz}
      \\[5mm]
      \includegraphics[width=.2\textwidth]{./fig/q3-v.tikz}
      &
      \includegraphics[width=.2\textwidth]{./fig/q-p2-p.tikz}
    \end{tabular}
  \end{center}
\end{Example}

\begin{remark}
  When we map the reference square to a quadrilateral mesh cell, this
  mapping may be affine for parallelograms or bilinear for general
  quadrilaterals. At some point, we have proven that the mapped $\Q_k$
  space has optimal approximation properties, that is, approximation
  of order $k$ in $H^1$ and of order $k+1$ in $L^2$. Such a thing has
  not been proven for a bilinearly mapped $\P_k$ element. And,
  unfortunately it is not true. We therefore have to distinguish
  between a mapped and an unmapped pressure
  space. In~\cite{ArnoldBoffiFalk02}, it is proven that the mapped
  polynomial space has worse approximation, in the worst case one
  order less than the unmapped.
\end{remark}

\subsection{The family of Hood-Taylor elements}

\begin{Definition}{hood-taylor}
  The family of Hood-Taylor elements on simplices in dimension $d=2,3$
  for polynomial degrees $k\ge 1$ consists of the pairs
  \begin{gather}
    \label{eq:stokes:38}
    \vV_h = H^1_h(\P_k)^d \cap \vV,
    \qquad
    Q_h = H^1_h(\P_{k-1}) \cap Q.
  \end{gather}
  On quadrilaterals and hexahedra, it consists of the pairs
  \begin{gather}
    \label{eq:stokes:39}
    \vV_h = H^1_h(\Q_k)^d \cap \vV,
    \qquad
    Q_h = H^1_h(\Q_{k-1}) \cap Q.
  \end{gather}
\end{Definition}

\begin{Example}{hood-taylor-triangle}
  The first two members of the Hood-Taylor family on triangles have
  the nodal representations
  \begin{center}
    \begin{tabular}{cc@{\hspace{.2\textwidth}}c}
      $\P_2-\P_1$
      &\includegraphics[width=.2\textwidth]{./fig/p2-v.tikz}
      &\includegraphics[width=.2\textwidth]{./fig/p1-p.tikz}
      \\[5mm]
      $\P_3-\P_2$
      &\includegraphics[width=.2\textwidth]{./fig/p3-v.tikz}
      &\includegraphics[width=.2\textwidth]{./fig/p2-p.tikz}
    \end{tabular}    
  \end{center}
\end{Example}

\begin{Example}{hood-taylor-quad}
  The first two members of the Hood-Taylor family on quadrilaterals
  have the nodal representations
  \begin{center}
    \begin{tabular}{cc@{\hspace{.2\textwidth}}c}
      $\Q_2-\Q_1$
      &\includegraphics[width=.2\textwidth]{./fig/q2-v.tikz}
      &\includegraphics[width=.2\textwidth]{./fig/q1-p.tikz}
      \\[5mm]
      $\Q_3-\Q_2$
      &\includegraphics[width=.2\textwidth]{./fig/q3-v.tikz}
      &\includegraphics[width=.2\textwidth]{./fig/q2-p.tikz}
    \end{tabular}    
  \end{center}
\end{Example}

\begin{intro}
  The stable elements of the previous section featured discontinuous
  pressure spaces. Therefore, it was natural to split the analysis
  into cell-wise constant pressure and higher order. This is the basic
  technique behind \slideref{Lemma}{bubble-discontinuous} and
  \slideref{Theorem}{discontinuous-pressure-normal-velocity}. Here,
  the pressure is continuous, such that a cell-wise analysis is not
  feasible anymore. The solution is looking at patches, so called
  macro elements. The analysis is due to~\cite{Stenberg90} and
  consists of three parts: first, the covering of the domain with a
  macro element partitioning, then the local stability on each macro
  element with respect to an auxiliary norm on the pressure space, and
  finally the application of an abstract argument known as Verfürth's
  trick~\cite{Verfuerth84}.
\end{intro}

\begin{Definition}{macro-equivalence}
  A \define{macro element} $M\subset \T_h$ is a union of cells
  $\cell_i\in\T_h$ connected by their boundary faces. Given the
  mappings $\Phi_\cell\colon \widehat\cell \to \cell$, there is a
  reference macro element $\widehat M$ and a mapping
  $\Phi_M\colon \widehat M\to M$ such that $\Phi_M(\widehat M) =
  M$. We say that $M$ is equivalent to $\widehat M$.

  We will use the symbol $M$ for the set of cells constituting a macro
  element as well as for the subset of $\domain$ covered by their union.
\end{Definition}

\begin{Problem}{reference-macros}
  Suggest reference macro elements $\widehat M$ for the following
  situations:
  \begin{enumerate}
  \item Two triangles sharing an edge
  \item Two quadrilaterals sharing an edge
  \item Two hexahedra sharing a face
  \item Three quadrialterals at the edge between a coarse cell and a
    refined cell
  \end{enumerate}
  Based on the mappings $\Phi_\cell$ from the reference cell to the
  actual mesh cells, define a continuously invertible mapping from
  $\Psi_M:\widehat M \to M$ (it is sufficent to describe the
  construction without writing a closed formula). Argue, that under the
  assumption of shape regularity, all macro elements $M$ with the same
  connectivity between their cells are equivalent to the same
  reference macro element $\widehat M$.
\end{Problem}


\begin{Definition}{macro-spaces}
  For a \putindex{macro element} $M$, we introduce the spaces
  \begin{align}
    \label{eq:stokes:27}
    \vv_M &= \bigl\{ \vu\in H^1_0(M;\R^d) \big\vert
            \;\exists \vv_h\in \vV_h\colon \vu=\vv_{h|M}\bigr\},
    \\
    \label{eq:stokes:28}
    Q_M &= \bigl\{ p\in L^2(M) \big\vert
            \;\exists q_h\in Q_h\colon p=q_{h|M}\bigr\},
  \end{align}
  the kernel of the discrete, local gradient operator
  \begin{gather}
    \label{eq:stokes:29}
    \ker{B^\transpose_M} = \bigl\{q\in Q_M \big\vert
    \;\forall \vv\in \vV_M\colon \form(\div \vv,q) = 0\bigr\}.
  \end{gather}
\end{Definition}

\begin{Definition}{verfuerth-norm}
  Let $\faces_h^i$ be the set of interior faces of the mesh $\mesh_h$.
  We introduce the alternative norm on $Q_h$ defined by
  \begin{gather}
    \label{eq:stokes:40}
    \norm{p}_{h}^2 =
    \sum_{\cell\in\mesh_h} h^2_\cell \norm{\nabla p}_\cell^2
    +
    \sum_{\face\in\faces_h^i} \norm{\jmp{p}}_\face^2,
  \end{gather}
  where for a face $\face$ between two cells $\cell_1$ and $\cell_2$
  we define the \define{jump operator}
  \begin{gather}
    \jmp{p} = p_1-p_2.
  \end{gather}
\end{Definition}

\begin{remark}
  For continuous pressure spaces, the norm $\norm{p}_h$ is simply the
  norm of the gradient taken in the interior of all cells.
\end{remark}

\begin{Definition}{macro-seminorm}
  On each macro element $M$, let $\faces_M^i$ be the set of interior
  faces of $M$. We define the seminorm
  \begin{gather}
    \label{eq:stokes:41}
    \snorm{p}_M
    = \sum_{\cell\in M} h^2_\cell \norm{\nabla p}_\cell^2
    + \sum_{\face\in\faces_M^i} \norm{\jmp{p}}_\face^2.
  \end{gather}
  It is not a norm because $Q_M$ contains constant functions.
\end{Definition}

\begin{Lemma}{macro1}
  Assume that there is a covering of $\domain$ by macro elements such
  that every interior face $\face \in \faces_h^i$ is an interior face
  of one macro element and each cell $\cell\in\mesh_h$ is an element
  of not more than $n_O$ macro elements. Then, the local stability
  estimate
  \begin{gather}
    \label{eq:stokes:42}
    \sup_{\vv\in \vV_M} \frac{\form(\div \vv,q)_M}{\snorm{\vv}_{1,M}}
    \ge \widehat \beta \snorm{q}_M
    \qquad\forall q\in Q_M,
  \end{gather}
  implies the stability estimate
  \begin{gather}
    \label{eq:stokes:43}
    \sup_{\vv\in \vV_h} \frac{\form(\div \vv,q)}{\norm{\vv}_{1}}
    \ge \beta \norm{q}_h
    \qquad\forall q\in Q_h,
  \end{gather}
  with a constant $\beta$ independent of the mesh size $h$.
\end{Lemma}

\begin{proof}
  For arbitrarily chosen $q\in Q_h$, choose for each $M$ according to
  assumption~\eqref{eq:stokes:42} functions $\vv_M\in \vV_M$ with
  $\norm{\vv_M}_1 \le \snorm{q}_M$
  such that
  \begin{gather}
    \form(\div \vv_M,q)
    = \form(\div \vv_M,q)_M
    \ge \widehat \beta \snorm{q}_M^2.
  \end{gather}
  Define $\vv = \sum \vv_M$. Since every face is an interior face of a
  macro element, every cell is element of at least one macro
  element. Hence,
  \begin{gather}
    \form(\div \vv, q) = \sum_M \form(\div \vv_M,q)
    \ge \widehat \beta \sum_M \snorm{q}_M^2
    \ge \widehat \beta \norm{q}_h^2.
  \end{gather}
  Furthermore, there holds by Poincaré inequality
  \begin{gather}
    c_S \norm{\vv}_1 \le \snorm{\vv}_1
    \le \sum_M \snorm{\vv_M}_{1} \le \sum_M \snorm{q}_M
    \le n_O \norm{q}_h.
  \end{gather}
  Thus, the estimate holds with
  \begin{gather}
    \beta = \frac{c_S\widehat\beta}{n_O}.
  \end{gather}
\end{proof}

\begin{Lemma}{macro-local}
  Let $\{M\}$ with $M\subset \mesh_h$ be a set of macro elements
  equivalent to the same reference macro element $\widehat M$. Let the
  family $\{\mesh_h\}$ be shape regular and assume that on each macro
  $M$ the set $\ker{B^\transpose_{M}}$ only contains the constant functions. Then,
  there is a constant $\beta_M>0$ independent of $h$ such that for all
  $M$ there holds
  \begin{gather}
    \label{eq:stokes:31}
    \inf_{p\in Q_M} \sup_{\vv\in \vV_M}
    \frac{\form(\div \vv,q)_M}{\snorm{\vv}_{1,M}\snorm{q}_{M}}
    \ge \beta_{\widehat M}.
  \end{gather}
\end{Lemma}

\begin{Problem}{macro-local}
  Prove \slideref{Lemma}{macro-local}. Furthermore, prove that under
  the assumption that there is a finite set of reference macro
  elements $\widehat M_i$, such that all macro elements in a family
  are equivalent to one of them, the estimate holds with a uniform
  constant $\beta>0$.
\begin{solution}
  For each $M$, the existence of such a constant $\beta_{M}$ is
  equivalent to the fact that the smallest nonzero singular value is
  strictly greater than zero in finite dimensional
  spaces. Furthermore, the kernel of the seminorm and of $B_M^\transpose$
  coincide.

  Next, we observe that $\nabla \Phi_{M}$ is bounded by the
  $\nabla\Phi_{\cell_i}$, which in turn is uniformly bounded by the
  shape regularity. Therefore, by a cell-wise scaling argument and the
  fact that $\widehat M$ has only finitely many cells we have
  \begin{gather}
    \beta_{\widehat M} = \min_M \beta_M > 0.
  \end{gather}
\end{solution}
\end{Problem}

\begin{remark}
  Depending on the technique of proof being used, we also may decide
  to impose~\eqref{eq:stokes:31} directly for each macro element.
\end{remark}

\begin{remark}
  So far, we have proven that under the assumption that the kernel of
  the macro problems only contains the constant functions, we have an
  inf-sup condition with the pressure norm $\norm{.}_h$. It remains to
  use Verfürth's trick to prove the condition for $\norm{.}_0$.
\end{remark}

\begin{Lemma}{verfuerth1}
  Assume that there is an $H^1$-stable interpolation operator $I_h :
  \vV\to \vV_h$
  according to \slideref{Assumption}{locally-quasi-uniform}. Then,
  there are positive constants $c_1$ and $c_2$ independent of $h$ such
  that for any $q_h\in Q_h$ there holds
  \begin{gather}
    \label{eq:stokes:44}
    \sup_{\vv_h\in \vV_h} \frac{\form(\div \vv_h, q_h)}{\norm{\vv_h}_{\vV}}
    \ge c_1 \norm{q_h}_Q - c_2 \norm{q_h}_h.
  \end{gather}
\end{Lemma}

\begin{proof}
  We begin by using the continuous inf-sup condition to deduce that
  for arbitrary $q_h\in Q_h$ there is $\vv\in \vV$ with
  $\norm{\vv}_{\vV} \le \norm{q_h}_Q$ such that
  \begin{gather}
    \form(\div \vv,q_h) \ge c_1 \norm{q_h}_Q^2.
  \end{gather}
  Now, let $\vv_h = I_h \vv$. Hence,
  \begin{align}
    \form(\div \vv_h, q_h)
    &= \form(\div \vv_h - \div \vv,q_h) + \form(\div \vv,q_h)\\
    &\ge \sum_{\cell\in\mesh_h} \form(\vv-\vv_h,\nabla q_h)_{\cell}
      + \sum_{\face\in\faces_h^i}
      \form([v_h-\vv]\cdot\n_1,\jmp{q_h})_\face
      + c_1 \norm{q_h}_Q\\
    &\ge -\left[\sum_{\cell\in\mesh_h} h_\cell^{-2} \norm{\vv-\vv_h}_\cell^2
      +\sum_{\face\in\faces_h^i} h_\face^{-1}
      \norm{\vv-\vv_h}_\face\right]
      \norm{q_h}_h + c_1 \norm{q_h}_Q\\
    &\ge -c \snorm{\vv}_1\norm{q_h}_h+ c_1 \norm{q_h}_Q\\
    &\ge \left[c_1 \norm{q_h}_Q - c_2 \norm{q_h}_h\right]
      \norm{q_h}_Q.
  \end{align}
  Furthermore, we have by the interpolation estimate
  \begin{gather}
    \snorm{\vv_h} \le c \snorm{\vv} \le c \norm{q_h}_Q,
  \end{gather}
  which proves the result by dividing $\form(\div \vv_h,q_h)$ by the
  norm of $\vv_h$.
\end{proof}

\begin{Lemma}{verfuerth2}
  Let the assumptions of \slideref{Lemma}{verfuerth1} hold, and assume
  that there is a constant $\tilde \beta$ such that
  \begin{gather}
    \sup_{\vv\in \vV_h} \frac{\form(\div \vv,q)}{\norm{\vv}_{1}}
    \ge \tilde \beta \norm{q}_h
    \qquad\forall q\in Q_h.
  \end{gather}
  Then, the inf-sup condition
  \begin{gather}
    \sup_{\vv\in \vV_h} \frac{\form(\div \vv,q)}{\norm{\vv}_{1}}
    \ge \beta \norm{q}_Q
    \qquad\forall q\in Q_h,
  \end{gather}
  holds with $\beta$ determined by $c_1$, $c_2$ and $\tilde \beta$.
\end{Lemma}

\begin{proof}
  For any $q_h\in Q_h$ and $\theta\in[0,1]$ we have
  \begin{align}
    \sup_{\vv_h\in \vV_h} \frac{\form(\div \vv_h,q_h)}{\norm{\vv_h}_{\vV}}
    &=
      \theta \sup_{\vv_h\in \vV_h} \frac{\form(\div \vv_h,q_h)}{\norm{\vv_h}_{\vV}}
    + (1-\theta)\sup_{\vv_h\in \vV_h} \frac{\form(\div
      \vv_h,q_h)}{\norm{\vv_h}_{\vV}}
    \\
    &\ge \theta c_1 \norm{q_h}_Q - c_2 \theta \norm{q_h}_h
      + (1-\theta) \tilde\beta \norm{q_h}_h
    \\
    & \ge \frac{c_1 \tilde\beta}{c_2+\tilde\beta} \norm{q_h}_Q,
  \end{align}
  by choosing $\theta = \tilde\beta/(c_2+\tilde\beta)$.
\end{proof}

\begin{Theorem}{hood-taylor-stability}
  The Hood-Taylor families are inf-sup stable. Thus, for solutions
  $u\in H^{k+1}(\domain;\R^d)\cap \vV$ and $q\in H^k(\domain)\cap Q$,
  there holds
  \begin{gather}
    \norm{\vu-\vu_h}_1 + \norm{p-p_h}_0
    \le c h^k\bigl(\snorm{\vu}_{k+1} + \snorm{p}_k\bigr).
  \end{gather}
\end{Theorem}

\begin{proof}
  Summarizing all results of this section, the only thing that is left
  is defining a covering of $\mesh_h$ with macro elements, such that
  $\ker{B_M^\transpose}$ contains only the constant functions. We do this
  at the example of the lowest order elements on quadrilaterals and
  triangles in the lemmas below. Both kinds of patches can be used to
  cover the whole mesh, such that we can use \slideref{Lemma}{macro1}
  and \slideref{Lemma}{verfuerth2} to prove the inf-sup condition.

  A general proof for higher order elements can be found
  in~\cite{StenbergSuri96}.
\end{proof}

\begin{Lemma}{patch-test-triangle}
  For the $P_2-P_1$ element choose the patch $M$ as in
  \begin{center}
    \includegraphics[width=.8\textwidth]{./fig/triangle-patch.tikz}
  \end{center}
  Then,
  \begin{gather}
    \label{eq:stokes:32}
    \ker{B_M^\transpose} = \bigl\{ q\in Q_M \big\vert
    \;\forall \vv\in \vV_M\colon b(\vv,q) = 0 \bigr\}
    = \P_0.
  \end{gather}
\end{Lemma}

\begin{proof}
  First, we observe that $\nabla q_h$ is constant on each cell and
  that the tangential derivatives $t_i\cdot\nabla q_h$ coincide for
  both adjacent cells due to the continuity of $q_h$. Now, we will
  derive conditions for $\ker{B_M^\transpose}$ by choosing special test
  functions in $\vV_M$ defined through interpolation in the points $x_1$
  and $x_2$.

  Furthermore, note that the shape function $\phi$ in $\P_2$
  associated with the center of an edge is of the form
  $\lambda_1\lambda_2$ using the barycentric coordinates associated to
  the vertices at the ends of this edge. This function is positive
  everywhere inside the triangle $\cell_i$. Hence, there are positive
  numbers
  \begin{gather}
    w_1 = \int_{\cell_1} \phi\dx,
    \quad
    w_1 = \int_{\cell_2} \phi\dx,
  \end{gather}
  Now, let $u(x_1)\cdot t_1 = 1$, $u(x_1)\cdot\n_1 = 0$, and $u(x_2)
  = 0$. Then,
  \begin{gather}
    \form(\div u,q_h)_M = -\form(\vu,\nabla q_h)_M
    = -(w_1+w_2) \nabla q_h\cdot t_1.
  \end{gather}
  Hence, $q_h\in \ker{B_M^\transpose}$ implies $\nabla q_h\cdot t_1 = 0$ in
  $\cell_1$ and $\cell_2$.

  Exchanging $x_2$ for $x_1$, there holds  $\nabla q_h\cdot t_2 = 0$ in
  $\cell_2$ and $\cell_3$. Since $t_1$ and $t_2$ are not collinear, we
  obtain
  \begin{gather}
    \label{eq:stokes:34}
    \nabla q_h|_{\cell_1} = 0.
  \end{gather}

  Now we choose the test function $u(x_1)\cdot \n_1 = 1$,
  $u(x_1)\cdot t_1 = 0$, and $u(x_2) = 0$. We get
  \begin{gather}
    0 = \form(\div u,q_h) = -w_1 \nabla q_h|_{\cell_1}\cdot\n_1
    - w_2 \nabla q_h|_{\cell_2}\cdot\n_1.
  \end{gather}
  Due to~\eqref{eq:stokes:34}, the first term vanishes and together
  with the tangential condition before, we obtain
  \begin{gather}
    \nabla q_h|_{\cell_2} = 0.
  \end{gather}
  Exchanging again $x_2$ for $x_1$, we have the same for $\cell_3$,
  which proves the result.
\end{proof}

\begin{Lemma}{patch-test-quad}
  For the $Q_2-Q_1$ element choose the patch $\widehat M$ as in
  \begin{center}
    \includegraphics[width=.5\textwidth]{./fig/rectangle-patch.tikz}
  \end{center}
  Then,
  \begin{gather}
    \ker{B_M^\transpose} = \bigl\{ q\in Q_M \big\vert
    \;\forall \vv\in \vV_M\colon b(\vv,q) = 0 \bigr\}
    = \P_0.
  \end{gather}
\end{Lemma}

\begin{proof}
  Choose macro elements consisting of two quadrilateral charing an
  edge. Then, the reference macro element $\widehat M$ consists of the
  cells $[-1,0]\times [0,1]$ and $[0,1]^2$. We note that the velocity
  degrees of freedom are in $x_1$, $x_2$, and $x_3$, while those for
  the pressure are in $a$ to $f$.

  We do the analysis on the reference patch first. There, we have
  $u\in \Q_2^2$ and $\nabla q\in \Q_1^2$. Therefore, $u\cdot\nabla q
  \in \Q_3$ and the Simpson rule is exact on each cell. Hence
  \begin{gather}
    -\form(\div u,q)_{\widehat M} = \form(\vu,\nabla q)_{\widehat M}
    = \frac49 u(x_1) \nabla q(x_1)
    + \frac49 u(x_2) \nabla q(x_2)
    + \frac49 u(x_3) \nabla q(x_3).
  \end{gather}
  We first test with velocites such that $u(x_3)=0$ and one of
  $u_{1/2}(x_{1/2})$ is equal to one. Take for instance $u_1(x_1) =
  1$. Then, the equation above implies for $q\in \ker{B^\transpose_M}$ that
  $\d_1 q(x_1) = 0$. Traversing through all four coimbinations, we
  obtain
  \begin{gather}
    \nabla q(x_1) = \nabla q(x_2) = 0.
  \end{gather}
  On the cell $\cell_2$, we have by bilinear interpolation
  \begin{gather}
    q(x,y) = q(b)(1-x)(1-y) + q(x)x(1-y) + q(e)(1-x)y + q(f)xy,
  \end{gather}
  and a similar representation on $\cell_1$. Thus,
  the conditions above translates to the system
  \begin{align}
    q(c)+q(f) &= q(b)+q(e) \\
    q(b)+q(c) &= q(e)+q(f) \\
    q(b)+q(e) &= q(a)+q(d) \\
    q(d)+q(e) &= q(a)+q(b),
  \end{align}
  which in tern has solutions given for any $\alpha,\beta\in\R$ by
  \begin{gather}
    \arraycolsep2pt
    \begin{matrix}
      q(a) &=& q(c) &=& q(e) &=& \alpha\\
      q(b) &=& q(d) &=& q(f) &=& \beta
    \end{matrix}
  \end{gather}
  The kernel of $B^\transpose_M$ is a subspace of the space generated by
  $\alpha$ and $\beta$. Now we choose $u_2(x_3)=1$ and all other
  degrees of freedom zero. Again by simpson rule, we have
  \begin{gather}
    0 = -\form(\div u,q) = \frac49 u(x_3)\cdot\nabla q(x_3)
    = \frac29 \bigl(q(e)-q(b)\bigr).
  \end{gather}
  Hence, $\alpha = q(e) = q(b) = \beta$ and
  \begin{gather}
    q\in \ker{B^\transpose_M} \quad\Rightarrow\quad
    q\in \P_0.
  \end{gather}
  For a patch $M$ equivalent to $\widehat M$, we observe that
  \begin{gather}
    -\form(\div u,q)_M = \form(\vu,\nabla q)_M
    = \sum_{i=1,2}
    \int_{\widehat{\cell_i}} \hat u^\transpose (\nabla\Phi)^{-T} \nabla
    \widehat q \;\det(\nabla\Phi) \,d\widehat x.
  \end{gather}
  Cramer's rule implies
  \begin{gather}
    (\nabla\Phi_i)^{-T} \det(\nabla\Phi) =
    \begin{pmatrix}
      \d_2\Phi_2 & -\d_1\Phi_2\\
      -\d_2\Phi_1 & \d_1\Phi_1,
    \end{pmatrix}
  \end{gather}
  where the mapping $\Phi$ is bilinear on each cell. Hence, on
  $\widehat T$
  \begin{gather}
    (\nabla\Phi_i)^{-T} \det(\nabla\Phi) \nabla \widehat q \in Q_1^2,
  \end{gather}
  such that the integrand above is bicubic and the Simpson rule
  argument still applies.
\end{proof}

\subsection{Almost incompressible elasticity}

\begin{intro}
  If we discretize the mixed formulation of almost incompressible
  elasticity with any of the stable Stokes pairs of the preceding
  sections, we can apply
  \slideref{Corollary}{stabilized-mixed-convergence} to obtain optimal
  error estimates. Nevertheless, our problem with almost
  incompressible elasticity was not the approximation of the pressure
  (which was introduced artificially anyway), but locking. So, how
  does the choice of an inf-sup stable pair avoid locking?
  
  Locking, in the terminology developed in the previous chapter, can
  be described as the fact that the kernel of the discrete divergence
  operator is too small, in the example presented even
  \begin{gather}
    \ker B_h = \{0\}.
  \end{gather}
  Note though, that there might be more subtle locking effects, where
  the approximation is reduced but not destroyed.

  In view of \slideref{Theorem}{galerkin-mixed-u-kerbh}, locking means
  that $\vV_h^g$ is too small or even the zero space, and therefore the
  quasi best-approximation result of this theorem is useless, since
  \begin{gather}
    \inf_{w_h\in \vV_h^g} \norm{\vu-w_h}_{\vV} \not\to 0
    \quad\text{as } h \to 0.
  \end{gather}
  
  The additional assumption of the inf-sup condition
  in\slideref{Theorem}{galerkin-mixed-p} on the other hand guarantees
  that an approximation of the kernel is possible, and thus, locking
  becomes impossible.
\end{intro}

\begin{Lemma}{reduced integration}
  Let $\vV_h\times Q_h$ be a stable pair for the Stokes problem
  admitting a Korn inequality. Let furthermore $\Pi_Q$ be the
  $L^2$-projection onto $Q_h$. Then, the solution $\vu_h\in \vV_h$ to the
  weak formulation
  \begin{gather}
    \label{eq:stokes:33}
    2\mu \form(\strain{\vu_h},\strain \vv) + \lambda (\Pi_Q \div
    \vu_h,\Pi_q\div \vv) = (f,v)
    \quad\forall \vv\in \vV_h,
  \end{gather}
  admits the quasi-optimality estimate
  \begin{gather}
    \norm{\vu-\vu_h}_1 \le c \sup_{\vv_h\in \vV_h}\norm{\vu-\vv_h}_1,
  \end{gather}
  with a constant $c$ independent of the quotient $\lambda/\mu$.
\end{Lemma}

\begin{proof}
  We introduce the auxiliary variable $p_h\in Q_h$ by the condition
  \begin{gather}
    \int_\domain \div \vu_h q_h \dx = \int_\domain p_h q_h\dx
    \quad\forall q_h\in Q_h.
  \end{gather}
  By definition of the $L^2$-projection, we have
  \begin{gather}
    \form(\div \vu_h, q_h) = \form(\Pi_Q\div \vu_h,q_h) = \form(p_h,q_h).
  \end{gather}
  Since $\Pi_Q\div \vu_h$ and $p_h$ are in the same space, this implies
  that $p_h = \Pi_Q\div \vu_h$ pointwise. In addition, we observe that
  \begin{gather}
    \form (p_h, \Pi_Q\div \vv) = \form (p_h, \div \vv).
  \end{gather}
  Hence, the formulation~\eqref{eq:stokes:33} is equivalent to
  \begin{gather}
    \arraycolsep2pt
    \begin{matrix}
      2\mu\form(\strain{\vu_h},\strain \vv) &+& \form(p_h,\div \vv)
      &=& \form(f,v) &\qquad&\forall \vv\in \vV_h\\
      \form(\div \vu_h, q) &-&\tfrac1\lambda\form(p_h,q)&=&0&&\forall q\in Q_h.
    \end{matrix}
  \end{gather}
  This is the Stokes problem augmented by a positive definite bilinear
  form $c(.,.)$, such that
  \slideref{Theorem}{mixed-stabilized-well-posed} and
  \slideref{Corollary}{stabilized-mixed-convergence} apply.
\end{proof}

\begin{remark}
  The technique in the previous lemma is often called \define{reduced
    integration}. This refers to the fact, that we can replace the
  explicit projection $\Pi_Q$ by using a quadrature formula which is
  exact on $Q_h$, but zero for all higher order polynomials occuring
  in $\div \vu_h$.
\end{remark}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
