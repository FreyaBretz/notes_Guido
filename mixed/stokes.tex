
\section{Well-posedness of the continuous problem}

\begin{intro}
  We begin our investigation into the Stokes problem by investigating
  the well-posedness of the continuous problem. This is particularly
  simple, since we have
  \begin{gather*}
    a(u,v) = \form(\strain u,\strain v)
  \end{gather*}
  for the original Stokes problem in \blockref{Definition}{stokes-eq1}
  and
  \begin{gather*}
    a(u,v) = \form(\nabla u,\nabla v)
  \end{gather*}
  for the simplified \putindex{Stokes equations} in
  \blockref{Definition}{stokes-eq2}. From the standard theory for the
  Laplacian, we know that the second one is $V$-elliptic on
  $V=H^1_0(\domain;\R^d)$. For the first one, we conclude this by using a
  \putindex{Korn inequality}. Therefore, we can already conclude a
  first result:
\end{intro}

\begin{Lemma}{stokes-a-elliptic}
  Let $V=H^1_0(\domain, \R^d)$ and $V_h\subset V$ a finite dimensional
  subspace. Then, $a(.,.)$ is elliptic on $\ker B$ and on $\ker{B_h}$
  independent of the choices of $Q$ and $Q_h$.
\end{Lemma}

\begin{remark}
  We focus here on no-slip boundary condition on the whole boundary as
  the exemplary case. Other boundary conditions are possible, but as
  soon as the Dirichlet boundary for one velocity component becomes
  too small, the ellipticity of $a(.,.)$ on $V$ must be established by
  new arguments known for instance for Robin boundary conditions. In
  the extreme case of natural boundary conditions all around, $V$ is
  the subspace of $H^1(\domain, \R^d)$ obtained by dividing by the
  space of all translations for the simplified form and by the space
  of all rigid body movements.

  Note that we have established already in
  \blockref{Lemma}{divergence-compatibility} that the condition
  $V=H^1_0(\domain, \R^d)$ implies the reduction of the pressure to
  the space $Q = L^2_0(\domain)$ from
  \blockref{Notation}{pressure-constant}.
\end{remark}

\begin{intro}
  The previous lemma guarantees well-posedness of the
  \putindex{reduced problem} in all possible cases. Therefore, the
  remainder of this section is only concerned with the inf-sup
  condition for the divergence operator. We
  follow~\cite{GiraultRaviart86} in this presentation.
\end{intro}

\begin{Lemma}{stokes-helmholtz}
  Let $V=H^1_0(\domain,\R^d)$. Then, the divergence operator
  $\div\colon V \to L^2(\domain)$ is continuous and the subspace
  \begin{gather*}
    V^0 = \ker \div
    = \bigl\{v\in V \big|
    \div v = 0 \text{ a.e.} \bigr\}
  \end{gather*}
  is closed in $V$ and $V$ admits the orthogonal decomposition
  \begin{gather*}
    V = V^0\oplus V^\perp.
  \end{gather*}
\end{Lemma}

\begin{proof}
  We have that
  \begin{gather*}
    \norm{\div v}_{L^2(\domain)}^2
    = \int_\domain \left(\sum \d_iv_i\right)^2\dx
    \le d \int_\domain \sum \abs{\d_iv_i}^2\dx
    \le d \norm{v}_{H^1(\domain;\R^d)}^2.
  \end{gather*}
  Thus, the divergence operator is a continuous mapping from $V$ to
  $L^2(\domain)$. The definition of $V^0$ is equivalent to the
  definition of zero in $L^2(\domain)$. Finally, since the kernel is
  the pre-image of a closed set under a continuous map, it is
  closed. The existence of the decomposition follows from
  \blockref{Theorem}{orthogonal-complement}.
\end{proof}

\begin{Lemma}{stokes-grad}
  If $f\in V^* = H^{-1}(\domain;\R^d)$ satisfies
  \begin{gather*}
    f(v) = 0 \quad\forall v\in V^0,
  \end{gather*}
  then, there exists $p\in L^2(\domain)$ such that
  \begin{gather*}
    f = \nabla p.
  \end{gather*}
  If $\domain$ is connected, then $p$ is unique up to an additive
  constant.
\end{Lemma}

\begin{proof}
  First, we identify $L^2(\domain)$ with its dual. Then, by
  \begin{gather*}
    \scal(-\nabla p, v)_{V^*\times V}
    = \scal(p, \div v)_{L^2(\domain)},
    \qquad\forall v\in V,
  \end{gather*}
  we see that $-\nabla\colon L^2(\domain)\to V^*$ is the dual to the
  divergence operator. Using the Cauchy-sequence argument, we see that
  $\range{\div}$ is closed in $L^2(\domain)$ and the closed range
  theorem applies. Thus, $\range{-\nabla}$ is closed in $V^*$ and
  \begin{gather*}
    \range{\nabla} = \polar{(V^0)} \cong V^\perp
  \end{gather*}
  is the polar set of the kernel $V^0$. This implies the statement
  that there is a $p$ for every $f$. Uniqueness follows by the fact
  that the only differentiable functions on a connected domain with
  $\nabla p=0$ are the constant functions, and by density of such
  functions in $L^2(\domain)$.
\end{proof}

\begin{Corollary}{stokes-iso}
  Let $\domain$ be connected. Then,
  \begin{enumerate}
  \item $\nabla\colon L^2_0(\domain) \to V^0$ is an isomorphism
  \item $\div\colon V^\perp \to L^2_0(\domain)$ is an isomorphism
  \end{enumerate}
\end{Corollary}

\begin{Theorem}{stokes-infsup}
  Let $\domain\subset \R^d$ be a Lipschitz-domain,
  $V=H^1_0(\domain,\R^d)$ and $Q=L^2_0(\domain)$. Then, there is a
  constant $\beta>0$ depending only on the geometry of $\domain$ such
  that
  \begin{gather}
    \label{eq:stokes:1}
    \inf_{q\in Q}\sup_{v\in V}\frac{\form(\div
      v,q)}{\norm{v}_V\norm{q}_Q} \ge \beta.
  \end{gather}
  Furthermore, the problem finding $(u,p)\in V\times Q$ such that
  \begin{gather}
    \label{eq:stokes:3}
    a(u,v)+\form(\div v,p)+\form(\div u,q) = f(v)+g(q)
    \quad\forall v\in V, q\in Q,
  \end{gather}
  has a unique solution for any right hand side $f\in V^*$ and $g\in
  \range{\div}$.
\end{Theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Stable discretizations}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{intro}
  We begin by application of the generic theory of the previous
  chapter to the Stokes problem in order to obtain a generic error
  estimate based on the concrete choice of norms and a single
  assumption. Guided by this theorem, we spend the remaining part of
  this section exploring different options for the discrete spaces.
\end{intro}

\begin{Theorem}{stokes-convergence}
  Let $V=H^1_0(\domain;\R^d)$ and $Q=L^2_0(\domain)$. Let furthermore
  $V_h\subset V$ and $Q_h\subset Q$ be discrete subspaces such that
  there exists $\beta>0$ independent of $h$ such that
  \begin{gather}
    \label{eq:stokes:2}
    \inf_{q_h\in Q_h}\sup_{v_h\in V_h}\frac{\form(\div
      v_h,q_h)}{\norm{v_h}_V\norm{q_h}_Q} \ge \beta.
  \end{gather}
  Then, the Galerkin approximation of~\eqref{eq:stokes:3} admits a
  unique solution $(u_h, p_h)\in V_h\times Q_h$ with the
  quasi-bestapproximation property
  \begin{gather}
    \label{eq:stokes:4}
    \begin{split}
      \norm{u-u_h}_1
      &\le c_1 \inf_{v_h\in V_h}\norm{u-v_h}_1
      + c_2 \inf_{q_h\in Q_h}\norm{p-q_h}_0
      \\
      \norm{p-p_h}_1
      &\le c_3 \inf_{v_h\in V_h}\norm{u-v_h}_1
      + c_4 \inf_{q_h\in Q_h}\norm{p-q_h}_0.
    \end{split}
  \end{gather}
\end{Theorem}

\begin{Corollary}{stokes-convergence2}
  Under the assumptions of \blockref{Theorem}{stokes-convergence},
  let there be in addition interpolation operators $I_{V_h}$ and
  $I_{Q_h}$ such that
  \begin{gather}
    \label{eq:stokes:5}
    \begin{split}
      \norm{u-I_{V_h} u}_1 &\le c h^k \snorm{u}_{k+1} \\
      \norm{p-I_{Q_h} p}_0 &\le c h^k \snorm{p}_{k}.
    \end{split}
  \end{gather}
  Then, there is a constant $c$ independent of the approximation
  spaces such that
  \begin{gather}
    \label{eq:stokes:6}
    \begin{split}
      \norm{u-u_h}_1 &\le c h^k \bigl(\snorm{u}_{k+1} +
      \snorm{p}_{k}\bigr)
      \\
      \norm{p-p_h}_1 &\le c h^k \bigl(\snorm{u}_{k+1} +
      \snorm{p}_{k}\bigr).
    \end{split}
  \end{gather}
\end{Corollary}
\begin{intro}
  We continue showing that the most natural discretizations
  in two dimensions are not inf-sup stable. This holds for the
  discretization using continuous linear or bilinear elements for both
  velocity components and the pressure as well as for continuous
  linear or bilinear velocity functions combined with piecewise
  constant pressure functions.
\end{intro}

\begin{example}
  We begin with a one-dimensional example. Piecewise linear velocity
  and piecewise linear pressure. Both continuous. Then, $\div v_h$ is
  piecewise constant. Consequently, a pressure function which has zero
  mean value on each cell is in the kernel of $B_h$.
  \begin{figure}[tp]
    \centering
    \includegraphics[width=.6\textwidth]{./fig/p1-p1-1d.tikz}
    \caption[Example for the $P_1-P_1$ pair in one
    dimension]{Piecewise linear pressure (\tikz\draw[color=cyan] (0,0)
      -- (1em,0);) and divergence (\tikz\draw[color=red] (0,0)
      -- (1em,0);) of
      piecewise linear velocity.}
    \label{fig:stokes:p1p1-1d}
  \end{figure}
\end{example}

\begin{example}
  Take a patch of four quadrilaterals or triangles meeting in a common
  vertex. Let $\domain$ be the union of these grid cells. Choose
  linear and bilinear shape functions for $V_h$, respectively. Then, $\dim
  V_h = 2$, since we have one interior vertex with one basis function for
  each velocity component. Choose piecewise constant pressure
  functions. Dividing out the global constant, we conclude that $\dim
  Q_h = 3$. Thus, the statement
  \begin{gather*}
    \forall q_h\in Q_h \;\exists v_h\in V_h:
    \quad \norm{v_h}_1 = \norm{q_h}_0
    \;\wedge\; b(v_h, q_h) \ge \beta \norm{q_h}^2
  \end{gather*}
  cannot hold true. Therefore, the inf-sup condition does not hold. In
  fact, $\ker{B_h} = \{0\}$.
  \begin{figure}[tp]
    \begin{center}
    \hfill
    \includegraphics[width=.3\textwidth]{./fig/patch1.tikz}
    \hfill
    \includegraphics[width=.3\textwidth]{./fig/patch2.tikz}
    \hfill\mbox{}
    \end{center}
    \caption[Very coarse meshes with Dirichlet boundary.]{Very coarse meshes with Dirichlet boundary. Degrees of freedom for pressure (\tikz\draw[shape pressure] (0,0) circle (1ex);) and for both velocity components(\tikz\draw[shape veloxy] (0,0) circle (1ex);).}
    \label{fig:stokes:example1}
  \end{figure}

  Thus, we conclude that for this combination of shape function
  spaces, there is a mesh such that they are not suited for the
  approximation of the Stokes problem. But, this may be a problem of a
  mesh with too few cells. In fact, asymptotically, a triangular mesh
  contains twice as many vertices as cells, a quadrilateral mesh as
  many. Therefore, $\dim V_h > \dim Q_h$ as soon as the mesh is
  sufficiently fine. Will this be sufficient?
\end{example}

\begin{Problem}{p1-p0-unstable}
The domain $\Omega=[0,1]^2$ is decomposed into $N \times N$ congruent squares where each
of them is again divided into two triangles. The decomposition $\mesh_h$
is given by these triangles.

We again choose piecewise linear ansatz functions for the velocity for $V_h$
(vanishing on $\partial \Omega$) and piecewise constant ansatz functions
for $Q_h$.

Is there a $N$ and an orientation of the triangles such that $V_h\times Q_h$ is
inf-sup stable?
\begin{solution}
  The number of degrees of freedom for the velocity is $2(N-1)^2$ and for the
  pressure $2N^2-1$. Hence, there is always a pressure ansatz functions such that
  \begin{align*}
    (\nabla \cdot \boldsymbol{v}_h, q_h)=0 \quad \forall \boldsymbol{v}_h\in V_h.
  \end{align*}
\end{solution}
\end{Problem}

\begin{Problem}{checker-board}
  Let $\domain = (0,1)^2$ be the unit square and let the mesh consist
  of Cartesian squares of side length $1/n$. Choose $V_h \subset V$
  based on bilinear shape functions. Show that the piecewise constant
  pressure function $p_c=\pm 1$ in a checkerboard fashion is in the
  kernel of $B_h^T$, that is
  \begin{gather*}
    b(v_h, p_c) = 0 \quad\forall v_h\in V_h.
  \end{gather*}
\begin{solution}
This time there are $2N^2$ for the velocity and $2N^2-1$ ansatz functions for
the pressure. Therefore, we have to look a big deeper.

Denote by $p_{i+\frac12, j+\frac12}$ the pressure constant on cell $K_{i,j}$
($0\leq i,j \leq N-1$). The values of the velocity at the four vertices are
denoted by $u^1_{i,j}$, $u^1_{i,j+1}$, $u^1_{i+1,j}$, $u^1_{i+1,j+1}$ for the
first component and similarly for the second component.

Using this notation we can write the divergence constraint in terms of nodal and cell values:
\begin{align*}
 &(\nabla \cdot \boldsymbol{v}_h, q_h)\\
   &= \sum_{i,j} q_{i+\frac12,j+\frac12} \int_{K_{i,j}} \nabla \cdot \boldsymbol{v}_h \,\mathrm{d}x\\
   &= \sum_{i,j} q_{i+\frac12,j+\frac12} \int_{\partial K_{i,j}} \boldsymbol{n} \cdot \boldsymbol{v}_h \,\mathrm{d}x\\
   &= \sum_{i,j} q_{i+\frac12,j+\frac12} \frac{h}{2}(u^1_{i+1,j}-u^1_{i,j+1}+u^1_{i+1,j}-u^1_{i+1,j+1})\\
      &\quad +\sum_{i,j} q_{i,j} \frac{h}{2}(u^2_{i,j+1}-u^2_{i+1,j}+u^2_{i,j+1}-u^2_{i+1,j+1})\\
   &= \frac{h}{2}\sum_{i,j} u^1_{i,j}(q_{i-\frac12,j+\frac12}+q_{i-\frac12,j-\frac12}-q_{i+\frac12,j+\frac12}-q_{i+\frac12,j-\frac12})\\
      &\quad +\frac{h}{2}\sum_{i,j} u^2_{i,j}(q_{i+\frac12,j-\frac12}+q_{i-\frac12,j-\frac12}-q_{i+\frac12,j+\frac12}-q_{i-\frac12,j+\frac12})
\end{align*}
Thus,
\begin{align*}
(\nabla \cdot \boldsymbol{v}_h, q_h)=0 \quad \forall \boldsymbol{v}_h\in V_h
\end{align*}
implies
\begin{align*}
q_{i-\frac12,j+\frac12}+q_{i-\frac12,j-\frac12}-q_{i+\frac12,j+\frac12}-q_{i+\frac12,j-\frac12} &=0 \\
q_{i+\frac12,j-\frac12}+q_{i-\frac12,j-\frac12}-q_{i+\frac12,j+\frac12}-q_{i-\frac12,j+\frac12} &=0.
\end{align*}
for all ($0\leq i,j \leq N-1$).
These two constraints can be rephrased as
\begin{align*}
q_{i-\frac12,j+\frac12} &= q_{i+\frac12,j-\frac12} \\
q_{i-\frac12,j-\frac12} &= q_{i+\frac12,j+\frac12}
\end{align*}
for all ($0\leq i,j \leq N-1$). Since the mean value of the pressure must be zero,
the set of pressure functions that fulfill
\begin{align*}
(\nabla \cdot \boldsymbol{v}_h, q_h)=0 \quad \forall \boldsymbol{v}_h\in V_h
\end{align*}
can be described by
\begin{align*}
 p_{i,j} = c \quad \text{if } (i+j) \operatorname{mod} 2 = 0\\
 p_{i,j} = -c \quad \text{if } (i+j) \operatorname{mod} 2 = 1
\end{align*}
where $c\not=0$.
\end{solution}
\end{Problem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Bubble stabilization and the MINI element}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{Definition}{barycentric-coordinates}
  A simplex $T\in \R^d$ with vertices $x_0,\dots,x_d$ is described by
  a set of $d+1$ \define{barycentric coordinates}
  $\lambda_0,\dots,\lambda_d$ such that
  \begin{xalignat}2
    0\le\lambda_i(x) &\le 1& i&=0,\dots,d;\quad x\in T\\
    \lambda_i(x_j) &= \delta_{ij}& i,j&=0,\dots,d\\
    \sum \lambda_i(x) &= 1.
  \end{xalignat}
\end{Definition}

\begin{remark}
  The functions $\lambda_i(x)$ are the shape functions of the linear
  $P_1$ element on $T$. They allow us to define basis functions on the
  cell $T$ without use of a reference element $\widehat T$.

  Note that $\lambda_i\equiv 0$ on the face opposite to the
  vertex $x_i$.
\end{remark}

\begin{example}
  We can use barycentric coordinates to define shape functions on
  simplicial meshes easily, as in
  Table~\ref{tab:barycentric-shapes}.
  \begin{table}[tp]
    \centering
    \begin{tabular}{|c|l|}
      \hline Degrees of freedom
      & Shape functions \\\hline
      \adjustbox{valign=center,margin=3pt}{\includegraphics[width=2cm]{./fig/p1-p.tikz}}
      &
        {\begin{minipage}[b]{6cm}
          \begin{gather*}
            \phi_i = \lambda_i,
            \quad i=0,1,2
          \end{gather*}
        \end{minipage}}
      \\\hline
      \adjustbox{valign=center,margin=3pt}{\includegraphics[width=2cm]{./fig/p2-p.tikz}}
      &
        {\begin{minipage}[b]{6cm}
          \begin{xalignat*}2
            \phi_{ii} &= 2\lambda_i^2 - \lambda_i,
            &i&=0,1,2\\
            \phi_{ij} &= 4\lambda_i\lambda_j
            &j&\neq i
          \end{xalignat*}
        \end{minipage}}
        \\\hline
      \adjustbox{valign=center,margin=3pt}{\includegraphics[width=2cm]{./fig/p3-p.tikz}}
      &
        {\begin{minipage}[b]{6cm}
          \begin{xalignat*}2
          \phi_{iii} &= \tfrac12 \lambda_i(3\lambda_i-1)(3\lambda_i-2)
          &i&=0,1,2\\
          \phi_{ij} &= \tfrac92\lambda_i\lambda_j(3\lambda_j-1)
          &j&\neq i\\
          \phi_0 &= 27\lambda_0\lambda_1\lambda_2
        \end{xalignat*}
        \end{minipage}}
        \\\hline
    \end{tabular}
    \caption{Degrees of freedom and shape functions of simplicial elements
      in terms of barycentric coordinates}
    \label{tab:barycentric-shapes}
  \end{table}
\end{example}

\begin{Notation}{piecewise-polynomial-spaces}
  We denote by
  \begin{gather}
    \label{eq:stokes:8}
    H^k_h(\mathcal P) =
    \bigl\{ v\in H^k(\Omega) \big\vert
    v_{|\cell} \in \mathcal P \;\forall \cell\in\mesh_h\bigr\}
  \end{gather}
  the finite element space which is based on the shape function space
  $\mathcal P$, the mesh $\mesh_h$ and is a subspace of
  $H^k(\domain)$. Examples are the continuous spaces of piecewise
  polynomials or tensor product polynomials of degree $k$
  \begin{gather*}
    H^1_h(\P_k) \qquad H^1_h(\Q_k),
  \end{gather*}
  and the discontinuous spaces
  \begin{gather*}
    H^0_h(\P_k) \qquad H^0_h(\Q_k).
  \end{gather*}
\end{Notation}

\begin{Definition}{h1-bubble-space}
  An $H^1$-\define{bubble function} on a mesh cell $\cell$ is a
  function $b\in H^1_0(\cell)$. A \define{bubble space} $b_\cell$ on
  $\cell$ is a discrete vector space of such bubble functions.  We
  denote the space of bubble functions on the mesh $\mesh_h$ by
  \begin{gather*}
    B_h(b_\cell) = \bigl\{ v\in H^1(\domain) \big\vert
    v_{|_\cell} \in b_\cell \;\forall \cell\in\mesh_h
    \bigr\}.
  \end{gather*}
  If there is no confusion about the local bubble space $b_T$, we also
  write just $B_h$.
\end{Definition}

\begin{example}
  A bubble function on a triangle $\cell$ is easily defined by
  \begin{gather}
    \label{eq:stokes:7}
    b_3 = b_{3,\cell} = \lambda_0\lambda_1\lambda_2.
  \end{gather}
\end{example}

\begin{Definition}{mini-element-p}
  The \define{MINI element} consists of the spaces
  \begin{gather}
    V_h = \bigl(H^1_h(\P_1) \oplus B_h(b_3)\bigr)^2 \cap V,
    \qquad
    Q_h = H^1_h(\P_1) \cap Q.
  \end{gather}
  Its degrees of freedom are:
  \begin{center}
    \includegraphics[width=.2\textwidth]{./fig/p-mini-v.tikz}
    \hspace{1cm}
    \includegraphics[width=.2\textwidth]{./fig/p1-p.tikz}
  \end{center}
\end{Definition}

\begin{intro}
  We will show now that the MINI element is indeed inf-sup stable. To
  this end, we construct the \putindex{Fortin projection} according to
  \blockref{Lemma}{fortin}. Since the construction of such a
  projection operator turns out a bit complicated, we first introduce
  a construction principle, which will help us in our further
  analysis. The idea of this principle is separating the interpolation
  into $V_h$ from the preservation of the divergence.
\end{intro}

\begin{Lemma}{fortin-construction-1}
  Let there be operators $\Pi_1,\Pi_2\colon V \to V_h$ such that
  \begin{xalignat}2
    \label{eq:stokes:10}
    \norm{\Pi_1 v}_V &\le c1 \norm{v}_V
    &\forall v&\in V,\\
    \label{eq:stokes:11}
    \norm{\Pi_2(\identity-\Pi_1)v}_V &\le c_2 \norm{v}_V
    &\forall v&\in V,\\
    \label{eq:stokes:12}
    b(v-\Pi_2v,q_h) &= 0
    &\forall v&\in V, \;q_h\in Q_h,
  \end{xalignat}
  with constants $c_1$ and $c_2$ independent of the discretization
  parameter $h$. Then, the operator
  \begin{gather}
    \label{eq:stokes:9}
    \Pi_h = \Pi_1 + \Pi_2 - \Pi_2\Pi_1
  \end{gather}
  is a \putindex{Fortin projection}, that is, it is bounded on $V$ and
  \begin{gather*}
    b(v-\Pi_h v, q_h) =0 \qquad\forall q_h\in Q_h.
  \end{gather*}
\end{Lemma}

\begin{proof}
  Boundedness of $\Pi_h$ is obvious, such that we only focus on
  preservation of the kernel ob $B$:
  \begin{multline*}
    b(v-\Pi_h v,q_h) = b(v-\Pi_1 v - \Pi_2 v + \Pi_2\Pi_1 v, q_h)
    \\
    = b(v-\Pi_2 v, q_h) - b(\Pi_1 v - \Pi_2\Pi_1 v,q_h) = 0-0 = 0.
  \end{multline*}
\end{proof}

\begin{Assumption}{h1-stable-interpolation}
  There exists an $H^1$-stable interpolation operator $I_h:V\to V_h$
  such that for each cell $\cell \in \mesh_h$ there holds for $m=0,1$
  \begin{gather}
    \label{eq:stokes:13}
    \snorm{v-I_h v}_{m,\cell} \le c \sum_{\cell'\cap\cell
      \neq\emptyset} h_{\cell'}^{1-m}\snorm{v}_{1,\cell'},
  \end{gather}
  with a constant $c$ independent of the mesh parameter $h$.
\end{Assumption}

\begin{remark}
  The interpolation operators of Clément, Scott and Zhang, Schöberl or
  Ern and Guermond fullfil these assumptions.
\end{remark}

\begin{Definition}{locally-quasi-uniform}
  A family of meshes $\{\mesh_h\}$ is called \define{locally
    quasi-uniform}, if there is a constant $c$ such that
  \begin{gather}
    \label{eq:stokes:14}
    \forall h
    \;
    \forall \cell,\cell'\in \mesh_h
    \quad
    \cell\cap\cell'\neq \emptyset
    \Rightarrow
    h_\cell \le c h_{\cell'}.
  \end{gather}
\end{Definition}

\begin{Assumption}{locally-quasi-uniform}
  We assume of all families of meshes that they are shape regular and
  locally quasi-uniform, such that with
  \blockref{Assumption}{h1-stable-interpolation} there holds
  \begin{gather}
    \label{eq:stokes:15}
    \snorm{v-I_h v}_{m,\cell} \le c h_\cell \snorm{v}_{1,\domain_\cell},
  \end{gather}
  where $\Omega_\cell$ is the union of all cells with nonempty
  intersection with $\cell$.
\end{Assumption}

\begin{Theorem}{mini-stability}
  Under \blockref{Assumption}{locally-quasi-uniform},
  the MINI element is inf-sup stable.
\end{Theorem}

\begin{proof}
  We construct a \putindex{Fortin projection} by choosing
  $\Pi_1 = I_h$, where $I_h:V\to \bigl(H^1_h(\P_1)\bigr)^2$ is an
  $H^1$-stable interpolation operator into the standard linear finite
  element space. Now, we construct $\Pi_2: V \to \bigl(B_h\bigr)^2$
  such that for all $q_h\in Q_h$
  \begin{gather*}
    \int_\domain \div(\Pi_2 v-v) q_h \dx
    = \int_\domain (v-\Pi_2v)\cdot\nabla q_h\dx
    = 0.
  \end{gather*}
  Indeed, $\Pi_2 v$ can be chosen on each cell. Since $\nabla q_h$ is
  constant on a cell $\cell$, we choose
  \begin{gather*}
    \int_\cell \Pi_2 v_i \dx
    = \alpha_{\cell,i} \int_\cell b_{3,\cell}\dx
    = \int_\cell v_i\dx,
  \end{gather*}
  where $i=1,2$ enumerates the velocity components. This is possible,
  since the mean value of $b_3$ is strictly positive. Assuming shape
  regularity, we can use the inverse estimate for $b_3$ to obtain
  \begin{gather*}
    \norm{\Pi_2 v}_{1,\cell}
    \le c h_\cell^{-1} \norm{\Pi_2 v}_{0,\cell}
    \le c h_\cell^{-1} \norm{v}_{0,\cell}.
  \end{gather*}
  Finally, we use the estimates for $I_h$ to obtain
  \begin{gather*}
    \norm{\Pi_2 (\identity-\Pi_1) v}_{1,\cell}
    \le c h_\cell^{-1} \norm{v-I_h v}_{0,\cell}
    \le c \snorm{v}_{1,\domain_\cell}.
  \end{gather*}
  Since the number of intersecting of cells of shape regular meshes is
  bounded, the final term is bounded by $\norm v_{1,\domain}$.
\end{proof}

\begin{Notation}{broken-bilinear-form}
  We use the abbreviation
  \begin{gather}
    \label{eq:stokes:18}
    \form(f,g)_{\mesh_h} = \sum_{\cell\in\mesh_h} \form(f,g)_\cell,
  \end{gather}
  for so called \define{broken bilinear form}s, where instead of
  integrating over the union of subsets, we sume the integrals.
\end{Notation}

\begin{Lemma}{mini-stabilized}
  The discretization of the Stokes problem~\eqref{eq:stokes:3} with
  the MINI element is equivalent to solving
  \begin{multline}
    \label{eq:stokes:16}
    \form(\nabla u,\nabla v) + \form(\div v,p) + \form(\div u,q)
    - \form(c_T \nabla p, \nabla q)_{\mesh_h}
    \\
    = f(v) + g(q) + \form(c_T f_T,\nabla q)_{\T_h}
  \end{multline}
  with standard, continuous linear finite elements for velocity and
  pressure. Here,
  \begin{gather*}
    f_T = \int_\cell f\dx,
    \qquad
    c_T = \frac{\form(b_3,1)_\cell}{\norm{\nabla
      b_3}_\cell^2}.
  \end{gather*}
\end{Lemma}

\begin{proof}
  Let $V_h^1 = H^1_h(\P_1)^2$ be the linear, vector-valued velocity
  space and $V_h^b = B_h(b_3)^2$ the bubble function space, such that
  the MINI element space is
  \begin{gather*}
    V_h = V_h^1 \oplus V_h^b.
  \end{gather*}
  Accordingly, we split the solution with the MINI element into
  $u_h = u_h^1 + u_h^b$.  By integration by parts, we obtain for the
  cubic bubble $b_3$
  \begin{gather*}
    \form(\nabla v,\nabla b_{3,\cell})_\cell = \form(-\Delta v,b_{3,\cell})_\cell = 0
    \qquad\forall v\in \P_1,
  \end{gather*}
  such that
  \begin{gather*}
    \form(\nabla v, \nabla b) = \form(\nabla b, \nabla v) = 0
    \qquad
    \forall v\in V_h^1,b\in V_h^b.
  \end{gather*}

  Thus, testing~\eqref{eq:stokes:3} with $v_h\in V_h^1$ yields
  \begin{gather}
    \label{eq:stokes:17}
    \form(\nabla u_h^1,\nabla v_h)
    + \form(\div v_h, p_h) = f(v_h)
    \qquad\forall v_h\in V_h^1.
  \end{gather}
  Testing the same equation with $v\in V_h^b$, we obtain
  \begin{gather}
    \form(\nabla u_h^b,\nabla v_h)
    = f(v_h) - \form(\div v_h, p_h)
    = f(v_h) + \form(v_h,\nabla p_h)_{\mesh_h}.
  \end{gather}
  Choosing more specifically $v_h$ as the bubble function $b_{3,\cell}$ of the
  cell $\cell$ for each vector component yields
  \begin{gather}
    \label{eq:stokes:20}
    \mu_\cell^{(i)}  = \frac{1}{\norm{\nabla b_3}_\cell^2}\form(f+\d_i p_h,b_3)_\cell,
  \end{gather}
  where $\mu_\cell^{(i)}$ is the coefficient in front of the basis
  function $b_{3,\cell}$ on cell $\cell$ in the basis representation of
  $u_h^{(i)}$, such that
  \begin{gather}
    \label{eq:stokes:19}
    u_h^b = \sum_{\cell\in\mesh_h}
    \begin{pmatrix}
      \mu_\cell^{(1)} b_{3,\cell}\\
      \mu_\cell^{(2)} b_{3,\cell}
    \end{pmatrix}
  \end{gather}
  Testing the Stokes equations with $q_h\in Q_h$, we obtain the
  divergence equation
  \begin{gather}
    \form(\div u_h^1 + \div u_h^b,q_h)
    = \form(\div u_h^1, q_h)
    - \form(u_h^b, \nabla q_h)_{\mesh_h} = g(q_h).
  \end{gather}
  Using~\eqref{eq:stokes:20}, \eqref{eq:stokes:19} and using
  $f_T^{(i)} = \form(f^{(i)},1)_\cell$ yields
  \begin{align*}
    \form(u_h^b, \nabla q_h)_{\mesh_h}
    &=
    \sum_{\cell\in\mesh_h} \frac{1}{\norm{\nabla b_3}_\cell^2}
    \sum_{i=1,2}\form(f_\cell^{(i)}+\d_i
      p_h,{b_3(T)}\d_i q_h)_\cell\\
    &= \sum_{\cell\in\mesh_h} \frac{\form(b_3,1)_\cell}{\norm{\nabla
      b_3}_\cell^2}
      \form(f_T+\nabla p_h,\nabla q_h)_\cell
  \end{align*}
\end{proof}

\begin{remark}
  The constant $c_T$ in the previous lemma was computed by the formula
  \begin{gather*}
    c_T = \frac{\form(b_3,1)_\cell}{\norm{\nabla b_3}_\cell^2}.
  \end{gather*}
  This formula is complicated and we would rather like to avoid
  computing $c_T$ for every mesh cell, since we have to evaluate
  integrals of cubic functions. On the other hand, the same constant
  $c_T$ appears on the left and on the right of the modified
  equation~\eqref{eq:stokes:16}. Therefore, we can replace both by a
  constant of similar size without affecting consistency or the
  characteristic properties of the equation. Therefore, we estimate
  \begin{gather}
    c_T = \frac{\form(b_3,1)_\cell}{\norm{\nabla b_3}_\cell^2}
    \simeq \frac{\norm{b_3}_\cell^2}{\norm{\nabla b_3}_\cell^2}
    \simeq h_T^2,
  \end{gather}
  where ``$\simeq$'' indicates equality up to a constant independent
  of $h$, but depending on the constant in \putindex{shape regularity}.
\end{remark}

\begin{remark}
  The method introduced in \blockref{Lemma}{mini-stabilized} is an
  example for a \define{stabilized method}, here in particular
  \define{pressure stabilization}. Such methods were particularly
  popular in the early decades of finite element computation, since
  they only involve simple shape function spaces. They are still
  widely used due to their simplicity. The method constructed this way
  is consistent, i.~e.~, the continuous solution $(u,p)$ solves the
  discrete problem.
\end{remark}


\begin{Problem}{quadrilateral-mini}
  Show that the MINI element can be generalized to quadrilateral
  meshes. Design a bubble space $b_Q$ of minimal tensor degree such that
  \begin{gather*}
    V_h = \bigl(H^1_h(\Q_1) \oplus B_h(b_Q) \cap V\bigr)^2,
    \qquad
    Q_h = H^1_h(\Q_1) \cap Q.
  \end{gather*}

  Discuss extensions to tetrahedra and hexahedra in three dimensions.
\begin{solution}
  For simplices in any dimension consider the bubble function
  \begin{align*}
    b_T=\prod_{i=1}^d\lambda_i\in \mathbb{P}_d(\mathcal{T}_h)
  \end{align*}
  and we can procede exactly as in the 2D case, i.e. the bubble
  space is spanned by
  \begin{align*}
   \left\{b_T e_1,\dotsc, b_T e_d\right\}.
  \end{align*}

  For quadrilaterals and higher-dimensional generalizations consider
  on the reference cell $[-1,1]^d$
  \begin{align*}
    \hat{b}_T=\prod_{i=1}^d(1-x_i^2)\in \mathbb{Q}_{2d}(\hat{\mathcal{T}}_h).
  \end{align*}
  In particular, we have to satisfy
  \begin{gather*}
    \int_\domain \div(\Pi_2 v-v) q_h \dx
    = \int_\domain (v-\Pi_2v)\cdot\nabla q_h\dx
    = 0 \quad \forall q_h\in Q_h.
  \end{gather*}
  Since $\nabla Q_h$ is spanned by
  \begin{align*}
    \left\{
      \begin{pmatrix} 1 \\0 \end{pmatrix},
      \begin{pmatrix} 0 \\1 \end{pmatrix},
      \begin{pmatrix} y \\x \end{pmatrix}
    \right\}
  \end{align*}
  in 3D, we need three additional bubble functions we choose as
  \begin{align*}
    b_{T,1}= \begin{pmatrix} \hat{b}_T   \\ 0         \end{pmatrix},
    b_{T,2}= \begin{pmatrix}         0   \\ \hat{b}_T \end{pmatrix},
    b_{T,3}= \begin{pmatrix} \hat{b}_T y \\ \hat{b}_T x \end{pmatrix}.
  \end{align*}
  With respect to the reference element $[-1,1]^2$, these functions are orthogonal
  to the basis of $\nabla Q_h$ and non-negative. Hence, there exists a function
  fulfilling the three requirements and we define $\Pi_2$ to be the projection to the
  space spanned by $b_{T,1}, b_{T,2}$ and $b_{T,3}$.
\end{solution}
\end{Problem}

\begin{Problem}{mini-3d}
  By introducing barycentric coordinates $\lambda_0,\dots,\lambda_3$
  for a tetrahedron $\cell\subset\R^3$ and the quartic bubble
  \begin{gather}
    b_{4,\cell} = \lambda_0\lambda_1\lambda_2\lambda_3,
  \end{gather}
  show that the MINI element has a natural generalization to three
  dimensional problems.
\end{Problem}

\begin{intro}
  The reasoning behind the MINI element can be applied easily to
  pressure spaces og higher order. Take for instance the pair
  $P_k-P_k$. The, there holds $\div v_h \in \P_{k-1}$ on each cell,
  and the term
  \begin{gather*}
    \int_\cell \div v_h q_h\dx
  \end{gather*}
  does not control the function in $\hat p_\cell \in \P_k$ which is
  orthogonal to $\P_{k-1}$. The only function $p_h\in Q_h$ such that
  $p_{h|\cell} = \hat p_\cell$ for each cell $\cell\in\mesh_h$ may be
  zero or not, depending on the mesh geometry. Thus, the element is
  not stable on arbitrary shape regular meshes. But, as we prove
  below, the same enrichment process by bubble functions can be
  employed for its stabilization.
\end{intro}

\begin{Definition}{higher-order-bubble}
  With any pressure space $Q_h$ we associate the \define{bubble space}
  \begin{gather}
    \label{eq:stokes:24}
    B_h(b_\cell \nabla Q_h)
    = \bigl\{ v\in V \big\vert
    \; \exists q_h\in Q_h \colon v_{|\cell} = b_\cell \nabla q_h \bigr\}.
  \end{gather}
  Here, $b_\cell$ is a bubble function on $\cell$ like the cubic buble
  $b_{3,\cell}$ of a triangle, the quartic bubble $b_{4,\cell}$, the
  biquadratic bubble $b_{2^2,\cell}$ of a quadrilateral or the
  triquadratic bubble $b_{2^3,\cell}$ of a hexahedron.
  
  We also define the cell bubble space
  \begin{gather}
    \label{eq:stokes:25}
    B_\cell(\nabla Q_h) = \bigl\{ v\in L^2(\cell) \big\vert
    \;\exists q_h\in Q_h \colon v = b_T q_{h|\cell}\bigr\}.
  \end{gather}
\end{Definition}

\begin{Theorem}{higher-order-bubble}
  Assume that the pair $V_h\times Q_h$ is chosen such that there is
  an $H^1$-stable interpolation operator according to
  \blockref{Assumption}{h1-stable-interpolation}, such that $Q_h\subset
  C^0(\domain)$ and such that
  \begin{gather}
    B_h(b_\cell \nabla Q_h)^d \subset V_h.
  \end{gather}
  Then, the pair $V_h\times Q_h$ is inf-sup stable.
\end{Theorem}

\begin{proof}
  We construct the \putindex{Fortin projection} by
  \blockref{Lemma}{fortin-construction-1} choosing $\Pi_1$ as the
  $H^1$-stable interpolation operator. The operator $\Pi_2$ is
  constructed cell-wise such that $\Pi_2\colon H^1(\cell) \to
  B_\cell(\nabla Q_h)$ fulfills
  \begin{gather}
    \label{eq:stokes:26}    
    \int_\cell (\Pi_2 u - u) \cdot\nabla q = 0,
    \qquad
    \forall q\in Q_{h|\cell}.
  \end{gather}
  Clearly, the dimension of $B_\cell(\nabla Q_h)$ equals the dimension
  of $Q_{h|\cell}$. Then, since the bubble functions are strictly
  positive inside $\cell$, equation~\eqref{eq:stokes:26} defines
  $\Pi_2 u$ uniquely. It remains to show the $H^1$-stability of
  $\Pi_2(\identity-\Pi_1)$, which is done by the standard scaling
  argument
  \begin{gather*}
    \snorm{\Pi_2 v}_{1,\cell}
    =\snorm{\widehat{\Pi_2 v}}_{1,\widehat\cell}
    \le c \norm{\widehat v}_{1,\widehat\cell}
    \le c \bigl(h_\cell^{-1} \norm{v}_{0,\cell} + \snorm{v}_{1,\cell}\bigr).
  \end{gather*}
\end{proof}

\begin{Corollary}{pk-bubble}
  Let $Q_h\subset Q$ be continuous and cell-wise differentiable. If
  \begin{gather*}
    H^1_h(\P_1)^d\oplus B_h(b_\cell\nabla Q_h)^d \subset V_h \subset V,
  \end{gather*}
  then the pair $V_h\times Q_h$ is inf-sup stable. The same holds on
  quadrilateral and hexahedral meshes replacing $\P_1$ by $\Q_1$.
\end{Corollary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Elements with discontinuous pressure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{intro}
  In this section, we consider a second stable element, which like
  the MINI element is not so much of practical use, but exhibits
  typical properties of the analysis of finite element spaces for the
  Stokes problem.
\end{intro}

\begin{Definition}{p2-p0-element}
  The \textbf{$\mathbf{P_2-P_0}$ element} on triangles consists of the finite
  element spaces
  \begin{gather}
    V_h = H^1_h(\P_2)^2 \cap V,
    \qquad
    Q_h = H^0_h(\P_0) \cap Q.
  \end{gather}
  Its degrees of freedom are:
    \begin{center}
    \includegraphics[width=.2\textwidth]{./fig/p2-v.tikz}
    \hspace{1cm}
    \includegraphics[width=.2\textwidth]{./fig/p0-p.tikz}
  \end{center}
\end{Definition}

\begin{Lemma}{p2-p0-stability}
  The $P_2-P_0$ element is inf-sup stable.
\end{Lemma}

\begin{proof}
  We again prove stability by constructing a \putindex{Fortin
    projection} using the two step algorithm of
  \blockref{Lemma}{fortin-construction-1}. Again, we choose for
  $\Pi_1$ an $H^1$-stable interpolation according to
  \blockref{Assumption}{h1-stable-interpolation}. It remains therefore
  to construct $\Pi_2$. First, since $q_{h|\cell}$ is constant on
  each cell $\cell\in\mesh_h$, we can apply the Gauss theorem to the
  divergence condition to obtain
  \begin{gather}
    \label{eq:stokes:23}
    \int_\cell \div (u-\Pi_2u)\dx = \int_{\d\cell} (u-\Pi_2u)\cdot\n\ds.
  \end{gather}
  Hence, the following interpolation conditions on each cell $\cell$
  define a divergence preserving operator $\Pi_2$:
  \begin{xalignat}2
    \label{eq:stokes:21}
    \Pi_2 u(x) &= 0
    & \forall x &\text{ is vertex of } \cell\\
    \label{eq:stokes:22}
    \int_E \Pi_2 u\ds &= \int_E u\ds
    & \forall E &\text{ is edge of } \cell
  \end{xalignat}
  This is true, since~\eqref{eq:stokes:22} implies the right hand side
  of~\eqref{eq:stokes:23}. It remains to show the $H^1$-stability of
  $\Pi_2(\identity-\Pi_1)$. Let us first observe that the
  interpolation operator only involves edge integrals of $u$, which
  are well-defined on $H^1$. Thus, we have by the standard scaling
  argument
  \begin{gather*}
    \snorm{\Pi_2 v}_{1,\cell}
    =\snorm{\widehat{\Pi_2 v}}_{1,\widehat\cell}
    \le c \norm{\widehat v}_{1,\widehat\cell}
    \le c \bigl(h_\cell^{-1} \norm{v}_{0,\cell} + \snorm{v}_{1,\cell}\bigr).
  \end{gather*}
  Entering $v=u-\Pi_1 u$ and the estimates~\eqref{eq:stokes:15} of
  \blockref{Assumption}{locally-quasi-uniform}, we obtain
  \begin{gather*}
    \norm{\Pi_2 (\identity-\Pi_1)u}_1^2
    = \sum_{\cell\in\mesh_h}\norm{\Pi_2
      (\identity-\Pi_1)u}_{1,\cell}^2
    \le c \norm{u}_1^2
  \end{gather*}
\end{proof}

\begin{remark}
  The proof shows, that from a mathematical point of view degrees of
  freedom on edges are more reasonably defined by integrals along the
  edge than by values in the mid points. This is something, we will
  encounter again and again. Nevertheless, we will not change the
  cartoons for the degrees of freedom and just note that a degree of
  freedom on an edge, while drawn as a point, may be an integral value.
\end{remark}

\begin{Theorem}{p2-p0-convergence}
  Let $(u,p)\in V\times Q$ be a solution to the Stokes problem and let
  the pair $(u_h,p_h) \in V_h\times Q_h$ be the approximation on a
  mesh $\mesh_h$ of mesh size $h$ with the $P_2-P_0$ element of
  \blockref{Definition}{p2-p0-element}. Then, we have the error
  estimate
  \begin{gather*}
    \norm{u-u_h}_1 + \norm{p-p_h}_0
    \le c \bigl(h^2\snorm{u}_2 + h \snorm{p}_1\bigr).
  \end{gather*}
\end{Theorem}

\begin{remark}
  While this theorem is optimal with respect to our analysis, it is
  not optimal with respect to the approximation properties of $V_h$.
\end{remark}

\begin{remark}
  Let us review the construction principles behind the \putindex{MINI
    element} and the $P_2-P_0$ element. The uncontrolled pressure
  modes in $\ker B_h^T$ of the $P_1-P_1$ element were those pressures
  with alternating signs at neighboring vertices, such that the mean
  value of $p_h$ is zero on each cell. Therefore, $p_h$ is orthogonal
  to the constant derivatives of the linear velocity space. Thus, we
  add a local function on each cell with nonconstant gradient, and the
  mean value of the pressure can be controlled.

  The kernel of $B_h^T$ for the element $H^1(\P_1)^2 - H^0(\P_0)$ on
  the other hand contains functions that are constant on each cell,
  but jump over cell boundaries. By integration by parts, we have
  \begin{gather*}
    \int_\cell \div b_\cell q_h \dx
    = -\int_\cell b_\cell \cdot\nabla q_h
    + \int_{\d\cell} b_\cell q_h \ds
    = 0.
  \end{gather*}
  Hence, no kind of bubble function helps controlling the jump of
  $p_h$ over an edge. Instead, we introduce a degree of freedom on the
  edge. Integrating by parts on two neighboring cells $\cell_1$ and
  $\cell_2$, we obtain on the common edge $E_{12}$ a term of the form
  \begin{gather*}
    \int_{E_{12}} \left[u\cdot\n_1 q_1 + u\cdot\n_2 q_2\right],
  \end{gather*}
  which by the continuity of $u\cdot\n$ translates to
  \begin{gather}
    \int_{E_{12}} u\cdot\n_1 (q_1- q_2).
  \end{gather}
  Thus, we can use the interpolation operator $\Pi_2$ to obtain a
  function $u$ such that
  \begin{gather*}
    \int_{E_{12}} u\cdot\n_1 \ds = (q_1-q_2),
  \end{gather*}
  such that
  \begin{gather*}
    \form(\div u,q_h) = \int_{E_{12}} \abs{q_1-q_2}^2\ds + \text{
      other terms}.
  \end{gather*}
\end{remark}

\begin{Problem}{q2-q0}
  Show that the quadrilateral element
  \begin{gather}
    V_h = H^1_h(\Q_2)^2\cap V,
    \qquad Q_h = H^0_h(\P_0) \cap Q,
  \end{gather}
  with degrees of freedom
  \begin{center}
    \includegraphics[width=.2\textwidth]{./fig/q2-v.tikz}
    \hspace{1cm}
    \includegraphics[width=.2\textwidth]{./fig/q0-p.tikz}
  \end{center}
  is inf-sup stable. Does the proof translate to the $P_2-P_0$ element
  on tetrahedra or the $Q_2-P_0$ element on hexahedra?
\end{Problem}

\begin{intro}
  In spite of our remarks above, there is a generalization of the
  $P_2-P_0$ element involving bubble functions. We will discuss it in
  an abstract theorem first and then derive a family of inf-sup stable
  pairs.
\end{intro}

\begin{Lemma}{bubble-discontinuous}
  Given a space $Q_h\subset Q$ possibly discontinuous, choose
  $V_h\subset V$ such that
  \begin{gather*}
    B_h(b_\cell \nabla Q_h)^d \subset V_h.
  \end{gather*}
  If there is an operator $\Pi_1$ such that
  \begin{xalignat*}2
    \norm{\Pi_1 v}_V & \le \norm{v}_V
    &\forall v&\in V,\\
    \int_\cell \div (v-\Pi_1v) \dx &= 0
    &\forall v&\in V, \cell\in\mesh_h,
  \end{xalignat*}
  then the pair $V_h\times Q_h$ is inf-sup stable.
\end{Lemma}

\begin{proof}
  We construct the \putindex{Fortin projection} using $\Pi_1$ and
  define $\Pi_2$ only on $V^0 = \ker{\div}$. This is sufficient, since
  for any $v\in V$ there holds $v-\Pi_1 v \in V^0$. Therefore, define
  cell-wise $\Pi_2\colon V^0_{|\cell} \to B_\cell(b_\cell \nabla Q_h)$
  by the conditions
  \begin{gather}
    \int_\cell \div (\Pi_2 v - v ) q_h \dx = 0
    \qquad\forall q_h\in Q_{h|\cell}.
  \end{gather}
  By this condition, $\Pi_2 v$ is divergence free itself.
  Note that by the Gauss theorem, the divergence of a bubble function
  has always zero mean. Therefore, we have unique solvability and
  $\Pi_h v$ is well defined. It remains to apply the standard scaling
  argument to prove
  \begin{gather*}
    \norm{\Pi_2 v}_1 \le c \norm{v}_1.
  \end{gather*}
\end{proof}

\begin{remark}
  The divergence condition in the previous lemma is different from the
  condition on Fortin projections, since it only involves piecewise
  constant pressure. Therefore, the lemma in effect splits the
  pressure space into a piecewise constant part and its
  complement. Then, the pressure in the complement is controlled by
  the bubble functions. It still remains to guarantee the existence
  ofg the operator $\Pi_1$. In one case, we have verified the
  existence of such an operator: the Fortin operator for the $P_2-P_0$
  element. Therefore, we have
\end{remark}

\begin{Corollary}{bubble-p2}
  Let $Q_h\subset Q$ be a space of piecewise differentiable
  functions. If for $V_h\subset V$ holds
  \begin{gather*}
    H^1_h(\P_2)^2 \oplus B_h(b_\cell \nabla Q_h)^2 \subset V_h,
  \end{gather*}
  then the pair $V_h\times Q_h$ is inf-sup stable.
\end{Corollary}

\begin{Corollary}{pk-pk2}
  Let the space dimension be $d=2$ and $k\ge 2$. Then, the spaces
  \begin{gather}
    V_h = H^1_h(\P_k)^2 \cap V,
    \qquad
    Q_k = H^0_h(\P_{k-2}) \cap Q,
  \end{gather}
  form an inf-sup stable pair.
\end{Corollary}

\begin{proof}
  For $k=2$, this is the $P_2-P_0$ element. For $k>2$, we have for all
  $q_h\in Q_h$ on every cell $\nabla q_h\in \P_{k-3}$. Therefore,
  $(b_{3,\cell} q_h)_{|\cell} \in \P_k$.
\end{proof}

\begin{intro}
  Studying the proof of \blockref{Lemma}{p2-p0-stability} in more
  detail, we can find a much more general result with much weaker
  assumptions. Indeed, we only need to be able to have a single degree
  of freedom on each edge or face which allows to adjust the average
  normal velocity over this edge of face. We summarize this in:
\end{intro}

\begin{Theorem}{discontinuous-pressure-normal-velocity}
  Let $Q_h\subset Q$ and let $V_h \subset V$ be such that there is an
  $H^1$-stable interpolation according to
  \blockref{Assumption}{h1-stable-interpolation}. Furthermore, let
  there be a degree of freedom on each edge (face in 3D) controlling
  the average normal derivative of $u\in V_h$ on this face. Finally,
  let $V_h$ contain the bubble space for $\nabla Q_h$,
  \begin{gather*}
    B_h(b_\cell \nabla Q_h)^d \subset V_h.    
  \end{gather*}
  Then, the pair $V_h\times Q_h$ is inf-sup stable.
\end{Theorem}

\begin{proof}
  With the assumptions made, it is sufficient to construct the
  operator $\Pi_1$ in \blockref{Lemma}{bubble-discontinuous}. Then, we
  can apply this lemma and the result is proven. Going back
  to~\eqref{eq:stokes:23}, we see that the interpolation condition
  ~\eqref{eq:stokes:22} is more than needed.

  Now, let $\{\nodal_{\cell,i}$ be the $n_\cell$ node values for the
  discrete velocity space $V_\cell = V_{h|\cell}$ on the cell $\cell$. For
  convenience, let them be ordered in a way, that the first ones
  control the normal derivatives of $u_h$ on the faces of the cell,
  that is,
  \begin{gather}
    \nodal_{\cell,i} = \int_{F_i} u\cdot\n \ds
    \qquad i=1,\dots,n_F,
  \end{gather}
  where $n_F$ is the number of faces per cell. Given the $H^1$-stable
  interpolation operator $I_h$, define $\Pi_2$ cell-wise such that
  \begin{xalignat}2
    \nodal_{\cell,i}(\Pi_2 u) &= \nodal_{\cell,i}(u)
    &i&=1,\dots,n_F\\
    \nodal_{\cell,i}(\Pi_2 u) &= 0
    &i&=n_F+1,\dots,n_\cell.
  \end{xalignat}
  Choosing the basis on $V_T$ which is dual to $\{\nodal_{\cell,i}$,
  we see that this indeed implies
  \begin{gather*}
    0\int_{\d\cell} (\Pi_2 u - u) \ds = \int_\cell \div (\Pi_2 u-u)\dx.
  \end{gather*}
  Therefore, $\Pi_1 = I_h + \Pi_2(\identity-I_h)$ is divergence
  preserving. Boundedness follows by the standard scaling argument.
\end{proof}

\begin{Corollary}{qk-pk1}
  The finite-element pair $V_h\times Q_h$ with
  \begin{gather*}
    V_h = H^1_h(\Q_k)^2 \cap V,
    \qquad
    Q_h = H^0_h(\P_{k-1}) \cap Q,
  \end{gather*}
  called the $Q_k-P_{k-1}$ element is inf-sup stable for any $k\ge 2$.
\end{Corollary}

\begin{proof}
  First, we prove that $B_h(b_\cell \nabla Q_h)^d \subset V_h$. To
  this end, we note that on each cell, we have that the restriction
  $q_T$ of a discrete pressure $q_h$ is in $\P_{k-2}\subset \Q_{k-2}$.
  The bubble function $b_T$ is in $\Q_2$, such that
  $b_T\nabla q_T \in \Q_k$, which was to be proven.
  
  For the assumption on the degrees of freedom, we refer to the
  following definition. Once the degrees of freedom for each velocity
  component are determined by this definition, we can simply select
  the normal component on Cartesian meshes. On meshes with straight
  interfaces, it is clear that we can choose a linear combination of
  the components of $u$ splitting into normal and tangential and thus
  get the desired result. In general, we refer to the \putindex{Piola
    transformation} in the next chapter.
\end{proof}

\begin{Definition}{momentum-dofs-qk-2d}
  The momentum degrees of freedom of the $\Q_k$ element are defined on
  the reference cell $\widehat T$ in two space dimensions as
  \begin{xalignat*}3
    \nodal_{0,i}(u) &= u(x_i)
    &&&x_i&\text{ is vertex of } \widehat T\\
    \nodal_{1,i,j}(u) &= \int_{E_i} u q\ds
    &\forall q&\in\Q_{k-1}(E_i)&E_i&\text{ is edge of } \widehat T\\
    \nodal_{2,j}(u) &=\int_{\widehat T} u q \dx
    &\forall q&\in\Q_{k-1}(\widehat T).
  \end{xalignat*}
\end{Definition}

\begin{Definition}{momentum-dofs-qk-3d}
  The momentum degrees of freedom of the $\Q_k$ element are defined on
  the reference cell $\widehat T$ in three space dimensions as
  \begin{xalignat*}3
    \nodal_{0,i}(u) &= u(x_i)
    &&&x_i&\text{ is vertex of } \widehat T\\
    \nodal_{1,i,j}(u) &= \int_{E_i} u q\ds
    &\forall q&\in\Q_{k-1}(E_i)&E_i&\text{ is edge of } \widehat T\\
    \nodal_{2,i,j}(u) &= \int_{F_i} u q\ds
    &\forall q&\in\Q_{k-1}(F_i)&F_i&\text{ is face of } \widehat T\\
    \nodal_{3,j}(u) &=\int_{\widehat T} u q \dx
    &\forall q&\in\Q_{k-1}(\widehat T).
  \end{xalignat*}
\end{Definition}

\begin{Example}{qk-pk1}
  The first two members of the $Q_k-P_{k-1}$ family have the nodal
  representations
  \begin{center}
    \begin{tabular}{c@{\hspace{.2\textwidth}}c}
      \includegraphics[width=.2\textwidth]{./fig/q2-v.tikz}
      &
      \includegraphics[width=.2\textwidth]{./fig/q-p1-p.tikz}
      \\[5mm]
      \includegraphics[width=.2\textwidth]{./fig/q3-v.tikz}
      &
      \includegraphics[width=.2\textwidth]{./fig/q-p2-p.tikz}
    \end{tabular}    
  \end{center}
\end{Example}

\begin{remark}
  When we map the reference square to a quadrilateral mesh cell, this
  mapping may be affine for parallelograms or bilinear for general
  quadrilaterals. At some point, we have proven that the mapped $\Q_k$
  space has optimal approximation properties, that is, approximation
  of order $k$ in $H^1$ and of order $k+1$ in $L^2$. Such a thing has
  not been proven for a bilinearly mapped $\P_k$ element. And,
  unfortunately it is not true. We therefore have to distinguish
  between a mapped and an unmapped pressure space.
\end{remark}

\subsection{The family of Hood-Taylor elements}

\section{Nearly incompressible elasticity}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
