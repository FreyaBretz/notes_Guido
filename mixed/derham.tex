\begin{intro}
  We can embed finite element methods for the Darcy problem, also for
  the Maxwell problem, into a common framework based on the de Rham
  complex. If we wanted to do this in its full mathematical beauty, we
  would have to spend some time introducing the concept and notation
  of differential forms. As an alternative, we can use the concrete
  vector spaces $\Hdiv(\domain)$ and $\Hcurl(\domain)$. The drawback
  is, that we have to prove deveral particular cases, where the
  abstract theory only knows one common case. Nevertheless, it is
  worthwhile to begin this way, such that the reader has an easier
  task reading the full theory
  in~\cite{ArnoldFalkWinther06acta,ArnoldFalkWinther10}. As a byproduct,
  we will prove in generality some of the properties of polynomial
  spaces in Chapter~\ref{cha:darcy}.
\end{intro}

\section{Maxwell equations}

\begin{intro}
  Electromagnetic fields are governed by four laws of nature put together
  by James Clerk Maxwell to a single system. The laws are
  \begin{enumerate}
  \item Gauss' law for the electric field: the electric flux
    through a closed surface equals $1/\epsilon$ times the electric
    charge enclosed by the surface:
    \begin{gather*}
      \int_{\d V} E\cdot \n \ds = \int_V \frac\rho\epsilon \dx.
    \end{gather*}
  \item There are no magnetic monopoles, therefore the magnetic flux
    through any closed surface vanishes:
    \begin{gather*}
      \int_{\d V} B\cdot \n \ds = 0.
    \end{gather*}
  \item Faraday's law of induction: the voltage induced in a closed
    loop is proportional to the rate of change of the magnetic field
    through the surface encloded by the loop:
    \begin{gather*}
      \int_{\d A} E\cdot\ds = -\frac{d}{dt}\int_A B\cdot \n \ds.
    \end{gather*}
  \item AmpÃ¨re's law: the magnetic field induced in a closed loop is
    proportional to the electric current plus the change of electric
    field through that loop:
    \begin{gather*}
      \int_{\d A} B\cdot\ds
      = \mu \int_A J\cdot \n \ds
      + \mu\epsilon\frac{d}{dt}\int_A E\cdot \n \ds.
    \end{gather*}
  \end{enumerate}
  
  Using the Gauss theorem for the first two and the Stokes theorem for
  the remaining two laws, we obtain the \define{Maxwell equations} of
  electromagnetics
  \begin{xalignat}2
    \div E &= \frac\rho\epsilon
    & \curl E &= -\d_t B,\\
    \div B &= 0
    & \curl B &= \mu J + \mu\epsilon E.
  \end{xalignat}
  They are an hyperbolic system of equations and typically have wave
  solutions. Many simplifications have been developed to suit
  particular purposes.
\end{intro}

\begin{intro}
  An important simplification of the Maxwell equations is obtained by
  assuming an isolating material, that is, the electric current $J$
  vanishes. Additionally, we may assume that there are no electric
  charges, such that $\div E=0$. Then, taking the curl of the equation
  for $\curl E$ and inserting the formula for $\curl B$, we obtain
  \begin{gather}
    \mu\epsilon \d_t^2 E + \curl\curl E = 0
    \qquad \div E=0.
  \end{gather}
  We can even go further and study the stationary limit
  \begin{gather}
    \label{eq:derham:1}
    \curl\curl E=0 \qquad \div E=0.
  \end{gather}
  This is the equation we are concerned with most, since its solution
  theory also provides insight into the other forms.
\end{intro}

\begin{Notation}{curl}
  With $\curl u$ we describe the curl of a vector field $u$, which in
  three dimensions is defined as
  \begin{gather}
    \label{eq:derham:2}
    \curl u =
    \begin{pmatrix}
      \d_2u_3-\d_3u_2\\\d_3u_1-\d_1u_3\\\d_1u_2-\d_2u_1.
    \end{pmatrix}
  \end{gather}
  In two dimension, we distinguish between the vector curl of a scalar
  function and the scalar curl of a vector function
  \begin{gather}
    \curl u = \d_1u_2-\d_2u_1,
    \qquad
    \curl \phi =
    \begin{pmatrix}
      \d_2 \phi \\ -\d_1\phi
    \end{pmatrix}.
  \end{gather}
\end{Notation}

\begin{remark}
  The scalar curl of a two-dimensional vector field is equal to the
  third component of the extension of this vector field by zero into
  $\R^3$, in formulas,
  \begin{gather*}
    \curl
    \begin{pmatrix}
      u_1\\u_2
    \end{pmatrix}
    =
    \curl
    \begin{pmatrix}
      u_1\\u_2\\0
    \end{pmatrix}_3.
  \end{gather*}
  Similarly, the vector curl of a scalar function $\phi$ in two dimensions
  consistes of the first two components of the curl of a three
  dimensional function in the last component of t he vector,
  \begin{gather*}
    \curl \phi = \curl
    \begin{pmatrix}
      0\\0\\\phi
    \end{pmatrix}_{1,2}.
  \end{gather*}
\end{remark}
\begin{remark}
  A polular error in the literature consists of the following
  argument: since $\div E = 0$, there also holds $\nabla \div E =
  0$. Therefore, we can use the formula
  \begin{gather*}
    \Delta u = \nabla\div u - \curl\curl u,
  \end{gather*}
  and avoid the div-curl-problem alltogether. Unfortunately, this is
  only true, if solutions of~\eqref{eq:derham:1} are in
  $H^1(\domain;\R^d)$, which is not true, depending on the boundary
  conditions.
\end{remark}

\begin{Lemma}{curl-green}
  For vector fields $u,v\in C^1(\overline{\domain})$, there holds
  \begin{gather}
    \label{eq:derham:3}
    \int_{\domain} \curl u\cdot v\dx = \int_{\domain} u\cdot\curl v\dx
    + \int_{\d\domain} (n\times u) \cdot v \ds.
  \end{gather}
\end{Lemma}


\begin{Definition}{Maxwell-boundary}
  The Maxwell equation~\eqref{eq:derham:1} is complemented with the
  following boundary conditions:
  \begin{itemize}
  \item Perfectly conducting:
    \begin{gather}
      \n\cdot u = 0.
    \end{gather}
    \item Natural:
      \begin{gather}
        n\times \curl u = 0.
      \end{gather}
    \item Impedance:
      \begin{gather}
        n\times \curl u - \alpha  (\n\times u) \times \n = 0.
      \end{gather}
  \end{itemize}
\end{Definition}


\begin{Definition}{curl-traces}
  For $u\in C^1(\overline\domain)$, we define the trace operators
  \begin{gather}
    \label{eq:derham:4}
    \begin{split}
      \gamma_{\tau} &= \n\times u_{|\d\domain}, \\
      \gamma_{T} &= \n\times u_{|\d\domain} \times \n.\\
    \end{split}
  \end{gather}
  The second of these is the tangential component of $u$ on the
  boundary. Furthermore, we introduce the space $\Hcurl_0$ as the
  completion of the space of differentiable functions with compact
  support under the norm of $\Hcurl$
  \begin{gather}
    \Hcurl_0 = \overline{C^\infty_{00}(\domain;\R^d)}^{\Hcurl}.
  \end{gather}
\end{Definition}


\begin{Theorem}{curl-traces}
  The trace operator $\gamma_\tau$ can be extended to a continuous,
  surjective operator
  \begin{gather*}
    \gamma_\tau \colon \Hcurl(\domain) \to Y(\d\domain),
  \end{gather*}
  where
  \begin{gather}
    \label{eq:derham:5}
    \begin{split}
      Y(\d\domain) &= \bigl\{
      u\in H^{-1/2}_\tau(\d\domain) \big\vert
      \;\nu\cdot(\curl u) \in H^{-1/2}(\d\domain) \bigr\},\\
      H^{-1/2}_\tau(\d\domain) &= \bigl\{
      u\in H^{-1/2}(\d\domain;\R^d) \big\vert 
      u\cdot\n=0 \text{ a.e.}\bigr\}.
    \end{split}
  \end{gather}
  Furthermore, the trace operator $\gamma_T$ can be extended to a
  continuous operator
  \begin{gather*}
    \gamma_T \colon \Hcurl(\domain) \to Y(\d\domain)^*.
  \end{gather*}
\end{Theorem}


\begin{intro}
  The trace theorem indicates, that $\Hcurl_0(\domain)$ is the correct
  space to solve the problem with perfectly conducting boundary
  condition on the whole boundary. It remains now to deal with the
  divergence constraint. First, we note, that the divergence operator
  is not well-defined on $\Hcurl$, and that the subspace of $\Hcurl$
  with divergence in $L^2$ is $H^1$, which must be avoided. Therefore,
  we have to resort to a dual formulation of this constraint, which
  leads to the following weak form of the perfectly conducting Maxwell
  problem.
\end{intro}

\begin{Definition}{Maxwell-mixed-0}
  The Maxwell problem for perfectly conducting boundary conditions in
  weak form reads: find $(u,p)\in V\times Q$, where
  $V=\Hcurl_0(\domain)$ and $Q=H^1_0(\domain)$ such that there holds
    \begin{gather}
      \label{eq:derham:6}
    \begin{aligned}
      \form(\curl u, \curl v) &+ \form(v,\nabla p) &=&\form(f,v)
      &\forall v&\in V\\
      \form(u,\nabla q) & &=&0
      &\forall q&\in Q.\\      
    \end{aligned}
  \end{gather}
\end{Definition}

\section{The de Rham complex of Hilbert spaces}

\begin{intro}
  We now know three differential operators, $\nabla$, $\curl$, and
  $\div$ with the interesting property
  \begin{gather}
    \curl\nabla \phi = 0
    \qquad \div\curl E=0.
  \end{gather}
  As a consequence, for $\phi\in H^1(\domain)$ we not only have
  $\nabla \phi\in L^2(\domain;\R^3)$, we also have
  $\curl\nabla\phi=0\in L^2(\domain;\R^3)$. This gives rise to the sequence
  \begin{gather}
    \R
    \overset{\subset}{\longrightarrow} H^1(\domain)
    \overset{\nabla}{\longrightarrow} \Hcurl(\domain)
    \overset{\curl}{\longrightarrow} \Hdiv(\domain)
    \overset{\div}{\longrightarrow} L^2(\domain)
    \longrightarrow 0,
  \end{gather}
  such that the range of an operator is always in the kernel of the
  operator to its right.
\end{intro}

\begin{Notation}{hlambda}
  The notation of exterior calculus of differential forms allows us to
  write this sequence elegantly as
  \begin{gather}\minCDarrowwidth20pt
    \begin{CD}
      \R
      @>{d}>> H\Lambda^0(\domain)
      @>{d}>> H\Lambda^1(\domain)
      @>{d}>> H\Lambda^2(\domain)
      @>{d}>> H\Lambda^3(\domain)
      @>>> 0
      \\
      @.
      @V{\cong}VV
      @V{\cong}VV
      @V{\cong}VV
      @V{\cong}VV
      \\
      \R
      @>{\subset}>> H^1(\domain)
      @>{\nabla}>> \Hcurl(\domain)
      @>{\curl}>> \Hdiv(\domain)
      @>{\div}>> L^2(\domain)
      @>>> 0,
    \end{CD}
  \end{gather}
  such that $d\colon H\Lambda^k(\domain) \to H\Lambda^{k+1}(\domain)$ and
  \begin{gather}
    d^2 = d\circ d = 0.
  \end{gather}
\end{Notation}

\begin{remark}
  The spaces $H\Lambda^k(\domain)$ are Hilbert spaces with values in
  the spaces of alternating $k$-forms on $\R^d$. From linear algebra,
  we know that all alternating $k$-forms are zero if $k$ exceeds the
  dimension of the vector space.  Therefore, the sequence above is
  only valid in three dimensions, and it must be shorter by one member
  in two dimensions. Changing our view back to differential operators,
  we realize that there are two relevant sequences in two
  dimensions. In the following diagram, the sequence on top can be
  used to formulate Maxwell problems in $\Hcurl$ in two dimensions,
  while the sequence on the bottom relates to the mixed form of the
  Laplacian.

  We introduce the sequences in two dimensions and afterwards will
  focus our arguments on the more general case of three dimensions
  again. Specialization to two dimensions are straight forward.
\end{remark}

\begin{Notation}{hlambda-2d}
  In two dimensions, we consider the de Rham sequences
  \begin{gather}\minCDarrowwidth20pt
    \begin{CD}
      \R
      @>{\subset}>> H^1(\domain)
      @>{\nabla}>> \Hcurl(\domain)
      @>{\curl}>> L^2(\domain)
      @>>> 0
      \\
      @.
      @A{\cong}AA
      @A{\cong}AA
      @A{\cong}AA
      \\
      \R
      @>{d}>> H\Lambda^0(\domain)
      @>{d}>> H\Lambda^1(\domain)
      @>{d}>> H\Lambda^2(\domain)
      @>>> 0
      \\
      @.
      @V{\cong}VV
      @V{\cong}VV
      @V{\cong}VV
      \\
      \R
      @>{\subset}>> H^1(\domain)
      @>{\curl}>> \Hdiv(\domain)
      @>{\div}>> L^2(\domain)
      @>>> 0,
    \end{CD}
  \end{gather}
\end{Notation}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "main"
%%% End: 
