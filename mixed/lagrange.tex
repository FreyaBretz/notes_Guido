%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{intro}
  We end our introduction by relating the Stokes equations to a
  constrained minimization problem very much like we had considered
  the solution of the Poisson equation as a minimization problem on
  the space $V$. There, we had proven the following theorem.
\end{intro}

\begin{Theorem}{minimization}
  Assume that $a(\cdot,\cdot)$ is symmetric and $V$-elliptic on the Hilbert
  space $V$. Let
  \begin{gather}
    J(v) = \tfrac12 a(v,v) - f(v).    
  \end{gather}
  Then, the minimization problem finding $u\in V$ such that
  \begin{align}
    J(u) =\inf_{v\in V} J(v),
  \end{align}
  has a unique solution, which then is a minimum. It is determined by
  the first order necessary condition
  \begin{gather}
    a(u,v) = f(v) \quad\forall v\in V.
  \end{gather}
\end{Theorem}

\begin{intro}
  In the next step, we constrain the solution $u$ to a subspace of $V$
  defined as the kernel of the linear operator $B: V\to Q^*$. Hence,
  we consider the minimization problem
  \begin{gather}
    J(u) =\inf_{v\in V} J(v) \quad
    \text{subject to}\quad
    Bu = 0.
  \end{gather}
  Going back to formulations with bilinear forms, the constraint
  translates to
  \begin{gather}
    u\in \ker B = \bigl\{ v\in V \;\big|\;
    b(v,q)=0 \quad\forall q\in Q\}.
  \end{gather}
  Since $\ker B$ is a vector space, we can just consider the
  restriction of the minimization problem to this space. This is
  called the reduced problem.
\end{intro}

\begin{Definition}{reduced-problem}
  The \define{reduced problem} of constrained minimization
  is: find $u\in \ker B$, such that
  \begin{gather}
    J(u) =\inf_{v\in \ker B} J(v).
  \end{gather}
\end{Definition}

\begin{Lemma}{reduced-wellposedness}
  Let the assumptions of \slideref{Theorem}{minimization} hold.
  Furthermore, assume that $\ker B$ is a closed subspace of $V$. Then,
  the reduced problem in \slideref{Definition}{reduced-problem} has a
  unique solution.
\end{Lemma}

\begin{proof}
  A closed subspace of a Hilbert space is a Hilbert space
  itself. Then, the $V$-ellipticity of $a(\cdot,\cdot)$ is inherited on
  $\ker B$, and thus the Lax-Milgram lemma provides a unique solution
  for the first order necessary condition on $\ker B$.
\end{proof}

% \begin{remark}
%   Here we already note that $V$-ellipticity of $a(\cdot,\cdot)$ is sufficient,
%   but not necessary. Indeed, ellipticity on $\ker B$ would have been
%   sufficient for well-posedness of the reduced problem.
% \end{remark}

\begin{intro}
  While the solution theory for the reduced problem is particularly
  simple and purely elliptic, the actual solution requires a
  representation of functions in $\ker B$, for instance a basis of
  these functions. In practice, this is often inconvenient, and we
  seek a method that solves a problem on the whole space. This is
  achieved by introducing a \define{Lagrange multiplier}.
\end{intro}

\begin{Theorem}{lagrange-multiplier}
  If $u\in V$ is a solution of the constrained minimization problem
  \begin{gather}
    J(u) = \min_{v\in V} J(v), \quad\qquad
    b(u,q) = 0 \quad\forall q\in Q,
  \end{gather}
  the pair $(u,p)\in V\times Q$ is a stationary point of
  the \define{Lagrange functional}
  \begin{gather}
    \mathscr{L}(v,q) = \tfrac12 a(v,v) - f(v) + b(v,q).
  \end{gather}
  Here, $p\in Q$ is called the \define{Lagrange multiplier}.
\end{Theorem}

\begin{Problem}{lagrange-multiplier}
  Verify: the first order necessary conditions of the Lagrange
  multiplier rule are
  \begin{gather}
    \arraycolsep.1em
    \begin{matrix}
      a(u,v) &+& b(v,p) &=& f(v) &\quad&\forall v\in V, \\
      b(u,q) && &=& 0 &&\forall q\in Q.
    \end{matrix}
  \end{gather}
  To this end, recall the type of objects that derivatives of linear
  functionals are and compute the derivatives of $\mathscr{L}$.
\begin{solution}
Remember the Lagrange functional
\begin{align}
 \mathscr{L}(v,q) = \tfrac12 a(v,v) - f(v) + b(v,q).
\end{align}
For an extremal point $u$ of the constrained problem,
there has to exist an $p\in Q$ such that
\begin{align}
  \mathscr{L}(u,p) = \min_{(v,q)\in V\times Q} \mathscr{L}(v,q).
\end{align}
In particular, it has to hold
\begin{align}
  \mathscr{L}(u+\epsilon_v v,p+\epsilon_q q) -\mathscr{L}(u,p)\in\mathcal{O}(\epsilon_v\epsilon_q+\epsilon_v^2+\epsilon_q^2).
\end{align}
for all $(v,q)\in\{(v,q)\in V\times Q: \norm{v}_V=1, \norm{q}_Q=1\}$.
In fact,
\begin{align}
 &\mathscr{L}(u+\epsilon_v v,p+\epsilon_q q) - \mathscr{L}(u,p)\\
 &=\tfrac12 a(u+\epsilon_v,u+\epsilon_v) - f(u+\epsilon_v) + b(u+\epsilon_v,p+\epsilon_q q)\\&\quad
   -\tfrac12 a(u,u) + f(u) - b(u,p)\\
   &=\tfrac12 a(\epsilon_v v,u)+a(u,\epsilon_v v)+a(\epsilon_v,\epsilon_v) - f(\epsilon_v v)\\&\quad + b(\epsilon_v,p )+b(u,\epsilon_q q)+b(\epsilon_v v,\epsilon_q q)\\
   &=a(u, \epsilon_v v)-f(\epsilon_v v) + b(\epsilon_v,p )+b(u,\epsilon_q q)+\mathcal{O}(\epsilon_v\epsilon_q+\epsilon_v^2+\epsilon_q^2).
\end{align}
and this implies
\begin{align}
      a(u,v) + b(v,p)  &= f(v) &&\forall v\in V, \\
               b(u,q)  &= 0    &&\forall q\in Q.
\end{align}
\end{solution}
\end{Problem}

\begin{Problem}{stokes-lagrange}
  Verify:
  the Stokes equations with no-slip boundary conditiond are the first
  order necessary conditions for the constrained minimization problem:
  find a velocity $u\in V = H^1_0(\domain)$ such that
  \begin{align}
    \tfrac12\form(\nabla u,\nabla u) - f(u) &= \min,\\
    \form(\div u,q) &= 0 \qquad\forall q\in Q.
  \end{align}
  The pressure $p$ assumes the role of a \putindex{Lagrange multiplier}.
\end{Problem}

\begin{Notation}{euler-lagrange}
  The first order necessary condition in
  \slideref{Problem}{lagrange-multiplier} is called
  \define{Euler-Lagrange equations} of the \putindex{Lagrange
    functional} $\mathscr{L}$.
\end{Notation}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "main"
%%% End: 
