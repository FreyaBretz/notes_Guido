\svnid{$Id$}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Lebesgue Integral}
\label{sec:lebesgue-integral}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{intro}
  This section introduces the Lebesgue integral mostly following the
  presentation in the monograph by Riesz and
  Sz.-Nagy~\cite{RieszNagy}. We deviate from this work only in two
  respects: first, we restrict the presentation to the results
  pertaining to the definition and properties of $L^p$-spaces. Second,
  we elaborate more on higher-dimensional integrals and modify the
  development of the one-dimensional case in order to be closer to
  higher dimensions.
\end{intro}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Sets of measure zero}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{intro}
  Sets of measure zero constitute one of the most important concepts
  in integration and measure theory. Odd enough, it is possible to
  define them in an elementary way, which does not require any
  advanced measure theory.
\end{intro}

\begin{definition}
  \label{def:zero-set-1}
  A subset $Z\subset \R$ is called a \textbf{set of measure zero}, if
  for any $\epsilon > 0$ there exist a finite or countable set of
  intervals $I_{k}$ such that
  \begin{gather*}
    Z \subset \bigcup_k I_{k}
    \quad\text{and}\quad
    \sum_k |I_{k}| < \epsilon.
  \end{gather*}
  We also say that the set $Z$ can be \define{covered} by a finite or
  countable union of intervals with total length less than $\epsilon$.
\end{definition}

\begin{definition}
  \label{def:zero-set-2}
  Sets of meazure zero in higher dimensions are defined in a similar
  way, replacing the set of intervals $I_k$ by cubes $Q_k$ such that
  their total volume is less than $\epsilon$.
\end{definition}

\begin{example}
  A set consisting of a single number $x\in\R$ is of measure zero,
  since for any $\epsilon>0$:
  \begin{gather*}
    \{x\} \subset \left[x-\tfrac\epsilon2,x+\tfrac\epsilon2\right].  
  \end{gather*}
\end{example}

\begin{lemma}
  The finite or countable union of sets of measure zero is of measure
  zero.
\end{lemma}

\begin{proof}
  Let $\{Z_j\}_{j=1,2,\dots}$ be a finite or countable sequence of
  sets of measure zero. For each $Z_j$, let $\{I_{jk}\}$ be a set of
  intervals covering $Z_j$ and having total length less than
  $2^{-k}\epsilon$. Such a set exists according to the definition of
  a set of measure zero. Then,
  \begin{gather*}
    Z = \bigcup_j Z_j \subset \bigcup_{jk} I_{jk}
    \quad\text{and}\quad
    \sum_{jk} |I_{jk}| < \epsilon.
  \end{gather*}
  It remains to note that the index set $jk$ is at most countable.
\end{proof}

\begin{corollary}
  The set $\Q\subset \R$ of rational numbers is of measure zero, since
  it is a countable union of points.
\end{corollary}

\begin{note}
  The preceding corollary implies that a dense subset of an interval
  in $\R$ can be covered by a system of intervals without covering the
  whole interval. Definitely, a remarkable statement.
\end{note}

\begin{definition}
  \label{def:almost-everywhere}
  A property is said to hold \define{almost everywhere} on a set $M$,
  if it holds on $M$, or at least on a set $M\setminus Z$, where $Z$
  is of measure zero.
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Step functions and their integrals}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}
  \defindex{lattice} We introduce \textbf{lattices}
  $\Q_n$\footnote{The letter $\Q$ with index always refers to a
    lattice and never to the rational numbers} of $\R^d$ consisting of
  half open cubes
  \begin{gather*}
    Q^{(n)}_{i_1,\dots,i_d} =
    \left]\tfrac{i_1}{2^n},\tfrac{i_1+1}{2^n}\right]
    \times
    \left]\tfrac{i_2}{2^n},\tfrac{i_2+1}{2^n}\right]
    \times\dots\times
    \left]\tfrac{i_d}{2^n},\tfrac{i_d+1}{2^n}\right],
    \qquad i_k\in\mathbb Z.
  \end{gather*}
  The lattice is said to be of width $2^{-n}$.
\end{definition}

\begin{note}
  Independent on the dimension $d$, the number of cubes in $\Q_n$ is
  countable. Thus, we can replace the multiple indices indicating the
  position of a cube in the lattice by a single enumeration index
  $k$. Furthermore, it is easy to see that the number of cubes in
  $\Q_n$ contained in a bounded set is finite, albeit depending on $n$.
\end{note}

\begin{definition}
  A function $f$ is called a \define{step function} on the lattice
  $\Q_n$, if $f$ is constant on each cube $Q_k$, and if $f$ is
  different from zero only on a finite number of cubes.  We refer to
  the value of $f$ on $Q_k$ as $f(Q_k)$ or short $f_k$.
  
  \index{S@$\mathcal S$}
  We denote by $\mathcal S$ the space of step functions.
\end{definition}

\begin{note}
  A step function $f$ on a lattice $\Q_n$ is also a step function on
  any lattice $\Q_m$ with $m>n$, by simply choosing it to be the same
  constant on all the cubes of $\Q_m$ which are subsets of the same
  cube of $\Q_n$.
  
  Therefore, further on, we can always compare two step functions by
  comparing them on the finer lattice used for their definition.
\end{note}


\begin{definition}
  \index{integral!of a step function}
  The \textbf{integral} of a step function $f$ on $\Q_n$ is
  defined in the obvious way as
  \begin{gather*}
    \int_{\R^d} f(x) \dx = \sum_{Q_k} f(q_k) |Q_k|,
  \end{gather*}
  where $|Q_k|$ denotes the volume of the cube $Q_k$. Since the sum in
  this definition is finite, the integral is finite.
\end{definition}

\begin{lemma}[Properties of the integral]
  The integral of step functions is a linear operator,
  that is, for two step functions $f$ and $g$ and numbers $a,b\in
  \R$ holds
  \begin{gather*}
    \int_{\R^d}\bigl(a f(x)+b g(x)\bigr) \dx
    = a\int_{\R^d} f(x) + b \int_{\R^d} g(x).
  \end{gather*}
  Furthermore, the integral is monotonic, that is, if for all $x\in
  \R^d$ holds $f(x) \le g(x)$, then holds
  \begin{gather*}
    \int_{\R^d} f(x) \le \int_{\R^d} g(x).
  \end{gather*}
\end{lemma}

\begin{proof}
  Both properties follow from the fact that they hold for the values
  $f(Q_k)$ and $g(Q_k)$ and the summation operator.
\end{proof}

\begin{definition}
  The \define{support} of a function is the set
  \begin{gather}
    \supp f = \overline{
      \bigl\{x\in \R^d\big| f(x) \neq 0 \bigr\}}.
  \end{gather}
  A function $f$ is said to have \define{finite support} or
  synonymously \define{compact support} if $\supp f$ is a bounded set.
\end{definition}

\begin{note}
  Since the support of a step function $f$ consists of finitely many
  cubes, its support is finite.
\end{note}

The following two lemmas establish the close connection between the
convergence of step functions almost everywhere and convergence of
their integrals.

\begin{lemma}
  \label{lemma:integral:1}
  Let $\{\phi_n\}_{n=1,\dots}$ be a monotonically decreasing sequence
  of nonnegative step functions on lattices $\Q_n$ converging to zero almost
  everywhere. Then,
  \begin{gather*}
    \lim_{n\to \infty}\int_{\R^d} \phi_n(x) \dx = 0.
  \end{gather*}
\end{lemma}

\begin{proof}
  First, we note that the assumptions imply that for all $n>1$ holds
  \begin{gather*}
    S:= \supp \phi_1 \supset \supp \phi_n.
  \end{gather*}
  and thus the volume of the support of $\phi_n$ is bounded by that of
  $S$; let the volume of $S$ be $V$.

  Let now $\epsilon>0$ be arbitrarily small. Let $Z$ be the set of
  measure zero, where the sequence does either not converge to zero,
  or where any of the functions $\phi_n$ is discontinuous. Let
  $\mathcal J_\epsilon$ be an at most countable covering of this set
  of total volume less than $\epsilon$ according to
  Definitions~\ref{def:zero-set-1} and~\ref{def:zero-set-2}.

  Let $J$ be the union of all elements in $\mathcal J_\epsilon$. We
  note that, since the sequence is decreasing, for any $x\in S$ holds
  $\phi_n(x) \le \phi_1(x) \le M$ and thus
  \begin{gather*}
    \int_J \phi_n(x) \le \epsilon M.
  \end{gather*}
  
  For any point $x\in \R^d\setminus J$ holds $\phi_n(x)\to 0$ as
  $n\to\infty$. In particular, for $n$ sufficiently large, $\phi_n(x)
  \le \epsilon$. Since $\phi_n$ is a step function, this holds not
  only for $x$, but for the whole cube containing $x$. By varying
  $x\in \R^d\setminus J$, we obtain an infinite set of such cubes,
  which we call $\mathcal U_\epsilon$.
  
  By their definition, the sets in the union of $\mathcal J_\epsilon$
  and $\mathcal U_\epsilon$ cover the set $S$. And since $S$ is
  compact, the Heine-Borel theorem says, that we can choose a finite
  subset from both of these systems, say $\breve{\mathcal U_\epsilon}
  \cup \breve{\mathcal J_\epsilon}$ to cover $S$. Let $U$ be the union
  of all cubes in $\breve{\mathcal U_\epsilon}$. Then, there is an
  index $n_0$, such that $\phi_{n_0}(x) \le \epsilon$ for all $x\in
  U$. Thus,
  \begin{gather*}
    \int_{U} \phi_n(x) < \epsilon V,
    \qquad \forall n\ge n_0.
  \end{gather*}
  We conclude the proof by noting that for $n\ge n_0$
  \begin{gather*}
    \int_{S} \phi_n(x)\dx
    \le \int_{U} \phi_n(x)\dx + \int_{J} \phi_n(x)\dx
    < \epsilon(M+V),
  \end{gather*}
  which can be made arbitrarily small by choosing $\epsilon$ small.
\end{proof}

\begin{lemma}
  \label{lemma:integral:2}
  Let $\{\phi_n\}_{n=1,\dots}$ be a monotonically increasing sequence
  of step functions on lattices $\Q_n$ such that their integrals are
  uniformly bounded by a constant $C$:
  \begin{gather}
    \label{eq:integral:1}
    \int_{\R^d} \phi_n(x) \dx \le C.
  \end{gather}
  Then, the functions $\phi_n$ converge to a finite limit function
  $\phi$ almost everywhere in $\R^d$.
\end{lemma}

\begin{proof}
  First, we observe that it is sufficient to consider sequences of
  nonnegative functions and thus positive constants $C$: otherwise, we
  consider the lemma for the sequence consisting of the functions
  $\phi_n-\phi_1$.

  Let $E_\epsilon$ be the set of points $x$, where $\phi_n(x) >
  C/\epsilon$ for some $n$, and $E_0$ the set of points $x$, where
  $\phi_n(x) \to \infty$. Obviously, $E_0\subset E_\epsilon$ for any
  $\epsilon > 0$.
  
  The set $E_\epsilon$ by its definition is an at most countable
  sequence of the cubes on which the step functions are
  defined. Therefore, the integral of $\phi_n$ over $E_\epsilon$ is
  defined and there holds
  \begin{gather*}
    \frac{C}{\epsilon}\sum_{Q_{k}\subset E_\epsilon} |Q_{k}|
    \le \int_{E\epsilon} \phi_n(x) \dx
    \le \int_{\R^d} \phi_n(x) \dx \le C.
  \end{gather*}
  From this, we deduce that the total volume of the cubes in
  $E_\epsilon$ does not exceed epsilon. Since this set of cubes
  covers $E_0$, we conclude that $E_0$ is of measure zero.
\end{proof}

\begin{remark}
  \label{remark:integral:1}
  Due to the monotonicity of the integral, the sequence on the left
  hand side of inequality~\eqref{eq:integral:1} is monotonically
  increasing. Therefore, the integrals are actually converging to a
  finite value.
\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Definition of the integral}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{intro}
  In the previous section, we defined the integral of step functions
  and investigated some limits. The goal of this section is the
  extension of the integral to a wider class of functions. A first
  extension is almost immediately suggested by
  Lemma~\ref{lemma:integral:2} and
  Remark~\ref{remark:integral:1}. Namely, assigning as value of the
  integral of a function, which is the limit of an increasing sequence
  of step functions almost everywhere, the limit of their
  integrals. Nevertheless, it remains to prove that this yields a well
  defined integral, in particular, that its definition is independent
  of the actual choice of the sequence of step functions.
\end{intro}

\begin{lemma}
  Let $\{\phi_n\}$ be a monotonically increasing sequence of step
  functions with uniformly bounded integrals, converging to a function
  $f$ almost everywhere. Let the same hold for a second sequence
  $\{\psi_n\}$ and the function $g$. Furthermore, let
  \begin{gather*}
    f(x) \le g(x) \quad\text{almost everywhere in $\R^d$.}
  \end{gather*}
  Then,
  \begin{gather}
    \label{eq:integral:4}
    \lim_{n\to\infty} \int_{\R^d}\phi_n(x)\dx
    \le
    \lim_{n\to\infty} \int_{\R^d}\psi_n(x)\dx.
  \end{gather}
\end{lemma}

\begin{proof}
  First, we introduce the abbreviations
  \begin{gather*}
    M_1 = \lim_{n\to\infty} \int_{\R^d}\phi_n(x)\dx
    \quad\text{and}\quad
    M_2 = \lim_{n\to\infty} \int_{\R^d}\psi_n(x)\dx.
  \end{gather*}
  Let $\phi_m$ be an arbitrary function in the first sequence. Then,
  by the assumptions, $h_n^+ = \phi_m-\psi_n$, the positive part of
  the difference, converges to zero almost everywhere and decreases
  monotonically. Thus, by Lemma~\ref{lemma:integral:1}, its integrals
  tend to zero as well. We conclude
  \begin{gather*}
    \int_{\R^d}\phi_n(x)\dx - M_2 \le 0
    \quad\text{or}\quad
    \int_{\R^d}\phi_n(x)\dx \le M_2.
  \end{gather*}
  If now we let $n\to\infty$, we obtain $M_1 \le M_2$.
\end{proof}

\begin{note}
  For two functions $f$ and $g$ as in the preceding Lemma with $f(x) =
  g(x)$ almost everywhere, we can repeat the argument of the proof and
  interchange the sequences. Thus, $M_1 = M_2$.
  This means in particular, that the limit process in this lemma
  uniquely defines the integral of the limit functions. Furthermore,
  it means that we can always modify a function on a set of measure
  zero without affecting its integral.
\end{note}

\begin{definition}
  \label{definition:integral:Splus}
  Let $\mathcal S^+$ be the set of functions which equal the limit of
  a sequence of monotonically increasing step functions with uniformly
  bounded
  integrals almost everywhere. For any function $f\in \mathcal S^+$, we
  define the integral as
  \begin{gather*}
    \int_{\R^d} f(x) \,dx := \lim_{n\to\infty} \int_{\R^d}\phi_n(x)\dx,
  \end{gather*}
  where $\{\phi_n\}$ is any monotonically increasing sequence of step
  functions converging to $f$ almost everywhere.
\end{definition}

\begin{example}
  The function
  \begin{gather*}
    f(x) =
    \begin{cases}
      1 & x\in \Q \\
      0 & x\in \R\setminus \Q
    \end{cases}
  \end{gather*}
  is in $\mathcal S^+$ and its integral is zero. This is due to the fact that
  it is equal to the zero function almost everywhere.
\end{example}

\begin{lemma}
  Let $h$ be a function which is the difference of two functions in
  $\mathcal S^+$, namely $h(x) = f_1(x)-f_2(x)$ almost everywhere. If
  for two other functions in $\mathcal S^+$ holds $h(x) =
  g_1(x)-g_2(x)$ almost everywhere, then
  \begin{gather}
    \label{eq:integral:2}
    \int_{\R^d} f_1(x)\dx
    -\int_{\R^d} f_2(x)\dx
    =\int_{\R^d} g_1(x)\dx
    -\int_{\R^d} g_2(x)\dx,
  \end{gather}
  that is, the difference of the integral does not depend on the
  actual choice of the two functions in the difference.
\end{lemma}

\begin{definition}
  Let $\mathcal L$ be the class of functions\footnote{Here, the letter
    $\mathcal L$ is used in reference to the Lebesgue integral. We
    note that Lebesgue used the term ``summable'' instead of
    ``integrable''.} which can be written as a difference of two
  functions in $\mathcal S^+$ almost everywhere. For any function
  $h\in \mathcal L$, the \define{integral} is defined as
  \begin{gather*}
    \int_{\R^d} h(x)\dx = \int_{\R^d} f(x)\dx - \int_{\R^d} g(x)\dx,
  \end{gather*}
  where $f$ and $g$ are any two functions such that $h(x) = f(x) -
  g(x)$ almost everywhere.
  
  The class $\mathcal L$ is called the set of \define{integrable functions}.
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Structure of the class of integrable functions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{intro}
  The next question we will have to address is, which functions are
  integrable, and whether we are allowed to interchange limits of
  sequences of functions and their integrals. In particular, we will
  see that suitably bounded sequences of integrable functions have
  integrable limits.
\end{intro}

\begin{lemma}
  For every integrable function $f$ there exists a sequence of step
  functions $\{\phi_n(x)\}$ converging to $f$ almost everywhere, such
  that
  \begin{gather*}
    \int_{\R^d} \bigl|f(x)-\phi_n(x)\bigr|\dx \to 0
    \quad\text{as}\quad n\to \infty.
  \end{gather*}
\end{lemma}

\begin{proof}
  This lemma is an immediate consequence of the definition of the
  class $\mathcal L$ as differences of functions in $\mathcal S^+$. In
  fact, let $f(x) = h(x)-g(x)$ with both functions in $\mathcal
  S^+$ and let $\{\psi_n(x)\}$ and $\{\rho_n(x)\}$ be increasing
  sequences of step functions converging to $h(x)$ and $g(x)$
  almost everywhere, respectively. By definition,
  \begin{gather*}
    \int_{\R^d} \bigl|f(x)-\phi_n(x)\bigr|\dx
    \le \int_{\R^d} \bigl(h(x)-\psi_n(x)\bigr)\dx
    + \int_{\R^d} \bigl(g(x)-\rho_n(x)\bigr)\dx
    \to 0.
  \end{gather*}
\end{proof}

\begin{theorem}
  \label{theorem:integral:linearity}
  \index{linearity}
  The class $\mathcal L$ of integrable functions is a vector space and
  the integral is linear, namely for functions $f,g\in \mathcal L$ and
  numbers $\alpha,\beta\in \R$ holds
  \begin{gather}
    \label{eq:integral:3}
    \int_{\R^d} \bigl(\alpha f(x)+\beta g(x) \bigr)\dx
    =\alpha \int_{\R^d} f(x)\dx
    +\beta\int_{\R^d} g(x)\dx.
  \end{gather}
  For functions $g(x)$ and $h(x)$ in $\mathcal S+$ are
  $\sup(g(x),h(x)$ and  $\inf(g(x),h(x)$ in $\mathcal S+$.
  Furthermore, for a function $f\in \mathcal L$, its positive part
  $f^+$, its negative part $f^-$, and its absolute value $|f|$ are in
  $\mathcal L$.
\end{theorem}

\begin{proof}
  The linerarity of the integral follows immediately by taking
  corresponding linear combinations of step function sequences. Thus,
  $\mathcal L$ is a vector space. The same argument holds for the
  infimum and supremum of two functions in $\mathcal S^+$.

  For the second part, we write $f(x)=h(x)-g(x)$ with both functions
  in $\mathcal S^+$, and note
  \begin{alignat*}{2}
    |f| &= \sup(g,h) - \inf(g,h) \\
    f^+ &= \sup(g,h) - g &&= h - \inf(g,h) \\
    f^- &= \sup(g,h) - h &&= g - \inf(g,h).
  \end{alignat*}
\end{proof}

\begin{definition}
  The \define{characteristic function} of a subset $\Omega\subset\R^d$ is
  $\chi_{\Omega}$. It is defined as
  \begin{gather*}
    \chi_{\Omega}(x) =
    \begin{cases}
      1 & x\in \Omega \\
      0 & x\not\in \Omega
    \end{cases}
  \end{gather*}
  \defindex{integral!subset|textbf}
  The function $f$ is said to be \textbf{integrable} on the set
  $\Omega$, if $f\chi_\Omega$ is integrable (on $\R^d$). The
  \textbf{integral} over $\Omega$ of a function $f$ is defined as
  \begin{gather*}
    \int_\Omega f(x)\dx = \int_{\R^d} f(x) \chi_\Omega(x)\dx.
  \end{gather*}
  The \define{measure} of a bounded domain $\Omega$ is the integral of
  $\chi_\Omega$.
\end{definition}

\begin{corollary}
  The integral is additive, namely for two disjoint and not
  necessarily bounded domains
  $\Omega_1\subset\R^d$ and $\Omega_2\subset\R^d$ and a
  function $f$ such that $f\chi_{\Omega_1}$ and $f\chi_{\Omega_2}$ are
  integrable holds
  \begin{gather*}
    \int_{\Omega_1\cup\Omega_2} f(x)\dx
    = \int_{\Omega_1} f(x)\dx + \int_{\Omega_2} f(x)\dx.
  \end{gather*}
\end{corollary}

\begin{proof}
  This follows immediately from the linearity of the integral by
  observing $f(x)\chi_{\Omega_1\cup\Omega_2}(x) =
  f(x)\chi_{\Omega_1}(x)+f(x)\chi_{\Omega_2}(x)$.
\end{proof}

\begin{remark}
  The space $\mathcal S^+$ and thus the space of integrable functions
  have been obtained by a \putindex{completion} process. We started
  out from the space of all test functions and then added to this
  space all monotonically increasing limits with respect to the
  topology ``convergent almost everywhere''. An important
  characteristic of this process is, that it is \putindex{idempotent},
  that is, its repeated application does not change the result. We
  first verify this statement for $\mathcal S^+$. It is extended to
  integrable functions by the Beppo-Levi
  Theorem~\ref{theorem:Beppo-Levi} below.
\end{remark}

\begin{lemma}
  Let $f_n$ be an increasing sequence of functions in $\mathcal
  S^+$. Assume further that the integrals of $f_n$ are uniformly
  bounded by a number $M$. Then, the sequence $f_n$ converges almost
  everywhere to a function $f\in\mathcal S^+$ and there holds
  \begin{gather*}
    \lim_{n\to\infty} \int_{\R^d} f_n \dx = \int_{\R^d} f \dx.
  \end{gather*}
\end{lemma}

\begin{proof}
  For each $n$, let $\{\phi_{nk}\}_{k=1,,2,\dots}$ be a sequence of
  step functions converging monotonically to $f_n$ almost
  everywhere. We generate a type of diagonal sequence in
  $\{\phi_{nk}\}$ by assigning
  \begin{gather*}
    \psi_n(x) = \sup_{i\le n} \phi_{in}(x).
  \end{gather*}
  Since each of the sequences $\{\phi_{nk}\}$ is increasing with
  respect to $k$, $\psi_n$ must be increasing. Since they furthermore
  increase towards $f_n$, we have almost everywhere $\psi_n(x) \le
  f_n(x)$. Thus, 
  \begin{gather*}
    \int_{\R^d} \psi_n \dx \le \int_{\R^d} f_n\dx \le M.
  \end{gather*}
  By Lemma~\ref{lemma:integral:2}, the sequence $\psi_n$ converges
  towards a limit function $f$ almost everywhere. On the other
  hand, for $n\le k$,
  \begin{gather*}
    \psi_n \ge \phi_{nk}.
  \end{gather*}
  Therefore, by allowing $k\to\infty$, we obtain that
  \begin{gather*}
    f_n(x) \le f(x) \quad\text{almost everywhere}.
  \end{gather*}
  Hence, we have $\psi_n \le f_n \le f$ and $\psi_n \nearrow f$ almost
  everywhere, thus the limit of $f_n$ must be equal to the one of
  $\psi_n$, namely $f_n$. The same argument holds for the integrals,
  and since
  \begin{gather*}
    \int_{\R^d} \psi_n \dx \le \int_{\R^d} f_n \dx \le \int_{\R^d} f \dx,
  \end{gather*}
  and since the first integral converges to the last, so does the one
  in the center.
\end{proof}

\begin{theorem}[Beppo-Levi]
  \label{theorem:Beppo-Levi}
  \index{Beppo-Levi Theorem}
  Every monotonically increasing sequence $\{f_n(x)\}$
  of integrable functions whose
  integrals have a common bound, converges almost everywhere to an
  integrable function $f(x)$, and the order of taking the limit and
  integrating can be reversed, that is
  \begin{gather}
    \int_{\R^d} f(x)\dx
    = \lim_{n\to\infty} \int_{\R^d} f_n(x)\dx
  \end{gather}
\end{theorem}

\begin{proof}
  Let us first rewrite the problem as
  \begin{gather*}
    f_n(x) = f_0(x) + \sum_{k=1}^n g_k(x),
  \end{gather*}
  where $g_k(x) = f_k(x) - f_{k-1}(x)$. By the assumptions, the
  elements $g_k$ of the series are nonnegative and
  integrable. Furthermore, since the integrals of $f_n$ have a common
  bound, say $M$, the sequence of integrals is bounded by
  \begin{gather*}
    \sum_{n=1}^\infty \int_{\R^d} g_n(x)\dx
    \le M + \int_{\R^d} |f_0(x)|\dx,
  \end{gather*}
  and thus convergent.
  \begin{todo}
    ...
  \end{todo}
\end{proof}

\begin{theorem}[Lebesgue]
  \index{Lebesgue Theorem}
  If the sequence of integrable functions $\{f_n(x)\}$ converges
  to a function $f(x)$ almost everywhere, and if there exists an
  integrable function such that for all $n$
  \begin{gather}
    \label{eq:integral:5}
    \bigl|f_n(x)\bigr| \le g(x),
  \end{gather}
  holds almost everywhere, then the function $f(x)$ is integrable and
  \begin{gather*}
    \int_{\R^d} f(x)\dx = \lim_{n\to\infty} \int_{\R^d} f_n(x)\dx.
  \end{gather*}
\end{theorem}

\begin{proof}
  \begin{todo}
    ...
  \end{todo}
\end{proof}

\begin{example}
  Condition~\eqref{eq:integral:5} in Lebesgue's Theorem is necessary,
  as can be seen from the following example. Let for $x\in \R$
  \begin{gather*}
    f_n(x) =
    \begin{cases}
      (n+1) |x|^n & x\in [-1,1] \\
      0 & \text{else}.
    \end{cases}
  \end{gather*}
  The sequence converges to zero almost everywhere, but the integrals
  are two. Indeed, by changing the factor in front of $x^n$, the limit
  of the integrals can be made any value including $\infty$. On the
  other hand, if the factors are uniformly bounded, the limit is zero,
  as the theorem predicts.
\end{example}

The assumptions of Lebesgue's Theorem are too strong for some
applications. Thus, the following lemma proves boundedness of the
integral of the limit under weaker assumptions.

\begin{lemma}[Fatou]
If the functions $f_n$ are nonnegative, integrable, and converge
almost everywhere in $\Omega$ to a limit function $f$, and if
furthermore the sequence of integrals
\begin{gather*}
  \int_\Omega f_n(x) \dx,
\end{gather*}
is bounded, then $f$ is integrable and
\begin{gather*}
  \int_\Omega f(x)\dx \le \liminf_{n\to\infty} \int_\Omega f_n(x) \dx.
\end{gather*}
\end{lemma}

\begin{todo}
  \begin{proof}
  \end{proof}
\end{todo}
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "main"
%%% End: 
